{"version":3,"sources":["../../../../src/app/story/%5Bid%5D/page.tsx","../../../../src/app/components/CommentSection.tsx","../../../../src/app/components/CommentCard.tsx","../../../../src/app/components/CommentForm.tsx","../../../../src/lib/shareService.ts","../../../../src/app/components/ShareModal.tsx","../../../../src/app/components/ShareButton.tsx","../../../../src/app/components/ReadingSettings.tsx","../../../../src/app/components/ProposeBranchModal.tsx","../../../../src/app/components/InteractiveStoryPlayer.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useEffect, useState } from 'react';\r\nimport { notFound } from 'next/navigation';\r\nimport Link from 'next/link';\r\nimport { Story } from '@/interfaces/Story';\r\nimport { Comment } from '@/interfaces/Comment';\r\nimport { getStoryById, getCommentsByStoryId, incrementStoryViews, deleteStory, updateStory } from '@/lib/firestore';\r\nimport CommentSection from '@/app/components/CommentSection';\r\nimport ShareButton from '@/app/components/ShareButton';\r\nimport AddToCollectionButton from '@/app/components/AddToCollectionButton';\r\nimport ReportButton from '@/app/components/ReportButton';\r\nimport ReadingSettings, { ReadingSettingsState } from '@/app/components/ReadingSettings';\r\nimport InteractiveStoryPlayer from '@/app/components/InteractiveStoryPlayer';\r\nimport { useAuth } from '@/contexts/AuthContext';\r\nimport { useRouter } from 'next/navigation';\r\n\r\ninterface StoryPageProps {\r\n    params: Promise<{ id: string }>;\r\n}\r\n\r\nexport default function StoryPage({ params }: StoryPageProps) {\r\n    const [id, setId] = useState<string>('');\r\n    const [story, setStory] = useState<Story | null>(null);\r\n    const [comments, setComments] = useState<Comment[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const { user } = useAuth();\r\n    const router = useRouter();\r\n    const [isDeleting, setIsDeleting] = useState(false);\r\n    const [isEditing, setIsEditing] = useState(false);\r\n    const [editTitle, setEditTitle] = useState('');\r\n\r\n    const [editContent, setEditContent] = useState('');\r\n    const [isSaving, setIsSaving] = useState(false);\r\n    const [readingSettings, setReadingSettings] = useState<ReadingSettingsState>({\r\n        font: 'sans',\r\n        size: 'medium',\r\n        theme: 'light'\r\n    });\r\n\r\n    useEffect(() => {\r\n        // Load reading settings\r\n        const savedSettings = localStorage.getItem('fabula-reading-settings');\r\n        if (savedSettings) {\r\n            try {\r\n                setReadingSettings(JSON.parse(savedSettings));\r\n            } catch (e) {\r\n                console.error('Error parsing reading settings:', e);\r\n            }\r\n        }\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        async function loadParams() {\r\n            const resolvedParams = await params;\r\n            setId(resolvedParams.id);\r\n        }\r\n        loadParams();\r\n    }, [params]);\r\n\r\n    useEffect(() => {\r\n        if (!id) return;\r\n\r\n        async function fetchData() {\r\n            try {\r\n                const [fetchedStory, fetchedComments] = await Promise.all([\r\n                    getStoryById(id),\r\n                    getCommentsByStoryId(id)\r\n                ]);\r\n\r\n                if (!fetchedStory) {\r\n                    notFound();\r\n                    return;\r\n                }\r\n\r\n                setStory(fetchedStory);\r\n                setComments(fetchedComments);\r\n\r\n                // Hikaye g√∂r√ºnt√ºlenme sayƒ±sƒ±nƒ± artƒ±r (async, UI'ƒ± bloklamaz)\r\n                incrementStoryViews(id).catch(err => {\r\n                    console.error('Failed to increment views:', err);\r\n                });\r\n            } catch (error) {\r\n                console.error('Error loading story:', error);\r\n            } finally {\r\n                setLoading(false);\r\n            }\r\n        }\r\n\r\n        fetchData();\r\n    }, [id]);\r\n\r\n    const formatDate = (date: Date) => {\r\n        return date.toLocaleDateString('tr-TR', {\r\n            year: 'numeric',\r\n            month: 'long',\r\n            day: 'numeric'\r\n        });\r\n    };\r\n\r\n    const formatNumber = (num: number) => {\r\n        if (num >= 1000) {\r\n            return `${(num / 1000).toFixed(1)}k`;\r\n        }\r\n        return num.toString();\r\n    };\r\n\r\n    const handleDelete = async () => {\r\n        if (!confirm('Bu hikayeyi silmek istediƒüinizden emin misiniz? Bu i≈ülem geri alƒ±namaz.')) {\r\n            return;\r\n        }\r\n\r\n        setIsDeleting(true);\r\n        try {\r\n            await deleteStory(id);\r\n            router.push('/');\r\n        } catch (error) {\r\n            console.error('Error deleting story:', error);\r\n            alert('Hikaye silinirken bir hata olu≈ütu.');\r\n            setIsDeleting(false);\r\n        }\r\n    };\r\n\r\n    const handleEdit = () => {\r\n        if (story) {\r\n            setEditTitle(story.title);\r\n            setEditContent(story.content);\r\n            setIsEditing(true);\r\n        }\r\n    };\r\n\r\n    const handleCancelEdit = () => {\r\n        setIsEditing(false);\r\n        setEditTitle('');\r\n        setEditContent('');\r\n    };\r\n\r\n    const handleSave = async () => {\r\n        if (!editTitle.trim() || !editContent.trim()) {\r\n            alert('Ba≈ülƒ±k ve i√ßerik bo≈ü olamaz.');\r\n            return;\r\n        }\r\n\r\n        setIsSaving(true);\r\n        try {\r\n            await updateStory(id, {\r\n                title: editTitle,\r\n                content: editContent\r\n            });\r\n\r\n            // Yerel state'i g√ºncelle\r\n            setStory(prev => prev ? { ...prev, title: editTitle, content: editContent } : null);\r\n            setIsEditing(false);\r\n        } catch (error) {\r\n            console.error('Error updating story:', error);\r\n            alert('Hikaye g√ºncellenirken bir hata olu≈ütu.');\r\n        } finally {\r\n            setIsSaving(false);\r\n        }\r\n    };\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"story-page\">\r\n                <div className=\"story-container\">\r\n                    <div className=\"loading-state\">\r\n                        <div className=\"spinner\"></div>\r\n                        <p>Hikaye y√ºkleniyor...</p>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    if (!story) {\r\n        notFound();\r\n        return null;\r\n    }\r\n\r\n    return (\r\n        <div className=\"story-page\">\r\n            <div className=\"story-container\">\r\n                <Link href=\"/\" className=\"back-button\">\r\n                    <span>‚Üê</span>\r\n                    Ana Sayfaya D√∂n\r\n                </Link>\r\n\r\n                <article className=\"story-article\">\r\n                    <header className=\"story-header\">\r\n                        <div className=\"story-meta\">\r\n                            <span className=\"category-badge\">{story.category}</span>\r\n                            <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>\r\n                                <ReadingSettings\r\n                                    onSettingsChange={setReadingSettings}\r\n                                    initialSettings={readingSettings}\r\n                                />\r\n                                <ShareButton storyId={story.id} storyTitle={story.title} size=\"small\" />\r\n                                <AddToCollectionButton storyId={story.id} />\r\n                                <ReportButton\r\n                                    targetId={story.id}\r\n                                    targetType=\"story\"\r\n                                    targetContent={story.title}\r\n                                    className=\"opacity-50 hover:opacity-100\"\r\n                                />\r\n                            </div>\r\n                            <span className=\"story-date\">{formatDate(story.createdAt)}</span>\r\n\r\n                            {user && (user.uid === story.authorId) && (\r\n                                <div className=\"author-actions\" style={{ marginLeft: 'auto', display: 'flex', gap: '8px' }}>\r\n                                    {!isEditing ? (\r\n                                        <>\r\n                                            <button\r\n                                                onClick={handleEdit}\r\n                                                className=\"action-button edit-button\"\r\n                                                style={{\r\n                                                    padding: '4px 12px',\r\n                                                    borderRadius: '4px',\r\n                                                    background: '#3b82f6',\r\n                                                    color: 'white',\r\n                                                    border: 'none',\r\n                                                    cursor: 'pointer',\r\n                                                    fontSize: '0.9rem'\r\n                                                }}\r\n                                            >\r\n                                                D√ºzenle\r\n                                            </button>\r\n                                            <button\r\n                                                onClick={handleDelete}\r\n                                                disabled={isDeleting}\r\n                                                className=\"action-button delete-button\"\r\n                                                style={{\r\n                                                    padding: '4px 12px',\r\n                                                    borderRadius: '4px',\r\n                                                    background: '#ef4444',\r\n                                                    color: 'white',\r\n                                                    border: 'none',\r\n                                                    cursor: isDeleting ? 'not-allowed' : 'pointer',\r\n                                                    fontSize: '0.9rem'\r\n                                                }}\r\n                                            >\r\n                                                {isDeleting ? 'Siliniyor...' : 'Sil'}\r\n                                            </button>\r\n                                        </>\r\n                                    ) : (\r\n                                        <>\r\n                                            <button\r\n                                                onClick={handleSave}\r\n                                                disabled={isSaving}\r\n                                                className=\"action-button save-button\"\r\n                                                style={{\r\n                                                    padding: '4px 12px',\r\n                                                    borderRadius: '4px',\r\n                                                    background: '#22c55e',\r\n                                                    color: 'white',\r\n                                                    border: 'none',\r\n                                                    cursor: isSaving ? 'not-allowed' : 'pointer',\r\n                                                    fontSize: '0.9rem'\r\n                                                }}\r\n                                            >\r\n                                                {isSaving ? 'Kaydediliyor...' : 'Kaydet'}\r\n                                            </button>\r\n                                            <button\r\n                                                onClick={handleCancelEdit}\r\n                                                disabled={isSaving}\r\n                                                className=\"action-button cancel-button\"\r\n                                                style={{\r\n                                                    padding: '4px 12px',\r\n                                                    borderRadius: '4px',\r\n                                                    background: '#6b7280',\r\n                                                    color: 'white',\r\n                                                    border: 'none',\r\n                                                    cursor: isSaving ? 'not-allowed' : 'pointer',\r\n                                                    fontSize: '0.9rem'\r\n                                                }}\r\n                                            >\r\n                                                ƒ∞ptal\r\n                                            </button>\r\n                                        </>\r\n                                    )}\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n\r\n                        {isEditing ? (\r\n                            <input\r\n                                type=\"text\"\r\n                                value={editTitle}\r\n                                onChange={(e) => setEditTitle(e.target.value)}\r\n                                className=\"story-title-input\"\r\n                                style={{\r\n                                    width: '100%',\r\n                                    fontSize: '2rem',\r\n                                    fontWeight: 'bold',\r\n                                    marginBottom: '1rem',\r\n                                    padding: '0.5rem',\r\n                                    border: '1px solid #ccc',\r\n                                    borderRadius: '4px',\r\n                                    color: 'black'\r\n                                }}\r\n                            />\r\n                        ) : (\r\n                            <h1 className=\"story-title\">{story.title}</h1>\r\n                        )}\r\n\r\n                        <div className=\"author-section\">\r\n                            <div className=\"author-info\">\r\n                                <span className=\"author-avatar\">{story.author.avatar}</span>\r\n                                <span className=\"author-name\">{story.author.name}</span>\r\n                            </div>\r\n\r\n                            <div className=\"story-stats\">\r\n                                <span className=\"stat\">\r\n                                    <span className=\"stat-icon\">üëÅÔ∏è</span>\r\n                                    {formatNumber(story.stats.views)} g√∂r√ºnt√ºlenme\r\n                                </span>\r\n                                <span className=\"stat\">\r\n                                    <span className=\"stat-icon\">üí¨</span>\r\n                                    {formatNumber(story.stats.comments)} yorum\r\n                                </span>\r\n                                <span className=\"stat\">\r\n                                    <span className=\"stat-icon\">‚ù§Ô∏è</span>\r\n                                    {formatNumber(story.stats.likes)} beƒüeni\r\n                                </span>\r\n                            </div>\r\n                        </div>\r\n                    </header>\r\n\r\n                    {story.type === 'interactive' && story.nodes ? (\r\n                        <InteractiveStoryPlayer\r\n                            story={story}\r\n                            readingSettings={readingSettings}\r\n                            onProgressUpdate={(path) => console.log('Path updated:', path)}\r\n                        />\r\n                    ) : (\r\n                        <div\r\n                            className=\"story-content\"\r\n                            style={{\r\n                                fontFamily: readingSettings.font === 'serif' ? 'ui-serif, Georgia, Cambria, \"Times New Roman\", Times, serif' :\r\n                                    readingSettings.font === 'mono' ? 'ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace' :\r\n                                        'ui-sans-serif, system-ui, sans-serif',\r\n                                fontSize: readingSettings.size === 'small' ? '0.95rem' :\r\n                                    readingSettings.size === 'large' ? '1.25rem' :\r\n                                        readingSettings.size === 'xlarge' ? '1.5rem' : '1.1rem',\r\n                                lineHeight: readingSettings.size === 'xlarge' ? '2' : '1.8',\r\n                                backgroundColor: readingSettings.theme === 'sepia' ? '#f4ecd8' :\r\n                                    readingSettings.theme === 'dark' ? '#1f2937' : 'transparent',\r\n                                color: readingSettings.theme === 'sepia' ? '#433422' :\r\n                                    readingSettings.theme === 'dark' ? '#e5e7eb' : 'inherit',\r\n                                padding: readingSettings.theme !== 'light' ? '3rem' : '0',\r\n                                borderRadius: readingSettings.theme !== 'light' ? '4px' : '0',\r\n                                transition: 'all 0.3s ease',\r\n                                // Skeuomorphic styles for Sepia\r\n                                boxShadow: readingSettings.theme === 'sepia'\r\n                                    ? 'inset 20px 0 50px rgba(0,0,0,0.05), 5px 5px 15px rgba(0,0,0,0.1)'\r\n                                    : 'none',\r\n                                borderLeft: readingSettings.theme === 'sepia' ? '2px solid rgba(0,0,0,0.05)' : 'none',\r\n                                backgroundImage: readingSettings.theme === 'sepia'\r\n                                    ? 'linear-gradient(to right, rgba(255,255,255,0) 0%, rgba(255,255,255,0.2) 5%, rgba(255,255,255,0) 10%)'\r\n                                    : 'none'\r\n                            }}\r\n                        >\r\n                            {isEditing ? (\r\n                                <textarea\r\n                                    value={editContent}\r\n                                    onChange={(e) => setEditContent(e.target.value)}\r\n                                    className=\"story-content-textarea\"\r\n                                    style={{\r\n                                        width: '100%',\r\n                                        minHeight: '400px',\r\n                                        fontSize: 'inherit',\r\n                                        lineHeight: 'inherit',\r\n                                        fontFamily: 'inherit',\r\n                                        padding: '1rem',\r\n                                        border: '1px solid #ccc',\r\n                                        borderRadius: '4px',\r\n                                        color: 'black',\r\n                                        backgroundColor: 'white'\r\n                                    }}\r\n                                />\r\n                            ) : (\r\n                                story.content.split('\\n\\n').map((paragraph, index) => (\r\n                                    <p key={index} style={{ marginBottom: '1.5em' }}>{paragraph}</p>\r\n                                ))\r\n                            )}\r\n                        </div>\r\n                    )}\r\n                </article>\r\n\r\n                <CommentSection\r\n                    storyId={id}\r\n                    storyAuthorId={story.authorId}\r\n                    storyTitle={story.title}\r\n                    initialComments={comments}\r\n                />\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","'use client';\r\n\r\nimport { useState } from 'react';\r\nimport { Comment } from '@/interfaces/Comment';\r\nimport { addComment, getCommentsByStoryId } from '@/lib/firestore';\r\nimport { useAuth } from '@/contexts/AuthContext';\r\nimport { createNotification } from '@/lib/notificationService';\r\nimport CommentCard from './CommentCard';\r\nimport CommentForm from './CommentForm';\r\n\r\ninterface CommentSectionProps {\r\n    storyId: string;\r\n    storyAuthorId?: string;\r\n    storyTitle: string;\r\n    initialComments: Comment[];\r\n}\r\n\r\nexport default function CommentSection({ storyId, storyAuthorId, storyTitle, initialComments }: CommentSectionProps) {\r\n    const { user } = useAuth();\r\n    const [comments, setComments] = useState<Comment[]>(initialComments);\r\n    const [isSubmitting, setIsSubmitting] = useState(false);\r\n    const [showLoginPrompt, setShowLoginPrompt] = useState(false);\r\n\r\n    const handleAddComment = async (content: string) => {\r\n        if (!user) {\r\n            setShowLoginPrompt(true);\r\n            return;\r\n        }\r\n\r\n        setIsSubmitting(true);\r\n\r\n        try {\r\n            const newComment: Omit<Comment, 'id' | 'createdAt'> = {\r\n                storyId,\r\n                author: {\r\n                    name: user.displayName || 'Kullanƒ±cƒ±',\r\n                    avatar: user.photoURL || 'üë§'\r\n                },\r\n                content,\r\n                replies: []\r\n            };\r\n\r\n            // Firestore'a ekle\r\n            const commentId = await addComment(newComment);\r\n\r\n            // Yorumlarƒ± yeniden y√ºkle\r\n            const updatedComments = await getCommentsByStoryId(storyId);\r\n            setComments(updatedComments);\r\n\r\n            // Hikaye yazarƒ±na bildirim g√∂nder (kendi yorumuna bildirim g√∂nderme)\r\n            if (storyAuthorId && storyAuthorId !== user.uid) {\r\n                try {\r\n                    await createNotification({\r\n                        userId: storyAuthorId,\r\n                        type: 'comment',\r\n                        actorId: user.uid,\r\n                        actorName: user.displayName || 'Kullanƒ±cƒ±',\r\n                        actorAvatar: user.photoURL || 'üë§',\r\n                        storyId: storyId,\r\n                        storyTitle: storyTitle,\r\n                        commentId: commentId,\r\n                        message: 'hikayenize yorum yaptƒ±'\r\n                    });\r\n                } catch (notifError) {\r\n                    console.error('Error creating notification:', notifError);\r\n                    // Bildirim hatasƒ± yorumu engellemez\r\n                }\r\n            }\r\n        } catch (error) {\r\n            console.error('Error adding comment:', error);\r\n            alert('Yorum eklenirken bir hata olu≈ütu. L√ºtfen tekrar deneyin.');\r\n        } finally {\r\n            setIsSubmitting(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"comment-section\">\r\n            <div className=\"section-header\">\r\n                <h2>üí¨ Yorumlar</h2>\r\n                <span className=\"comment-count\">{comments.length} yorum</span>\r\n            </div>\r\n\r\n            {!user && showLoginPrompt ? (\r\n                <div className=\"login-prompt\">\r\n                    <span className=\"prompt-icon\">üîê</span>\r\n                    <p>Yorum yapmak i√ßin giri≈ü yapmalƒ±sƒ±nƒ±z.</p>\r\n                    <p className=\"prompt-hint\">Saƒü √ºst k√∂≈üedeki \"Giri≈ü Yap\" butonunu kullanƒ±n.</p>\r\n                </div>\r\n            ) : (\r\n                <CommentForm onSubmit={handleAddComment} disabled={isSubmitting} />\r\n            )}\r\n\r\n            <div className=\"comments-list\">\r\n                {comments.length === 0 ? (\r\n                    <div className=\"empty-state\">\r\n                        <span className=\"empty-icon\">üí≠</span>\r\n                        <p>Hen√ºz yorum yapƒ±lmamƒ±≈ü. ƒ∞lk yorumu siz yapƒ±n!</p>\r\n                    </div>\r\n                ) : (\r\n                    comments.map((comment) => (\r\n                        <CommentCard key={comment.id} comment={comment} />\r\n                    ))\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","'use client';\r\n\r\nimport { Comment } from '@/interfaces/Comment';\r\nimport ReportButton from './ReportButton';\r\n\r\ninterface CommentCardProps {\r\n    comment: Comment;\r\n    depth?: number;\r\n}\r\n\r\nexport default function CommentCard({ comment, depth = 0 }: CommentCardProps) {\r\n    const marginLeft = depth > 0 ? `${depth * 2}rem` : '0';\r\n\r\n    const formatDate = (date: Date) => {\r\n        const now = new Date();\r\n        const diffInMs = now.getTime() - date.getTime();\r\n        const diffInHours = Math.floor(diffInMs / (1000 * 60 * 60));\r\n        const diffInDays = Math.floor(diffInHours / 24);\r\n\r\n        if (diffInHours < 1) return 'Az √∂nce';\r\n        if (diffInHours < 24) return `${diffInHours} saat √∂nce`;\r\n        if (diffInDays < 7) return `${diffInDays} g√ºn √∂nce`;\r\n\r\n        return date.toLocaleDateString('tr-TR', {\r\n            year: 'numeric',\r\n            month: 'long',\r\n            day: 'numeric'\r\n        });\r\n    };\r\n\r\n    return (\r\n        <div style={{ marginLeft }} className=\"comment-card-wrapper\">\r\n            <div className=\"comment-card\">\r\n                <div className=\"comment-header\">\r\n                    <div className=\"comment-author\">\r\n                        <span className=\"author-avatar\">{comment.author.avatar}</span>\r\n                        <div className=\"author-info\">\r\n                            <span className=\"author-name\">{comment.author.name}</span>\r\n                            <span className=\"comment-date\">{formatDate(comment.createdAt)}</span>\r\n                        </div>\r\n                    </div>\r\n                    <ReportButton\r\n                        targetId={comment.id}\r\n                        targetType=\"comment\"\r\n                        targetContent={comment.content}\r\n                        className=\"text-xs opacity-50 hover:opacity-100\"\r\n                    />\r\n                </div>\r\n\r\n                <p className=\"comment-content\">{comment.content}</p>\r\n\r\n                <button className=\"reply-button\">\r\n                    <span>üí¨</span>\r\n                    Yanƒ±tla\r\n                </button>\r\n            </div>\r\n\r\n            {comment.replies && comment.replies.length > 0 && (\r\n                <div className=\"comment-replies\">\r\n                    {comment.replies.map((reply) => (\r\n                        <CommentCard key={reply.id} comment={reply} depth={depth + 1} />\r\n                    ))}\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n","'use client';\r\n\r\nimport { useState } from 'react';\r\n\r\ninterface CommentFormProps {\r\n    onSubmit: (content: string) => void;\r\n    placeholder?: string;\r\n    disabled?: boolean;\r\n}\r\n\r\nexport default function CommentForm({\r\n    onSubmit,\r\n    placeholder = 'Yorumunuzu yazƒ±n...',\r\n    disabled = false\r\n}: CommentFormProps) {\r\n    const [content, setContent] = useState('');\r\n    const maxLength = 500;\r\n\r\n    const handleSubmit = (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        if (content.trim() && content.length <= maxLength) {\r\n            onSubmit(content.trim());\r\n            setContent('');\r\n        }\r\n    };\r\n\r\n    const remainingChars = maxLength - content.length;\r\n    const isNearLimit = remainingChars < 50;\r\n\r\n    return (\r\n        <form onSubmit={handleSubmit} className=\"comment-form\">\r\n            <div className=\"form-header\">\r\n                <h3>üí¨ Yorum Yap</h3>\r\n            </div>\r\n\r\n            <textarea\r\n                value={content}\r\n                onChange={(e) => setContent(e.target.value)}\r\n                placeholder={placeholder}\r\n                maxLength={maxLength}\r\n                rows={4}\r\n                className=\"comment-textarea\"\r\n                disabled={disabled}\r\n            />\r\n\r\n            <div className=\"form-footer\">\r\n                <span className={`char-counter ${isNearLimit ? 'warning' : ''}`}>\r\n                    {remainingChars} karakter kaldƒ±\r\n                </span>\r\n\r\n                <button\r\n                    type=\"submit\"\r\n                    disabled={!content.trim() || content.length > maxLength || disabled}\r\n                    className=\"submit-button\"\r\n                >\r\n                    <span>üì§</span>\r\n                    {disabled ? 'G√∂nderiliyor...' : 'G√∂nder'}\r\n                </button>\r\n            </div>\r\n        </form>\r\n    );\r\n}\r\n","export interface ShareData {\r\n    title: string;\r\n    text: string;\r\n    url: string;\r\n}\r\n\r\n// Web Share API desteƒüini kontrol et\r\nexport function isWebShareSupported(): boolean {\r\n    return typeof navigator !== 'undefined' && 'share' in navigator;\r\n}\r\n\r\n// Web Share API ile payla≈ü\r\nexport async function shareViaWebShare(data: ShareData): Promise<boolean> {\r\n    if (!isWebShareSupported()) {\r\n        return false;\r\n    }\r\n\r\n    try {\r\n        await navigator.share(data);\r\n        return true;\r\n    } catch (error) {\r\n        // Kullanƒ±cƒ± payla≈üƒ±mƒ± iptal etti veya hata olu≈ütu\r\n        console.log('Share cancelled or failed:', error);\r\n        return false;\r\n    }\r\n}\r\n\r\n// Twitter payla≈üƒ±m linki olu≈ütur\r\nexport function getTwitterShareUrl(text: string, url: string): string {\r\n    const params = new URLSearchParams({\r\n        text: text,\r\n        url: url\r\n    });\r\n    return `https://twitter.com/intent/tweet?${params.toString()}`;\r\n}\r\n\r\n// Facebook payla≈üƒ±m linki olu≈ütur\r\nexport function getFacebookShareUrl(url: string): string {\r\n    const params = new URLSearchParams({\r\n        u: url\r\n    });\r\n    return `https://www.facebook.com/sharer/sharer.php?${params.toString()}`;\r\n}\r\n\r\n// WhatsApp payla≈üƒ±m linki olu≈ütur\r\nexport function getWhatsAppShareUrl(text: string, url: string): string {\r\n    const message = `${text} ${url}`;\r\n    const params = new URLSearchParams({\r\n        text: message\r\n    });\r\n    return `https://wa.me/?${params.toString()}`;\r\n}\r\n\r\n// LinkedIn payla≈üƒ±m linki olu≈ütur\r\nexport function getLinkedInShareUrl(url: string): string {\r\n    const params = new URLSearchParams({\r\n        url: url\r\n    });\r\n    return `https://www.linkedin.com/sharing/share-offsite/?${params.toString()}`;\r\n}\r\n\r\n// Clipboard'a kopyala\r\nexport async function copyToClipboard(text: string): Promise<boolean> {\r\n    if (typeof navigator === 'undefined') {\r\n        return false;\r\n    }\r\n\r\n    try {\r\n        // Modern Clipboard API\r\n        if (navigator.clipboard && navigator.clipboard.writeText) {\r\n            await navigator.clipboard.writeText(text);\r\n            return true;\r\n        }\r\n\r\n        // Fallback: eski y√∂ntem\r\n        const textArea = document.createElement('textarea');\r\n        textArea.value = text;\r\n        textArea.style.position = 'fixed';\r\n        textArea.style.left = '-999999px';\r\n        textArea.style.top = '-999999px';\r\n        document.body.appendChild(textArea);\r\n        textArea.focus();\r\n        textArea.select();\r\n\r\n        const successful = document.execCommand('copy');\r\n        document.body.removeChild(textArea);\r\n\r\n        return successful;\r\n    } catch (error) {\r\n        console.error('Failed to copy to clipboard:', error);\r\n        return false;\r\n    }\r\n}\r\n\r\n// Hikaye i√ßin payla≈üƒ±m verisi olu≈ütur\r\nexport function createStoryShareData(storyTitle: string, storyId: string): ShareData {\r\n    const url = `${window.location.origin}/story/${storyId}`;\r\n    return {\r\n        title: storyTitle,\r\n        text: `\"${storyTitle}\" hikayesini okuyun - Fabula`,\r\n        url: url\r\n    };\r\n}\r\n","'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport {\r\n    createStoryShareData,\r\n    isWebShareSupported,\r\n    shareViaWebShare,\r\n    getTwitterShareUrl,\r\n    getFacebookShareUrl,\r\n    getWhatsAppShareUrl,\r\n    getLinkedInShareUrl,\r\n    copyToClipboard\r\n} from '@/lib/shareService';\r\n\r\ninterface ShareModalProps {\r\n    storyId: string;\r\n    storyTitle: string;\r\n    onClose: () => void;\r\n}\r\n\r\nexport default function ShareModal({ storyId, storyTitle, onClose }: ShareModalProps) {\r\n    const [copied, setCopied] = useState(false);\r\n    const [webShareAvailable, setWebShareAvailable] = useState(false);\r\n\r\n    useEffect(() => {\r\n        setWebShareAvailable(isWebShareSupported());\r\n    }, []);\r\n\r\n    const shareData = createStoryShareData(storyTitle, storyId);\r\n\r\n    const handleWebShare = async () => {\r\n        const success = await shareViaWebShare(shareData);\r\n        if (success) {\r\n            onClose();\r\n        }\r\n    };\r\n\r\n    const handleCopyLink = async () => {\r\n        const success = await copyToClipboard(shareData.url);\r\n        if (success) {\r\n            setCopied(true);\r\n            setTimeout(() => {\r\n                setCopied(false);\r\n            }, 2000);\r\n        }\r\n    };\r\n\r\n    const handleSocialShare = (url: string) => {\r\n        window.open(url, '_blank', 'width=600,height=400');\r\n    };\r\n\r\n    const handleBackdropClick = (e: React.MouseEvent) => {\r\n        if (e.target === e.currentTarget) {\r\n            onClose();\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"modal-backdrop\" onClick={handleBackdropClick}>\r\n            <div className=\"share-modal\">\r\n                <div className=\"modal-header\">\r\n                    <h3>Hikayeyi Payla≈ü</h3>\r\n                    <button className=\"close-button\" onClick={onClose}>\r\n                        ‚úï\r\n                    </button>\r\n                </div>\r\n\r\n                <div className=\"modal-content\">\r\n                    <p className=\"share-title\">{storyTitle}</p>\r\n\r\n                    {webShareAvailable && (\r\n                        <button className=\"web-share-button\" onClick={handleWebShare}>\r\n                            <span className=\"button-icon\">üì±</span>\r\n                            Payla≈ü\r\n                        </button>\r\n                    )}\r\n\r\n                    <div className=\"social-buttons\">\r\n                        <button\r\n                            className=\"social-button twitter\"\r\n                            onClick={() => handleSocialShare(getTwitterShareUrl(shareData.text, shareData.url))}\r\n                            title=\"Twitter'da payla≈ü\"\r\n                        >\r\n                            <span className=\"social-icon\">ùïè</span>\r\n                            <span className=\"social-name\">Twitter</span>\r\n                        </button>\r\n\r\n                        <button\r\n                            className=\"social-button facebook\"\r\n                            onClick={() => handleSocialShare(getFacebookShareUrl(shareData.url))}\r\n                            title=\"Facebook'ta payla≈ü\"\r\n                        >\r\n                            <span className=\"social-icon\">f</span>\r\n                            <span className=\"social-name\">Facebook</span>\r\n                        </button>\r\n\r\n                        <button\r\n                            className=\"social-button whatsapp\"\r\n                            onClick={() => handleSocialShare(getWhatsAppShareUrl(shareData.text, shareData.url))}\r\n                            title=\"WhatsApp'ta payla≈ü\"\r\n                        >\r\n                            <span className=\"social-icon\">üì±</span>\r\n                            <span className=\"social-name\">WhatsApp</span>\r\n                        </button>\r\n\r\n                        <button\r\n                            className=\"social-button linkedin\"\r\n                            onClick={() => handleSocialShare(getLinkedInShareUrl(shareData.url))}\r\n                            title=\"LinkedIn'de payla≈ü\"\r\n                        >\r\n                            <span className=\"social-icon\">in</span>\r\n                            <span className=\"social-name\">LinkedIn</span>\r\n                        </button>\r\n                    </div>\r\n\r\n                    <div className=\"copy-link-section\">\r\n                        <input\r\n                            type=\"text\"\r\n                            value={shareData.url}\r\n                            readOnly\r\n                            className=\"link-input\"\r\n                        />\r\n                        <button\r\n                            className={`copy-button ${copied ? 'copied' : ''}`}\r\n                            onClick={handleCopyLink}\r\n                        >\r\n                            {copied ? '‚úì Kopyalandƒ±' : 'üìã Kopyala'}\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","'use client';\r\n\r\nimport { useState } from 'react';\r\nimport ShareModal from './ShareModal';\r\n\r\ninterface ShareButtonProps {\r\n    storyId: string;\r\n    storyTitle: string;\r\n    size?: 'small' | 'medium' | 'large';\r\n}\r\n\r\nexport default function ShareButton({ storyId, storyTitle, size = 'medium' }: ShareButtonProps) {\r\n    const [showModal, setShowModal] = useState(false);\r\n\r\n    const sizeClasses = {\r\n        small: 'share-button-small',\r\n        medium: 'share-button-medium',\r\n        large: 'share-button-large'\r\n    };\r\n\r\n    return (\r\n        <>\r\n            <button\r\n                className={`share-button ${sizeClasses[size]}`}\r\n                onClick={() => setShowModal(true)}\r\n                title=\"Hikayeyi payla≈ü\"\r\n            >\r\n                <span className=\"share-icon\">üì§</span>\r\n                <span className=\"share-text\">Payla≈ü</span>\r\n            </button>\r\n\r\n            {showModal && (\r\n                <ShareModal\r\n                    storyId={storyId}\r\n                    storyTitle={storyTitle}\r\n                    onClose={() => setShowModal(false)}\r\n                />\r\n            )}\r\n        </>\r\n    );\r\n}\r\n","'use client';\r\n\r\nimport { useState, useEffect, useRef } from 'react';\r\n\r\nexport type ReadingFont = 'sans' | 'serif' | 'mono';\r\nexport type ReadingTheme = 'light' | 'dark' | 'sepia';\r\nexport type ReadingSize = 'small' | 'medium' | 'large' | 'xlarge';\r\n\r\nexport interface ReadingSettingsState {\r\n    font: ReadingFont;\r\n    size: ReadingSize;\r\n    theme: ReadingTheme;\r\n}\r\n\r\ninterface ReadingSettingsProps {\r\n    onSettingsChange: (settings: ReadingSettingsState) => void;\r\n    initialSettings?: ReadingSettingsState;\r\n}\r\n\r\nexport default function ReadingSettings({ onSettingsChange, initialSettings }: ReadingSettingsProps) {\r\n    const [isOpen, setIsOpen] = useState(false);\r\n    const [settings, setSettings] = useState<ReadingSettingsState>(initialSettings || {\r\n        font: 'sans',\r\n        size: 'medium',\r\n        theme: 'light'\r\n    });\r\n    const menuRef = useRef<HTMLDivElement>(null);\r\n\r\n    // Click outside to close\r\n    useEffect(() => {\r\n        function handleClickOutside(event: MouseEvent) {\r\n            if (menuRef.current && !menuRef.current.contains(event.target as Node)) {\r\n                setIsOpen(false);\r\n            }\r\n        }\r\n        document.addEventListener('mousedown', handleClickOutside);\r\n        return () => document.removeEventListener('mousedown', handleClickOutside);\r\n    }, []);\r\n\r\n    const updateSettings = (newSettings: Partial<ReadingSettingsState>) => {\r\n        const updated = { ...settings, ...newSettings };\r\n        setSettings(updated);\r\n        onSettingsChange(updated);\r\n\r\n        // Save to localStorage\r\n        localStorage.setItem('fabula-reading-settings', JSON.stringify(updated));\r\n    };\r\n\r\n    return (\r\n        <div className=\"reading-settings-container\" ref={menuRef} style={{ position: 'relative', zIndex: 50 }}>\r\n            <button\r\n                onClick={() => setIsOpen(!isOpen)}\r\n                className=\"reading-settings-toggle\"\r\n                title=\"Okuma Ayarlarƒ±\"\r\n                style={{\r\n                    background: '#e0e5ec',\r\n                    border: 'none',\r\n                    fontSize: '1.5rem',\r\n                    cursor: 'pointer',\r\n                    width: '44px',\r\n                    height: '44px',\r\n                    borderRadius: '50%',\r\n                    display: 'flex',\r\n                    alignItems: 'center',\r\n                    justifyContent: 'center',\r\n                    transition: 'all 0.2s ease',\r\n                    boxShadow: isOpen\r\n                        ? 'inset 5px 5px 10px #bebebe, inset -5px -5px 10px #ffffff'\r\n                        : '5px 5px 10px #bebebe, -5px -5px 10px #ffffff',\r\n                    color: '#4a5568'\r\n                }}\r\n            >\r\n                Aa\r\n            </button>\r\n\r\n            {isOpen && (\r\n                <div className=\"reading-settings-menu\" style={{\r\n                    position: 'absolute',\r\n                    top: '100%',\r\n                    right: 0,\r\n                    marginTop: '16px',\r\n                    background: '#e0e5ec',\r\n                    border: 'none',\r\n                    borderRadius: '20px',\r\n                    padding: '20px',\r\n                    boxShadow: '9px 9px 16px rgb(163,177,198,0.6), -9px -9px 16px rgba(255,255,255, 0.5)',\r\n                    width: '300px',\r\n                    color: '#4a5568',\r\n                    zIndex: 100\r\n                }}>\r\n                    {/* Font Family */}\r\n                    <div className=\"setting-group\" style={{ marginBottom: '16px' }}>\r\n                        <label style={{ display: 'block', marginBottom: '8px', fontSize: '0.875rem', fontWeight: 600 }}>Yazƒ± Tipi</label>\r\n                        <div style={{ display: 'flex', gap: '12px' }}>\r\n                            <button\r\n                                onClick={() => updateSettings({ font: 'sans' })}\r\n                                style={{\r\n                                    flex: 1,\r\n                                    padding: '8px',\r\n                                    border: 'none',\r\n                                    borderRadius: '10px',\r\n                                    background: '#e0e5ec',\r\n                                    boxShadow: settings.font === 'sans'\r\n                                        ? 'inset 3px 3px 6px #bebebe, inset -3px -3px 6px #ffffff'\r\n                                        : '3px 3px 6px #bebebe, -3px -3px 6px #ffffff',\r\n                                    cursor: 'pointer',\r\n                                    fontFamily: 'sans-serif',\r\n                                    color: '#4a5568',\r\n                                    fontWeight: settings.font === 'sans' ? 'bold' : 'normal',\r\n                                    transition: 'all 0.2s ease'\r\n                                }}\r\n                            >\r\n                                Sans\r\n                            </button>\r\n                            <button\r\n                                onClick={() => updateSettings({ font: 'serif' })}\r\n                                style={{\r\n                                    flex: 1,\r\n                                    padding: '8px',\r\n                                    border: 'none',\r\n                                    borderRadius: '10px',\r\n                                    background: '#e0e5ec',\r\n                                    boxShadow: settings.font === 'serif'\r\n                                        ? 'inset 3px 3px 6px #bebebe, inset -3px -3px 6px #ffffff'\r\n                                        : '3px 3px 6px #bebebe, -3px -3px 6px #ffffff',\r\n                                    cursor: 'pointer',\r\n                                    fontFamily: 'serif',\r\n                                    color: '#4a5568',\r\n                                    fontWeight: settings.font === 'serif' ? 'bold' : 'normal',\r\n                                    transition: 'all 0.2s ease'\r\n                                }}\r\n                            >\r\n                                Serif\r\n                            </button>\r\n                            <button\r\n                                onClick={() => updateSettings({ font: 'mono' })}\r\n                                style={{\r\n                                    flex: 1,\r\n                                    padding: '8px',\r\n                                    border: 'none',\r\n                                    borderRadius: '10px',\r\n                                    background: '#e0e5ec',\r\n                                    boxShadow: settings.font === 'mono'\r\n                                        ? 'inset 3px 3px 6px #bebebe, inset -3px -3px 6px #ffffff'\r\n                                        : '3px 3px 6px #bebebe, -3px -3px 6px #ffffff',\r\n                                    cursor: 'pointer',\r\n                                    fontFamily: 'monospace',\r\n                                    color: '#4a5568',\r\n                                    fontWeight: settings.font === 'mono' ? 'bold' : 'normal',\r\n                                    transition: 'all 0.2s ease'\r\n                                }}\r\n                            >\r\n                                Mono\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Font Size */}\r\n                    <div className=\"setting-group\" style={{ marginBottom: '16px' }}>\r\n                        <label style={{ display: 'block', marginBottom: '8px', fontSize: '0.875rem', fontWeight: 600 }}>Boyut</label>\r\n                        <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>\r\n                            <button\r\n                                onClick={() => updateSettings({ size: 'small' })}\r\n                                style={{ border: 'none', background: 'none', cursor: 'pointer', fontSize: '14px', fontWeight: settings.size === 'small' ? 'bold' : 'normal' }}\r\n                            >A</button>\r\n                            <div style={{ flex: 1, height: '4px', background: '#e5e7eb', borderRadius: '2px', position: 'relative' }}>\r\n                                <div style={{\r\n                                    position: 'absolute',\r\n                                    left: settings.size === 'small' ? '0%' : settings.size === 'medium' ? '33%' : settings.size === 'large' ? '66%' : '100%',\r\n                                    top: '50%',\r\n                                    transform: 'translate(-50%, -50%)',\r\n                                    width: '12px',\r\n                                    height: '12px',\r\n                                    borderRadius: '50%',\r\n                                    background: '#3b82f6'\r\n                                }} />\r\n                            </div>\r\n                            <button\r\n                                onClick={() => updateSettings({ size: 'xlarge' })}\r\n                                style={{ border: 'none', background: 'none', cursor: 'pointer', fontSize: '24px', fontWeight: settings.size === 'xlarge' ? 'bold' : 'normal' }}\r\n                            >A</button>\r\n                        </div>\r\n                        <div style={{ display: 'flex', justifyContent: 'space-between', marginTop: '12px', padding: '0 8px' }}>\r\n                            {['small', 'medium', 'large', 'xlarge'].map((s) => (\r\n                                <button\r\n                                    key={s}\r\n                                    onClick={() => updateSettings({ size: s as ReadingSize })}\r\n                                    style={{\r\n                                        width: '32px',\r\n                                        height: '32px',\r\n                                        border: 'none',\r\n                                        borderRadius: '50%',\r\n                                        background: '#e0e5ec',\r\n                                        boxShadow: settings.size === s\r\n                                            ? 'inset 3px 3px 6px #bebebe, inset -3px -3px 6px #ffffff'\r\n                                            : '3px 3px 6px #bebebe, -3px -3px 6px #ffffff',\r\n                                        cursor: 'pointer',\r\n                                        display: 'flex',\r\n                                        alignItems: 'center',\r\n                                        justifyContent: 'center',\r\n                                        fontSize: s === 'small' ? '12px' : s === 'medium' ? '14px' : s === 'large' ? '16px' : '18px',\r\n                                        fontWeight: 'bold',\r\n                                        color: settings.size === s ? '#3b82f6' : '#4a5568',\r\n                                        transition: 'all 0.2s ease'\r\n                                    }}\r\n                                    aria-label={`Select ${s} size`}\r\n                                >\r\n                                    A\r\n                                </button>\r\n                            ))}\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Theme */}\r\n                    <div className=\"setting-group\">\r\n                        <label style={{ display: 'block', marginBottom: '8px', fontSize: '0.875rem', fontWeight: 600 }}>Tema</label>\r\n                        <div style={{ display: 'flex', gap: '12px' }}>\r\n                            <button\r\n                                onClick={() => updateSettings({ theme: 'light' })}\r\n                                style={{\r\n                                    flex: 1,\r\n                                    height: '40px',\r\n                                    borderRadius: '10px',\r\n                                    border: 'none',\r\n                                    background: '#e0e5ec',\r\n                                    boxShadow: settings.theme === 'light'\r\n                                        ? 'inset 3px 3px 6px #bebebe, inset -3px -3px 6px #ffffff'\r\n                                        : '3px 3px 6px #bebebe, -3px -3px 6px #ffffff',\r\n                                    color: '#000',\r\n                                    cursor: 'pointer',\r\n                                    display: 'flex',\r\n                                    alignItems: 'center',\r\n                                    justifyContent: 'center',\r\n                                    fontWeight: settings.theme === 'light' ? 'bold' : 'normal',\r\n                                    transition: 'all 0.2s ease'\r\n                                }}\r\n                            >\r\n                                A√ßƒ±k\r\n                            </button>\r\n                            <button\r\n                                onClick={() => updateSettings({ theme: 'sepia' })}\r\n                                style={{\r\n                                    flex: 1,\r\n                                    height: '40px',\r\n                                    borderRadius: '10px',\r\n                                    border: 'none',\r\n                                    background: '#e0e5ec',\r\n                                    boxShadow: settings.theme === 'sepia'\r\n                                        ? 'inset 3px 3px 6px #bebebe, inset -3px -3px 6px #ffffff'\r\n                                        : '3px 3px 6px #bebebe, -3px -3px 6px #ffffff',\r\n                                    color: '#5b4636',\r\n                                    cursor: 'pointer',\r\n                                    display: 'flex',\r\n                                    alignItems: 'center',\r\n                                    justifyContent: 'center',\r\n                                    fontWeight: settings.theme === 'sepia' ? 'bold' : 'normal',\r\n                                    transition: 'all 0.2s ease'\r\n                                }}\r\n                            >\r\n                                Sepya\r\n                            </button>\r\n                            <button\r\n                                onClick={() => updateSettings({ theme: 'dark' })}\r\n                                style={{\r\n                                    flex: 1,\r\n                                    height: '40px',\r\n                                    borderRadius: '10px',\r\n                                    border: 'none',\r\n                                    background: '#e0e5ec',\r\n                                    boxShadow: settings.theme === 'dark'\r\n                                        ? 'inset 3px 3px 6px #bebebe, inset -3px -3px 6px #ffffff'\r\n                                        : '3px 3px 6px #bebebe, -3px -3px 6px #ffffff',\r\n                                    color: '#1f2937',\r\n                                    cursor: 'pointer',\r\n                                    display: 'flex',\r\n                                    alignItems: 'center',\r\n                                    justifyContent: 'center',\r\n                                    fontWeight: settings.theme === 'dark' ? 'bold' : 'normal',\r\n                                    transition: 'all 0.2s ease'\r\n                                }}\r\n                            >\r\n                                Koyu\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n","'use client';\r\n\r\nimport { useState } from 'react';\r\nimport { useAuth } from '@/contexts/AuthContext';\r\n\r\ninterface ProposeBranchModalProps {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n    storyId: string;\r\n    nodeId: string;\r\n    onSuccess: () => void;\r\n}\r\n\r\nexport default function ProposeBranchModal({ isOpen, onClose, storyId, nodeId, onSuccess }: ProposeBranchModalProps) {\r\n    const { user } = useAuth();\r\n    const [text, setText] = useState('');\r\n    const [isSubmitting, setIsSubmitting] = useState(false);\r\n\r\n    if (!isOpen) return null;\r\n\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        if (!user || !text.trim()) return;\r\n\r\n        setIsSubmitting(true);\r\n        try {\r\n            const token = await user.getIdToken();\r\n            const response = await fetch(`/api/stories/${storyId}/propose`, {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                },\r\n                body: JSON.stringify({\r\n                    nodeId,\r\n                    text,\r\n                    idToken: token\r\n                }),\r\n            });\r\n\r\n            const result = await response.json();\r\n            if (result.success) {\r\n                alert(result.message);\r\n                onSuccess();\r\n                onClose();\r\n                setText('');\r\n            } else {\r\n                alert(result.error || 'Bir hata olu≈ütu.');\r\n            }\r\n        } catch (error) {\r\n            console.error('Error proposing branch:', error);\r\n            alert('Bir hata olu≈ütu.');\r\n        } finally {\r\n            setIsSubmitting(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4\">\r\n            <div className=\"bg-white dark:bg-gray-800 rounded-xl shadow-xl w-full max-w-md overflow-hidden animate-scale-in\">\r\n                <form onSubmit={handleSubmit} className=\"p-6\">\r\n                    <h3 className=\"text-xl font-bold text-gray-800 dark:text-white mb-4\">Yeni Yol √ñner</h3>\r\n                    <p className=\"text-sm text-gray-500 dark:text-gray-400 mb-4\">\r\n                        Hikayenin gidi≈üatƒ±nƒ± deƒüi≈ütirecek bir se√ßenek √∂nerin.\r\n                    </p>\r\n\r\n                    <div className=\"mb-6\">\r\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Se√ßenek Metni</label>\r\n                        <input\r\n                            type=\"text\"\r\n                            value={text}\r\n                            onChange={(e) => setText(e.target.value)}\r\n                            className=\"w-full p-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white\"\r\n                            placeholder=\"√ñrn: Ormana doƒüru ko≈ü...\"\r\n                            maxLength={100}\r\n                        />\r\n                        <div className=\"text-right text-xs text-gray-400 mt-1\">{text.length}/100</div>\r\n                    </div>\r\n\r\n                    <div className=\"flex gap-3 justify-end\">\r\n                        <button\r\n                            type=\"button\"\r\n                            onClick={onClose}\r\n                            className=\"px-4 py-2 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors\"\r\n                        >\r\n                            ƒ∞ptal\r\n                        </button>\r\n                        <button\r\n                            type=\"submit\"\r\n                            disabled={isSubmitting || !text.trim()}\r\n                            className=\"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors disabled:opacity-50\"\r\n                        >\r\n                            {isSubmitting ? 'G√∂nderiliyor...' : '√ñner'}\r\n                        </button>\r\n                    </div>\r\n                </form>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport { Story, StoryNode } from '@/interfaces/Story';\r\nimport { ReadingSettingsState } from './ReadingSettings';\r\nimport { useAuth } from '@/contexts/AuthContext';\r\nimport ProposeBranchModal from './ProposeBranchModal';\r\n\r\ninterface InteractiveStoryPlayerProps {\r\n    story: Story;\r\n    readingSettings: ReadingSettingsState;\r\n    onProgressUpdate?: (path: string[]) => void;\r\n}\r\n\r\nexport default function InteractiveStoryPlayer({ story, readingSettings, onProgressUpdate }: InteractiveStoryPlayerProps) {\r\n    const { user } = useAuth();\r\n    const [currentNodeId, setCurrentNodeId] = useState<string>(story.startNodeId || 'start');\r\n    const [history, setHistory] = useState<string[]>([]);\r\n    const [currentNode, setCurrentNode] = useState<StoryNode | null>(null);\r\n    const [isCompleting, setIsCompleting] = useState(false);\r\n    const [completionResult, setCompletionResult] = useState<{ xpEarned: number; message: string } | null>(null);\r\n    const [isProposeModalOpen, setIsProposeModalOpen] = useState(false);\r\n\r\n    useEffect(() => {\r\n        if (story.nodes && story.nodes[currentNodeId]) {\r\n            const node = story.nodes[currentNodeId];\r\n            setCurrentNode(node);\r\n\r\n            // Check if ending\r\n            if (node.isEnding && !completionResult && !isCompleting) {\r\n                handleFinishStory([...history, currentNodeId]);\r\n            }\r\n        } else {\r\n            // Fallback if node not found or linear content\r\n            console.warn(`Node ${currentNodeId} not found in story`);\r\n        }\r\n    }, [currentNodeId, story.nodes]);\r\n\r\n    const handleFinishStory = async (finalHistory: string[]) => {\r\n        if (!user) return;\r\n\r\n        setIsCompleting(true);\r\n        try {\r\n            const idToken = await user.getIdToken();\r\n            const response = await fetch('/api/complete-story', {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                },\r\n                body: JSON.stringify({\r\n                    storyId: story.id,\r\n                    history: finalHistory,\r\n                    idToken\r\n                }),\r\n            });\r\n\r\n            const result = await response.json();\r\n            if (result.success) {\r\n                setCompletionResult({\r\n                    xpEarned: result.xpEarned,\r\n                    message: result.message\r\n                });\r\n            }\r\n        } catch (error) {\r\n            console.error('Error completing story:', error);\r\n        } finally {\r\n            setIsCompleting(false);\r\n        }\r\n    };\r\n\r\n    const handleChoice = (nextNodeId: string) => {\r\n        const newHistory = [...history, currentNodeId];\r\n        setHistory(newHistory);\r\n        setCurrentNodeId(nextNodeId);\r\n\r\n        if (onProgressUpdate) {\r\n            onProgressUpdate([...newHistory, nextNodeId]);\r\n        }\r\n    };\r\n\r\n    if (!currentNode) {\r\n        return <div className=\"p-4 text-center\">Y√ºkleniyor...</div>;\r\n    }\r\n\r\n    // Styles based on reading settings\r\n    const containerStyle = {\r\n        fontFamily: readingSettings.font === 'serif' ? 'ui-serif, Georgia, Cambria, \"Times New Roman\", Times, serif' :\r\n            readingSettings.font === 'mono' ? 'ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace' :\r\n                'ui-sans-serif, system-ui, sans-serif',\r\n        fontSize: readingSettings.size === 'small' ? '0.95rem' :\r\n            readingSettings.size === 'large' ? '1.25rem' :\r\n                readingSettings.size === 'xlarge' ? '1.5rem' : '1.1rem',\r\n        lineHeight: readingSettings.size === 'xlarge' ? '2' : '1.8',\r\n        backgroundColor: readingSettings.theme === 'sepia' ? '#f4ecd8' :\r\n            readingSettings.theme === 'dark' ? '#1f2937' : 'transparent',\r\n        color: readingSettings.theme === 'sepia' ? '#433422' :\r\n            readingSettings.theme === 'dark' ? '#e5e7eb' : 'inherit',\r\n        padding: readingSettings.theme !== 'light' ? '3rem' : '0',\r\n        borderRadius: readingSettings.theme !== 'light' ? '4px' : '0',\r\n        transition: 'all 0.3s ease',\r\n        // Skeuomorphic styles for Sepia\r\n        boxShadow: readingSettings.theme === 'sepia'\r\n            ? 'inset 20px 0 50px rgba(0,0,0,0.05), 5px 5px 15px rgba(0,0,0,0.1)'\r\n            : 'none',\r\n        borderLeft: readingSettings.theme === 'sepia' ? '2px solid rgba(0,0,0,0.05)' : 'none',\r\n        backgroundImage: readingSettings.theme === 'sepia'\r\n            ? 'linear-gradient(to right, rgba(255,255,255,0) 0%, rgba(255,255,255,0.2) 5%, rgba(255,255,255,0) 10%)'\r\n            : 'none'\r\n    };\r\n\r\n    // Neumorphic button style\r\n    const buttonStyle = {\r\n        background: readingSettings.theme === 'dark' ? '#374151' : '#e0e5ec',\r\n        border: 'none',\r\n        padding: '16px 24px',\r\n        borderRadius: '12px',\r\n        color: readingSettings.theme === 'dark' ? '#e5e7eb' : '#4a5568',\r\n        fontSize: '1rem',\r\n        fontWeight: 600,\r\n        cursor: 'pointer',\r\n        width: '100%',\r\n        textAlign: 'left' as const,\r\n        transition: 'all 0.2s ease',\r\n        boxShadow: readingSettings.theme === 'dark'\r\n            ? '5px 5px 10px #2d3542, -5px -5px 10px #414d5f'\r\n            : '9px 9px 16px rgb(163,177,198,0.6), -9px -9px 16px rgba(255,255,255, 0.5)',\r\n        marginBottom: '16px'\r\n    };\r\n\r\n    return (\r\n        <div className=\"interactive-story-container\">\r\n            {/* Content Area */}\r\n            <div className=\"story-content mb-8\" style={containerStyle}>\r\n                {currentNode.content.split('\\n\\n').map((paragraph, index) => (\r\n                    <p key={index} style={{ marginBottom: '1.5em' }}>{paragraph}</p>\r\n                ))}\r\n            </div>\r\n\r\n            {/* Choices Area */}\r\n            <div className=\"choices-container\" style={{ maxWidth: '600px', margin: '0 auto' }}>\r\n                {currentNode.choices && currentNode.choices.length > 0 ? (\r\n                    <div className=\"choices-list\">\r\n                        {currentNode.choices.map((choice) => (\r\n                            <button\r\n                                key={choice.id}\r\n                                onClick={() => handleChoice(choice.nextNodeId)}\r\n                                className=\"choice-button\"\r\n                                style={buttonStyle}\r\n                                onMouseEnter={(e) => {\r\n                                    e.currentTarget.style.transform = 'translateY(-2px)';\r\n                                    e.currentTarget.style.boxShadow = readingSettings.theme === 'dark'\r\n                                        ? '6px 6px 12px #2d3542, -6px -6px 12px #414d5f'\r\n                                        : '12px 12px 20px rgb(163,177,198,0.7), -12px -12px 20px rgba(255,255,255, 0.6)';\r\n                                }}\r\n                                onMouseLeave={(e) => {\r\n                                    e.currentTarget.style.transform = 'translateY(0)';\r\n                                    e.currentTarget.style.boxShadow = readingSettings.theme === 'dark'\r\n                                        ? '5px 5px 10px #2d3542, -5px -5px 10px #414d5f'\r\n                                        : '9px 9px 16px rgb(163,177,198,0.6), -9px -9px 16px rgba(255,255,255, 0.5)';\r\n                                }}\r\n                                onMouseDown={(e) => {\r\n                                    e.currentTarget.style.transform = 'translateY(1px)';\r\n                                    e.currentTarget.style.boxShadow = readingSettings.theme === 'dark'\r\n                                        ? 'inset 3px 3px 6px #2d3542, inset -3px -3px 6px #414d5f'\r\n                                        : 'inset 3px 3px 6px #a3b1c6, inset -3px -3px 6px #ffffff';\r\n                                }}\r\n                                onMouseUp={(e) => {\r\n                                    e.currentTarget.style.transform = 'translateY(-2px)';\r\n                                    e.currentTarget.style.boxShadow = readingSettings.theme === 'dark'\r\n                                        ? '6px 6px 12px #2d3542, -6px -6px 12px #414d5f'\r\n                                        : '12px 12px 20px rgb(163,177,198,0.7), -12px -12px 20px rgba(255,255,255, 0.6)';\r\n                                }}\r\n                            >\r\n                                {choice.text}\r\n                            </button>\r\n                        ))}\r\n                    </div>\r\n                ) : (\r\n                    <div className=\"end-of-story text-center p-8\">\r\n                        <h3 className=\"text-xl font-bold mb-4\">Son</h3>\r\n                        {completionResult ? (\r\n                            <div className=\"completion-result animate-fade-in\">\r\n                                <p className=\"text-lg mb-2\">{completionResult.message}</p>\r\n                                <p className=\"text-2xl font-bold text-yellow-500\">+{completionResult.xpEarned} XP</p>\r\n                            </div>\r\n                        ) : isCompleting ? (\r\n                            <p>Sonu√ßlar hesaplanƒ±yor...</p>\r\n                        ) : (\r\n                            <p>Bu hikayenin sonuna geldiniz.</p>\r\n                        )}\r\n                    </div>\r\n                )}\r\n\r\n                {/* Propose Branch Button */}\r\n                {user && !currentNode.isEnding && (\r\n                    <div className=\"mt-8 text-center\">\r\n                        <p className=\"text-gray-500 mb-2 text-sm\">Aklƒ±nda ba≈üka bir yol mu var?</p>\r\n                        <button\r\n                            onClick={() => setIsProposeModalOpen(true)}\r\n                            className=\"px-4 py-2 bg-indigo-100 dark:bg-indigo-900/30 text-indigo-600 dark:text-indigo-300 rounded-lg hover:bg-indigo-200 dark:hover:bg-indigo-900/50 transition-colors text-sm font-medium\"\r\n                        >\r\n                            ‚ú® Yeni Bir Yol √ñner\r\n                        </button>\r\n                    </div>\r\n                )}\r\n\r\n                <ProposeBranchModal\r\n                    isOpen={isProposeModalOpen}\r\n                    onClose={() => setIsProposeModalOpen(false)}\r\n                    storyId={story.id}\r\n                    nodeId={currentNodeId}\r\n                    onSuccess={() => {\r\n                        // Refresh logic would be ideal here, but for now maybe just close\r\n                        // Since we are using props, we might need to trigger a refresh in parent\r\n                        // Or we can just rely on realtime updates if we had them\r\n                        // For now, let's just alert user (already done in modal)\r\n                        window.location.reload(); // Simple brute force refresh to see new branch\r\n                    }}\r\n                />\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":"wDAEA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OAGA,EAAA,EAAA,CAAA,CAAA,OCFA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OCHA,EAAA,EAAA,CAAA,CAAA,OAOe,SAAS,EAAY,CAAE,SAAO,OAAE,EAAQ,CAAC,CAAoB,QACxE,IAKU,IALJ,EAAa,EAAQ,EAAI,CAAA,EAAW,EAAR,EAAU,GAAG,CAAC,CAAG,IAmBnD,MACI,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,MAAO,YAAE,CAAW,EAAG,UAAU,iCAClC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,yBACX,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,2BACX,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,2BACX,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,yBAAiB,EAAQ,MAAM,CAAC,MAAM,GACtD,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wBACX,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,uBAAe,EAAQ,MAAM,CAAC,IAAI,GAClD,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,yBAzBpB,AAyBoC,EAAW,EAAQ,SAAS,CArB1E,EAAa,KAAK,KAAK,CAAC,GADV,KAAK,KAAK,CAAC,CADd,AADL,IAAI,MAE0B,CADrB,OAAO,GAAK,EAAK,OAAO,EAAA,EACF,OAAO,AACN,IAE5C,AAAI,CAHmD,CAGrC,CAHuC,CAG7B,CAAP,SACjB,EAAc,GAAW,CAAA,AAAP,EAAU,EAAY,aAAU,CAAC,CACnD,EAAa,EAAU,CAAP,AAAO,EAAG,EAAW,eAAS,CAAC,CAE5C,EAAK,kBAAkB,CAAC,QAAS,CACpC,KAAM,UACN,MAAO,OACP,IAAK,SACT,YAcY,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAY,CAAA,CACT,SAAU,EAAQ,EAAE,CACpB,WAAW,UACX,cAAe,EAAQ,OAAO,CAC9B,UAAU,4CAIlB,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,2BAAmB,EAAQ,OAAO,GAE/C,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CAAO,UAAU,yBACd,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,UAAK,OAAS,gBAKtB,EAAQ,OAAO,EAAI,EAAQ,OAAO,CAAC,MAAM,CAAG,GACzC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,2BACV,EAAQ,OAAO,CAAC,GAAG,CAAC,AAAC,GAClB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CAA2B,QAAS,EAAO,MAAO,EAAQ,GAAzC,EAAM,EAAE,OAMlD,CCxDe,SAAS,EAAY,CAChC,UAAQ,aACR,EAAc,qBAAqB,UACnC,GAAW,CAAK,CACD,EACf,GAAM,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IAWjC,EAVY,AAUK,IAAY,EAAQ,MAAM,CAC3C,EAAc,EAAiB,GAErC,MACI,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,SAZW,AAAC,CAYF,GAXhB,EAAE,cAAc,GACZ,EAAQ,IAAI,IAAM,EAAQ,MAAM,IAAI,IACpC,EAAS,EAAQ,GAD8B,CAC1B,IACrB,EAAW,IAEnB,EAMkC,UAAU,yBACpC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,uBACX,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,UAAG,mBAGR,CAAA,EAAA,EAAA,GAAA,EAAC,WAAA,CACG,MAAO,EACP,SAAU,AAAC,GAAM,EAAW,EAAE,MAAM,CAAC,KAAK,EAC1C,YAAa,EACb,WAAW,GACX,KAAM,EACN,UAAU,mBACV,SAAU,IAGd,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wBACX,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,UAAW,CAAC,aAAa,EAAE,EAAc,UAAY,GAAA,CAAI,WAC1D,EAAe,qBAGpB,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CACG,KAAK,SACL,SAAU,CAAC,EAAQ,IAAI,IAAM,EAAQ,MAAM,GAAG,GAAa,EAC3D,UAAU,0BAEV,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,UAAK,OACL,EAAW,kBAAoB,iBAKpD,CF5Ce,SAAS,EAAe,CAAE,SAAO,eAAE,CAAa,YAAE,CAAU,iBAAE,CAAe,CAAuB,EAC/G,GAAM,MAAE,CAAI,CAAE,CAAG,CAAA,EAAA,EAAA,OAAO,AAAP,IACX,CAAC,EAAU,EAAY,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAY,GAC9C,CAAC,EAAc,EAAgB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GAC3C,CAAC,EAAiB,EAAmB,CAAG,CAAA,EAAA,EAAA,QAAQ,AAAR,GAAS,GAEjD,EAAmB,MAAO,IAC5B,GAAI,CAAC,EAAM,YACP,EAAmB,IAIvB,GAAgB,GAEhB,GAAI,CACA,IAAM,EAAgD,SAClD,EACA,OAAQ,CACJ,KAAM,EAAK,WAAW,EAAI,YAC1B,OAAQ,EAAK,QAAQ,EAAI,IAC7B,UACA,EACA,QAAS,EAAE,AACf,EAGM,EAAY,MAAM,CAAA,EAAA,EAAA,UAAA,AAAU,EAAC,GAG7B,EAAkB,MAAM,CAAA,EAAA,EAAA,oBAAA,AAAoB,EAAC,GAInD,GAHA,EAAY,GAGR,GAAiB,IAAkB,EAAK,GAAG,CAC3C,CAD6C,EACzC,CACA,MAAM,CAAA,EAAA,EAAA,kBAAA,AAAkB,EAAC,CACrB,OAAQ,EACR,KAAM,UACN,QAAS,EAAK,GAAG,CACjB,UAAW,EAAK,WAAW,EAAI,YAC/B,YAAa,EAAK,QAAQ,EAAI,KAC9B,QAAS,EACT,WAAY,EACZ,UAAW,EACX,QAAS,wBACb,EACJ,CAAE,MAAO,EAAY,CACjB,QAAQ,KAAK,CAAC,+BAAgC,EAElD,CAER,CAAE,MAAO,EAAO,CACZ,QAAQ,KAAK,CAAC,wBAAyB,GACvC,MAAM,2DACV,QAAU,CACN,GAAgB,EACpB,CACJ,EAEA,MACI,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,4BACX,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,2BACX,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,UAAG,gBACJ,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,UAAU,0BAAiB,EAAS,MAAM,CAAC,eAGpD,CAAC,GAAQ,EACN,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,yBACX,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,uBAAc,OAC9B,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,UAAE,0CACH,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,uBAAc,uDAG/B,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CAAY,SAAU,EAAkB,SAAU,IAGvD,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,yBACU,IAApB,EAAS,MAAM,CACZ,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wBACX,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,sBAAa,OAC7B,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,UAAE,qDAGP,EAAS,GAAG,CAAC,AAAC,GACV,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CAA6B,QAAS,GAArB,EAAQ,EAAE,OAMpD,CGpGO,SAAS,IACZ,MAAO,AAAqB,oBAAd,WAA6B,UAAW,SAC1D,CAGO,eAAe,EAAiB,CAAe,EAClD,GAAI,CAAC,IACD,OAAO,EAGX,GAAI,CAEA,MANwB,CAKxB,MAAM,UAAU,KAAK,CAAC,IACf,CACX,CAAE,MAAO,EAAO,CAGZ,OADA,QAAQ,GAAG,CAAC,6BAA8B,IACnC,CACX,CACJ,CAqCO,eAAe,EAAgB,CAAY,EAC9C,GAAI,AAAqB,aAAa,OAA3B,UACP,OAAO,EAGX,GAAI,CAEA,GAAI,UAAU,SAAS,EAAI,UAAU,SAAS,CAAC,SAAS,CAEpD,CAFsD,MACtD,MAAM,UAAU,SAAS,CAAC,SAAS,CAAC,IAC7B,EAIX,IAAM,EAAW,SAAS,aAAa,CAAC,WACxC,GAAS,KAAK,CAAG,EACjB,EAAS,KAAK,CAAC,QAAQ,CAAG,QAC1B,EAAS,KAAK,CAAC,IAAI,CAAG,YACtB,EAAS,KAAK,CAAC,GAAG,CAAG,YACrB,SAAS,IAAI,CAAC,WAAW,CAAC,GAC1B,EAAS,KAAK,GACd,EAAS,MAAM,GAEf,IAAM,EAAa,SAAS,WAAW,CAAC,QAGxC,OAFA,SAAS,IAAI,CAAC,WAAW,CAAC,GAEnB,CACX,CAAE,MAAO,EAAO,CAEZ,OADA,QAAQ,KAAK,CAAC,+BAAgC,IACvC,CACX,CACJ,CCxEe,SAAS,EAAW,SAAE,CAAO,YAAE,CAAU,SAAE,CAAO,CAAmB,EAChF,GAAM,CAAC,EAAQ,EAAU,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GAC/B,CAAC,EAAmB,EAAqB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GAE3D,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACN,EAAqB,IACzB,EAAG,EAAE,EAEL,IAAM,EDqEC,CACH,OAAO,CACP,CCvEc,IDuER,CAAC,CAAC,EAAE,ACvEyB,EDuEd,4BAA4B,CAAC,CAClD,IAJQ,CAIH,AAJG,EAAG,OAAO,QAAQ,CAAC,MAAM,CAAC,OAAO,ECpEM,ADoEJ,EAAA,CAAS,AAKxD,ECvEM,EAAiB,UACH,AACZ,MADkB,EAAiB,CAC1B,GACT,GAER,EAEM,EAAiB,UACH,MAAM,EAAgB,EAAU,GAAG,IAE/C,GAAU,GACV,WAAW,KACP,GAAU,EACd,EAAG,KAEX,EAEM,EAAoB,AAAC,IACvB,OAAO,IAAI,CAAC,EAAK,SAAU,uBAC/B,EAQA,MACI,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,iBAAiB,QAPR,AAAC,CAOgB,GANrC,EAAE,MAAM,GAAK,EAAE,aAAa,EAAE,AAC9B,GAER,WAIQ,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wBACX,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,yBACX,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,UAAG,oBACJ,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,UAAU,eAAe,QAAS,WAAS,SAKvD,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,0BACX,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,uBAAe,IAE3B,GACG,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CAAO,UAAU,mBAAmB,QAAS,YAC1C,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,uBAAc,OAAS,YAK/C,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,2BACX,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CACG,UAAU,wBACV,QAAS,kBAAM,GDnDjC,EAAS,IAAI,SCmDsC,ODnDtB,CAC/B,KCkDwE,CDlDlE,CCkD4E,IAAI,CDjDtF,ICiDwF,CDjDnF,CCiD6F,GDhDtG,ACgDyG,GD/ClG,CAAC,iCAAiC,EAAE,EAAO,QAAQ,GAAA,CAAI,ICgDtC,MAAM,8BAEN,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,uBAAc,OAC9B,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,uBAAc,eAGlC,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CACG,UAAU,yBACV,QAAS,kBAAM,GDnDjC,EAAS,IAAI,SCmDsC,ODnDtB,CAC/B,ECkDyE,CDlDtE,CCkDgF,GDjDvF,ACiD0F,GDhDnF,CAAC,2CAA2C,EAAE,EAAO,QAAQ,GAAA,CAAI,ICiDhD,MAAM,+BAEN,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,uBAAc,MAC9B,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,uBAAc,gBAGlC,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CACG,UAAU,yBACV,QAAS,SDrDD,IAAY,aCqDL,KAAsC,EAAU,IAAI,CDrD7C,ECqD+C,CDrDpC,CCqD8C,EAA9C,CAAiD,CDnDpG,EAAS,IAAI,gBAAgB,CAC/B,KAFY,CAEN,AAFM,EAAG,EAAK,CAAC,EAAE,EAAA,CAAK,AAGhC,GACO,CAAC,eAAe,EAAE,EAAO,QAAQ,GAAA,CAAI,ICiDpB,MAAM,+BAEN,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,uBAAc,OAC9B,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,uBAAc,gBAGlC,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CACG,UAAU,yBACV,QAAS,kBAAM,GDpDjC,EAAS,IAAI,SCoDsC,ODpDtB,CAC/B,ICmDyE,CDnDpE,CCmD8E,GAAG,ADlD1F,GACO,CAAC,gDAAgD,EAAE,EAAO,QAAQ,GAAA,CAAI,ICkDrD,MAAM,+BAEN,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,uBAAc,OAC9B,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,uBAAc,mBAItC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,8BACX,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACG,KAAK,OACL,MAAO,EAAU,GAAG,CACpB,QAAQ,CAAA,CAAA,EACR,UAAU,eAEd,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACG,UAAW,CAAC,YAAY,EAAE,EAAS,SAAW,GAAA,CAAI,CAClD,QAAS,WAER,EAAS,eAAiB,yBAOvD,CC1He,SAAS,EAAY,SAAE,CAAO,YAAE,CAAU,MAAE,EAAO,QAAQ,CAAoB,EAC1F,GAAM,CAAC,EAAW,EAAa,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IAQ3C,MACI,CAAA,EAAA,EAAA,IAAA,EAAA,EAAA,QAAA,CAAA,WACI,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CACG,UAAW,CAAC,aAAa,EAAE,AATnB,CAChB,MAAO,qBACP,OAAQ,sBACR,MAAO,oBACX,CAKkD,CAAC,EAAK,CAAA,CAAE,CAC9C,QAAS,IAAM,GAAa,GAC5B,MAAM,4BAEN,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,sBAAa,OAC7B,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,sBAAa,cAGhC,GACG,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CACG,QAAS,EACT,WAAY,EACZ,QAAS,IAAM,GAAa,OAKhD,CN9BA,IAAA,EAAA,EAAA,CAAA,CAAA,MOSe,SAAS,EAAgB,kBAAE,CAAgB,iBAAE,CAAe,CAAwB,EAC/F,GAAM,CAAC,EAAQ,EAAU,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GAC/B,CAAC,EAAU,EAAY,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAuB,GAAmB,CAC9E,KAAM,OACN,KAAM,SACN,MAAO,OACX,GACM,EAAU,CAAA,EAAA,EAAA,MAAM,AAAN,EAAuB,MAGvC,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACN,SAAS,EAAmB,CAAiB,EACrC,EAAQ,OAAO,EAAI,CAAC,EAAQ,OAAO,CAAC,QAAQ,CAAC,EAAM,MAAM,GAAW,AACpE,GAAU,EAElB,CAEA,OADA,SAAS,gBAAgB,CAAC,YAAa,GAChC,IAAM,SAAS,mBAAmB,CAAC,YAAa,EAC3D,EAAG,EAAE,EAEL,IAAM,EAAiB,AAAC,IACpB,IAAM,EAAU,CAAE,GAAG,CAAQ,CAAE,GAAG,CAAY,AAAD,EAC7C,EAAY,GACZ,EAAiB,GAGjB,aAAa,OAAO,CAAC,0BAA2B,KAAK,SAAS,CAAC,GACnE,EAEA,MACI,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,6BAA6B,IAAK,EAAS,MAAO,CAAE,SAAU,WAAY,OAAQ,EAAG,YAChG,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACG,QAAS,IAAM,EAAU,CAAC,GAC1B,UAAU,0BACV,MAAM,iBACN,MAAO,CACH,WAAY,UACZ,OAAQ,OACR,SAAU,SACV,OAAQ,UACR,MAAO,OACP,OAAQ,OACR,aAAc,MACd,QAAS,OACT,WAAY,SACZ,eAAgB,SAChB,WAAY,gBACZ,UAAW,EACL,2DACA,+CACN,MAAO,SACX,WACH,OAIA,GACG,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wBAAwB,MAAO,CAC1C,SAAU,WACV,IAAK,OACL,MAAO,EACP,UAAW,OACX,WAAY,UACZ,OAAQ,OACR,aAAc,OACd,QAAS,OACT,UAAW,2EACX,MAAO,QACP,MAAO,UACP,OAAQ,GACZ,YAEI,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,gBAAgB,MAAO,CAAE,aAAc,MAAO,YACzD,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,MAAO,CAAE,QAAS,QAAS,aAAc,MAAO,SAAU,WAAY,WAAY,GAAI,WAAG,cAChG,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,MAAO,CAAE,QAAS,OAAQ,IAAK,MAAO,YACvC,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACG,QAAS,IAAM,EAAe,CAAE,KAAM,MAAO,GAC7C,MAAO,CACH,KAAM,EACN,QAAS,MACT,OAAQ,OACR,aAAc,OACd,WAAY,UACZ,UAA6B,SAAlB,EAAS,IAAI,CAClB,yDACA,6CACN,OAAQ,UACR,WAAY,aACZ,MAAO,UACP,WAA8B,SAAlB,EAAS,IAAI,CAAc,OAAS,SAChD,WAAY,eAChB,WACH,SAGD,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACG,QAAS,IAAM,EAAe,CAAE,KAAM,OAAQ,GAC9C,MAAO,CACH,KAAM,EACN,QAAS,MACT,OAAQ,OACR,aAAc,OACd,WAAY,UACZ,UAA6B,UAAlB,EAAS,IAAI,CAClB,yDACA,6CACN,OAAQ,UACR,WAAY,QACZ,MAAO,UACP,WAA8B,UAAlB,EAAS,IAAI,CAAe,OAAS,SACjD,WAAY,eAChB,WACH,UAGD,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACG,QAAS,IAAM,EAAe,CAAE,KAAM,MAAO,GAC7C,MAAO,CACH,KAAM,EACN,QAAS,MACT,OAAQ,OACR,aAAc,OACd,WAAY,UACZ,UAA6B,SAAlB,EAAS,IAAI,CAClB,yDACA,6CACN,OAAQ,UACR,WAAY,YACZ,MAAO,UACP,WAA8B,SAAlB,EAAS,IAAI,CAAc,OAAS,SAChD,WAAY,eAChB,WACH,eAOT,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,gBAAgB,MAAO,CAAE,aAAc,MAAO,YACzD,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,MAAO,CAAE,QAAS,QAAS,aAAc,MAAO,SAAU,WAAY,WAAY,GAAI,WAAG,UAChG,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,MAAO,CAAE,QAAS,OAAQ,WAAY,SAAU,IAAK,MAAO,YAC7D,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACG,QAAS,IAAM,EAAe,CAAE,KAAM,OAAQ,GAC9C,MAAO,CAAE,OAAQ,OAAQ,WAAY,OAAQ,OAAQ,UAAW,SAAU,OAAQ,WAA8B,UAAlB,EAAS,IAAI,CAAe,OAAS,QAAS,WAC/I,MACD,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,MAAO,CAAE,KAAM,EAAG,OAAQ,MAAO,WAAY,UAAW,aAAc,MAAO,SAAU,UAAW,WACnG,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,MAAO,CACR,SAAU,WACV,KAAwB,UAAlB,EAAS,IAAI,CAAe,KAAyB,WAAlB,EAAS,IAAI,CAAgB,MAA0B,AAAlB,YAAS,IAAI,CAAe,MAAQ,OAClH,IAAK,MACL,UAAW,wBACX,MAAO,OACP,OAAQ,OACR,aAAc,MACd,WAAY,SAChB,MAEJ,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACG,QAAS,IAAM,EAAe,CAAE,KAAM,QAAS,GAC/C,MAAO,CAAE,OAAQ,OAAQ,WAAY,OAAQ,OAAQ,UAAW,SAAU,OAAQ,WAA8B,WAAlB,EAAS,IAAI,CAAgB,OAAS,QAAS,WAChJ,SAEL,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,MAAO,CAAE,QAAS,OAAQ,eAAgB,gBAAiB,UAAW,OAAQ,QAAS,OAAQ,WAC/F,CAAC,QAAS,SAAU,QAAS,SAAS,CAAC,GAAG,CAAC,AAAC,GACzC,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAEG,QAAS,IAAM,EAAe,CAAE,KAAM,CAAiB,GACvD,MAAO,CACH,MAAO,OACP,OAAQ,OACR,OAAQ,OACR,aAAc,MACd,WAAY,UACZ,UAAW,EAAS,IAAI,GAAK,EACvB,yDACA,6CACN,OAAQ,UACR,QAAS,OACT,WAAY,SACZ,eAAgB,SAChB,SAAgB,UAAN,EAAgB,OAAe,WAAN,EAAiB,OAAe,UAAN,EAAgB,OAAS,OACtF,WAAY,OACZ,MAAO,EAAS,IAAI,GAAK,EAAI,UAAY,UACzC,WAAY,eAChB,EACA,aAAY,CAAC,OAAO,EAAE,EAAE,KAAK,CAAC,UACjC,KArBQ,SA6BrB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,0BACX,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,MAAO,CAAE,QAAS,QAAS,aAAc,MAAO,SAAU,WAAY,WAAY,GAAI,WAAG,SAChG,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,MAAO,CAAE,QAAS,OAAQ,IAAK,MAAO,YACvC,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACG,QAAS,IAAM,EAAe,CAAE,MAAO,OAAQ,GAC/C,MAAO,CACH,KAAM,EACN,OAAQ,OACR,aAAc,OACd,OAAQ,OACR,WAAY,UACZ,UAA8B,UAAnB,EAAS,KAAK,CACnB,yDACA,6CACN,MAAO,OACP,OAAQ,UACR,QAAS,OACT,WAAY,SACZ,eAAgB,SAChB,WAA+B,UAAnB,EAAS,KAAK,CAAe,OAAS,SAClD,WAAY,eAChB,WACH,SAGD,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACG,QAAS,IAAM,EAAe,CAAE,MAAO,OAAQ,GAC/C,MAAO,CACH,KAAM,EACN,OAAQ,OACR,aAAc,OACd,OAAQ,OACR,WAAY,UACZ,UAA8B,UAAnB,EAAS,KAAK,CACnB,yDACA,6CACN,MAAO,UACP,OAAQ,UACR,QAAS,OACT,WAAY,SACZ,eAAgB,SAChB,WAA+B,UAAnB,EAAS,KAAK,CAAe,OAAS,SAClD,WAAY,eAChB,WACH,UAGD,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACG,QAAS,IAAM,EAAe,CAAE,MAAO,MAAO,GAC9C,MAAO,CACH,KAAM,EACN,OAAQ,OACR,aAAc,OACd,OAAQ,OACR,WAAY,UACZ,UAA8B,SAAnB,EAAS,KAAK,CACnB,yDACA,6CACN,MAAO,UACP,OAAQ,UACR,QAAS,OACT,WAAY,SACZ,eAAgB,SAChB,WAA+B,SAAnB,EAAS,KAAK,CAAc,OAAS,SACjD,WAAY,eAChB,WACH,oBAS7B,CCpRe,SAAS,EAAmB,QAAE,CAAM,CAAE,SAAO,SAAE,CAAO,QAAE,CAAM,WAAE,CAAS,CAA2B,EAC/G,GAAM,MAAE,CAAI,CAAE,CAAG,CAAA,EAAA,EAAA,OAAA,AAAO,IAClB,CAAC,EAAM,EAAQ,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IAC3B,CAAC,EAAc,EAAgB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GAEjD,GAAI,CAAC,EAAQ,OAAO,KAEpB,IAAM,EAAe,MAAO,IAExB,GADA,EAAE,cAAc,GACZ,AAAC,GAAS,EAAK,GAAN,CAAU,IAAI,AAE3B,EAAgB,IAChB,GAAI,CACA,IAAM,EAAQ,MAAM,EAAK,UAAU,GAC7B,EAAW,MAAM,MAAM,CAAC,aAAa,EAAE,EAAQ,QAAQ,CAAC,CAAE,CAC5D,OAAQ,OACR,QAAS,CACL,eAAgB,kBACpB,EACA,KAAM,KAAK,SAAS,CAAC,QACjB,OACA,EACA,QAAS,CACb,EACJ,GAEM,EAAS,MAAM,EAAS,IAAI,EAC9B,GAAO,OAAO,EAAE,AAChB,MAAM,EAAO,OAAO,EACpB,IACA,IACA,EAAQ,KAER,MAAM,EAAO,KAAK,EAAI,mBAE9B,CAAE,MAAO,EAAO,CACZ,QAAQ,KAAK,CAAC,0BAA2B,GACzC,MAAM,mBACV,QAAU,CACN,GAAgB,EACpB,EACJ,EAEA,MACI,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,gGACX,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,2GACX,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,SAAU,EAAc,UAAU,gBACpC,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,gEAAuD,kBACrE,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,yDAAgD,0DAI7D,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,iBACX,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,2EAAkE,kBACnF,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACG,KAAK,OACL,MAAO,EACP,SAAU,AAAC,GAAM,EAAQ,EAAE,MAAM,CAAC,KAAK,EACvC,UAAU,4HACV,YAAY,2BACZ,UAAW,MAEf,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,kDAAyC,EAAK,MAAM,CAAC,aAGxE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mCACX,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACG,KAAK,SACL,QAAS,EACT,UAAU,4HACb,UAGD,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACG,KAAK,SACL,SAAU,GAAgB,CAAC,EAAK,IAAI,GACpC,UAAU,mHAET,EAAe,kBAAoB,kBAOhE,CCpFe,SAAS,EAAuB,OAAE,CAAK,iBAAE,CAAe,kBAAE,CAAgB,CAA+B,EACpH,GAAM,MAAE,CAAI,CAAE,CAAG,CAAA,EAAA,EAAA,OAAA,AAAO,IAClB,CAAC,EAAe,EAAiB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAS,EAAM,WAAW,EAAI,SAC1E,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAW,EAAE,EAC7C,CAAC,EAAa,EAAe,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAmB,MAC3D,CAAC,EAAc,EAAgB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GAC3C,CAAC,EAAkB,EAAoB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAA+C,MACjG,CAAC,EAAoB,EAAsB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GAE7D,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACN,GAAI,EAAM,KAAK,EAAI,EAAM,KAAK,CAAC,EAAc,CAAE,CAC3C,IAAM,EAAO,EAAM,KAAK,CAAC,EAAc,CACvC,EAAe,IAGX,EAAK,QAAQ,EAAK,EAAD,CAAsB,GACvC,EAAkB,IAAI,EAAS,EAAc,CAErD,AAH6D,GAAf,GAK1C,CAFG,OAEK,IAAI,CAAC,CAAC,KAAK,EAAE,EAAc,mBAAmB,CAAC,CAE/D,EAAG,CAAC,EAAe,EAAM,KAAK,CAAC,EAE/B,IAAM,EAAoB,MAAO,IAC7B,GAAK,CAAD,EAEJ,GAFW,AAEK,GAChB,GAAI,CACA,IAAM,EAAU,MAAM,EAAK,UAAU,GAC/B,EAAW,MAAM,MAAM,sBAAuB,CAChD,OAAQ,OACR,QAAS,CACL,eAAgB,kBACpB,EACA,KAAM,KAAK,SAAS,CAAC,CACjB,QAAS,EAAM,EAAE,CACjB,QAAS,UACT,CACJ,EACJ,GAEM,EAAS,MAAM,EAAS,IAAI,GAC9B,EAAO,OAAO,EAAE,AAChB,EAAoB,CAChB,SAAU,EAAO,QAAQ,CACzB,QAAS,EAAO,OAAO,AAC3B,EAER,CAAE,MAAO,EAAO,CACZ,QAAQ,KAAK,CAAC,0BAA2B,EAC7C,QAAU,CACN,GAAgB,EACpB,EACJ,EAYA,GAAI,CAAC,EACD,MAAO,CAAA,EAAA,EAAA,AADO,GACP,EAAC,MAAA,CAAI,UAAU,2BAAkB,kBAI5C,IAAM,EAAiB,CACnB,WAAY,AAAyB,YAAT,IAAI,CAAe,8DAClB,SAAzB,EAAgB,IAAI,CAAc,mEAC9B,uCACR,SAAmC,UAAzB,EAAgB,IAAI,CAAe,UAChB,UAAzB,EAAgB,IAAI,CAAe,UACN,WAAzB,EAAgB,IAAI,CAAgB,SAAW,SACvD,WAAqC,WAAzB,EAAgB,IAAI,CAAgB,IAAM,MACtD,gBAA2C,UAA1B,EAAgB,KAAK,CAAe,UACjD,AAA0B,WAAV,KAAK,CAAc,UAAY,cACnD,MAAiC,UAA1B,EAAgB,KAAK,CAAe,UACb,SAA1B,EAAgB,KAAK,CAAc,UAAY,UACnD,QAAmC,UAA1B,EAAgB,KAAK,CAAe,OAAS,IACtD,aAAwC,UAA1B,EAAgB,KAAK,CAAe,MAAQ,IAC1D,WAAY,gBAEZ,UAAW,AAA0B,YAAV,KAAK,CAC1B,mEACA,OACN,WAAsC,UAA1B,EAAgB,KAAK,CAAe,6BAA+B,OAC/E,gBAA2C,UAA1B,EAAgB,KAAK,CAChC,uGACA,MACV,EAGM,EAAc,CAChB,WAAsC,SAA1B,EAAgB,KAAK,CAAc,UAAY,UAC3D,OAAQ,OACR,QAAS,YACT,aAAc,OACd,MAAiC,SAA1B,EAAgB,KAAK,CAAc,UAAY,UACtD,SAAU,OACV,WAAY,IACZ,OAAQ,UACR,MAAO,OACP,UAAW,OACX,WAAY,gBACZ,UAAqC,SAA1B,EAAgB,KAAK,CAC1B,+CACA,2EACN,aAAc,MAClB,EAEA,MACI,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wCAEX,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,qBAAqB,MAAO,WACtC,EAAY,OAAO,CAAC,KAAK,CAAC,QAAQ,GAAG,CAAC,CAAC,EAAW,IAC/C,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAc,MAAO,CAAE,aAAc,OAAQ,WAAI,GAA1C,MAKhB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oBAAoB,MAAO,CAAE,SAAU,QAAS,OAAQ,QAAS,YAC3E,EAAY,OAAO,EAAI,EAAY,OAAO,CAAC,MAAM,CAAG,EACjD,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,wBACV,EAAY,OAAO,CAAC,GAAG,CAAE,AAAD,GACrB,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAEG,QAAS,IAAM,WA1EjC,SADY,EA2EkC,EAAO,UAAU,MAzErE,IADmB,IAAI,EAAS,CACrB,CADmC,EAE9C,EAAiB,GAEb,GACA,EAAiB,IAAI,EAAY,EAAW,IAsExB,CAvEF,SAuEY,gBACV,MAAO,EACP,aAAe,AAAD,IACV,EAAE,aAAa,CAAC,KAAK,CAAC,SAAS,CAAG,mBAClC,EAAE,aAAa,CAAC,KAAK,CAAC,SAAS,CAA6B,SAA1B,EAAgB,KAAK,CACjD,+CACA,8EACV,EACA,aAAc,AAAC,IACX,EAAE,aAAa,CAAC,KAAK,CAAC,SAAS,CAAG,gBAClC,EAAE,aAAa,CAAC,KAAK,CAAC,SAAS,CAA6B,SAA1B,EAAgB,KAAK,CACjD,+CACA,0EACV,EACA,YAAa,AAAC,IACV,EAAE,aAAa,CAAC,KAAK,CAAC,SAAS,CAAG,kBAClC,EAAE,aAAa,CAAC,KAAK,CAAC,SAAS,CAA6B,SAA1B,EAAgB,KAAK,CACjD,yDACA,wDACV,EACA,UAAW,AAAC,IACR,EAAE,aAAa,CAAC,KAAK,CAAC,SAAS,CAAG,mBAClC,EAAE,aAAa,CAAC,KAAK,CAAC,SAAS,CAA6B,SAA1B,EAAgB,KAAK,CACjD,+CACA,8EACV,WAEC,EAAO,IAAI,EA7BP,EAAO,EAAE,KAkC1B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,yCACX,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,kCAAyB,QACtC,EACG,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,8CACX,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,wBAAgB,EAAiB,OAAO,GACrD,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAU,+CAAqC,IAAE,EAAiB,QAAQ,CAAC,YAElF,EACA,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,UAAE,6BAEH,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,UAAE,qCAMd,GAAQ,CAAC,EAAY,QAAQ,EAC1B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,6BACX,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,sCAA6B,kCAC1C,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACG,QAAS,IAAM,GAAsB,GACrC,UAAU,+LACb,2BAMT,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CACG,OAAQ,EACR,QAAS,IAAM,EAAsB,IACrC,QAAS,EAAM,EAAE,CACjB,OAAQ,EACR,UAAW,KAKP,OAAO,QAAQ,CAAC,MAAM,EAC1B,EAD8B,OAMlD,CTzMe,SAAS,EAAU,QAAE,CAAM,CAAkB,EACxD,GAAM,CAAC,EAAI,EAAM,CAAG,CAAA,EAAA,EAAA,ESkMyE,MTlMzE,AAAQ,EAAS,IAC/B,CAAC,EAAO,EAAS,CAAG,CAAA,EAAA,EAAA,QAAQ,AAAR,EAAuB,MAC3C,CAAC,EAAU,EAAY,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAY,EAAE,EAChD,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACjC,CAAE,MAAI,CAAE,CAAG,CAAA,EAAA,EAAA,OAAA,AAAO,IAClB,EAAS,CAAA,EAAA,EAAA,SAAA,AAAS,IAClB,CAAC,EAAY,EAAc,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACvC,CAAC,EAAW,EAAa,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IACrC,CAAC,EAAW,EAAa,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IAErC,CAAC,EAAa,EAAe,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IACzC,CAAC,EAAU,EAAY,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACnC,CAAC,EAAiB,EAAmB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAuB,CACzE,KAAM,OACN,KAAM,SACN,MAAO,OACX,GAEA,CAAA,EAAA,EAAA,SAAS,AAAT,EAAU,KAEN,IAAM,EAAgB,aAAa,OAAO,CAAC,2BAC3C,GAAI,EACA,GAAI,CACA,EAAmB,KAAK,EAFb,GAEkB,CAAC,GAClC,CAAE,MAAO,EAAG,CACR,QAAQ,KAAK,CAAC,kCAAmC,EACrD,CAER,EAAG,EAAE,EAEL,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,MACN,AAIA,eAJe,EAEX,EAAM,AADiB,OAAM,CAAA,EACR,EAAE,CAC3B,GAEJ,EAAG,CAAC,EAAO,EAEX,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACD,GA4BL,CA5BS,GAET,eAAe,IACX,GAAI,CACA,GAAM,CAAC,EAAc,EAAgB,CAAG,MAAM,QAAQ,GAAG,CAAC,CACtD,CAAA,EAAA,EAAA,YAAA,AAAY,EAAC,GACb,CAAA,EAAA,EAAA,oBAAA,AAAoB,EAAC,GACxB,EAED,GAAI,CAAC,EAAc,WACf,CAAA,EAAA,EAAA,QAAA,AAAQ,IAIZ,EAAS,GACT,EAAY,GAGZ,CAAA,EAAA,EAAA,mBAAA,AAAmB,EAAC,GAAI,KAAK,CAAC,IAC1B,QAAQ,KAAK,CAAC,6BAA8B,EAChD,EACJ,CAAE,MAAO,EAAO,CACZ,QAAQ,KAAK,CAAC,uBAAwB,EAC1C,QAAU,CACN,GAAW,EACf,CACJ,CAGJ,EAAG,CAAC,EAAG,EAUP,IAAM,EAAe,AAAC,GACd,AAAJ,GAAW,IACA,CAAA,CADM,CACH,CAAC,EAAM,GAAA,CAAI,CAAE,OAAO,CAAC,GAAG,CAAC,CAAC,CAEjC,EAAI,QAAQ,GAGjB,EAAe,UACjB,GAAK,CAAD,OAAS,4EAA4E,AAIzF,EAAc,IACd,GAAI,CACA,MAAM,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,GAClB,EAAO,IAAI,CAAC,IAChB,CAAE,MAAO,EAAO,CACZ,QAAQ,KAAK,CAAC,wBAAyB,GACvC,MAAM,sCACN,GAAc,EAClB,EACJ,EAgBM,EAAa,UACf,GAAI,CAAC,EAAU,IAAI,IAAM,CAAC,EAAY,IAAI,GAAI,YAC1C,MAAM,gCAIV,GAAY,GACZ,GAAI,CACA,MAAM,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,EAAI,CAClB,MAAO,EACP,QAAS,CACb,GAGA,EAAS,GAAQ,EAAO,CAAE,GAAG,CAAI,CAAE,MAAO,EAAW,QAAS,CAAY,EAAI,MAC9E,GAAa,EACjB,CAAE,MAAO,EAAO,CACZ,QAAQ,KAAK,CAAC,wBAAyB,GACvC,MAAM,yCACV,QAAU,CACN,GAAY,EAChB,CACJ,SAEA,AAAI,EAEI,CAAA,EAAA,EAAA,EAFK,CAEL,EAAC,MAAA,CAAI,UAAU,sBACX,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,2BACX,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,0BACX,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,YACf,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,UAAE,gCAOlB,EAMD,CAAA,EAAA,EANQ,AAMR,GAAA,EAAC,MAAA,CAAI,UAAU,sBACX,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,4BACX,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,OAAI,CAAA,CAAC,KAAK,IAAI,UAAU,wBACrB,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,UAAK,MAAQ,qBAIlB,CAAA,EAAA,EAAA,IAAA,EAAC,UAAA,CAAQ,UAAU,0BACf,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CAAO,UAAU,yBACd,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,uBACX,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,0BAAkB,EAAM,QAAQ,GAChD,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,MAAO,CAAE,QAAS,OAAQ,WAAY,SAAU,IAAK,KAAM,YAC5D,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CACG,iBAAkB,EAClB,gBAAiB,IAErB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CAAY,QAAS,EAAM,EAAE,CAAE,WAAY,EAAM,KAAK,CAAE,KAAK,UAC9D,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAqB,CAAA,CAAC,QAAS,EAAM,EAAE,GACxC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAY,CAAA,CACT,SAAU,EAAM,EAAE,CAClB,WAAW,QACX,cAAe,EAAM,KAAK,CAC1B,UAAU,oCAGlB,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,sBAhH7B,AAgHsD,CAAX,CAAiB,SAAS,CAhHhE,kBAAkB,CAAC,QAAS,CACpC,KAAM,UACN,MAAO,OACP,IAAK,SACT,KA8GqB,GAAS,EAAK,GAAG,GAAK,EAAM,QAAQ,EACjC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,iBAAiB,MAAO,CAAE,WAAY,OAAQ,QAAS,OAAQ,IAAK,KAAM,WACpF,AAAC,EAmCE,CAAA,EAAA,EAAA,IAAA,EAAA,EAAA,QAAA,CAAA,WACI,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACG,QAAS,EACT,SAAU,EACV,UAAU,4BACV,MAAO,CACH,QAAS,WACT,aAAc,MACd,WAAY,UACZ,MAAO,QACP,OAAQ,OACR,OAAQ,EAAW,cAAgB,UACnC,SAAU,QACd,WAEC,EAAW,kBAAoB,WAEpC,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACG,QAnInB,CAmI4B,IAlIjD,GAAa,GACb,EAAa,IACb,EAAe,GACnB,EAgI4C,SAAU,EACV,UAAU,8BACV,MAAO,CACH,QAAS,WACT,aAAc,MACd,WAAY,UACZ,MAAO,QACP,OAAQ,OACR,OAAQ,EAAW,cAAgB,UACnC,SAAU,QACd,WACH,aAhEL,CAAA,EAAA,EAAA,IAAA,EAAA,EAAA,QAAA,CAAA,WACI,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACG,QAzFzB,CAyFkC,IAxF7C,IACA,EAAa,CADN,CACY,KAAK,EACxB,EAAe,EAAM,OAAO,EAC5B,GAAa,GAErB,EAoF4C,UAAU,4BACV,MAAO,CACH,QAAS,WACT,aAAc,MACd,WAAY,UACZ,MAAO,QACP,OAAQ,OACR,OAAQ,UACR,SAAU,QACd,WACH,YAGD,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACG,QAAS,EACT,SAAU,EACV,UAAU,8BACV,MAAO,CACH,QAAS,WACT,aAAc,MACd,WAAY,UACZ,MAAO,QACP,OAAQ,OACR,OAAQ,EAAa,cAAgB,UACrC,SAAU,QACd,WAEC,EAAa,eAAiB,gBA2CtD,EACG,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACG,KAAK,OACL,MAAO,EACP,SAAW,AAAD,GAAO,EAAa,EAAE,MAAM,CAAC,KAAK,EAC5C,UAAU,oBACV,MAAO,CACH,MAAO,OACP,SAAU,OACV,WAAY,OACZ,aAAc,OACd,QAAS,SACT,OAAQ,iBACR,aAAc,MACd,MAAO,OACX,IAGJ,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,uBAAe,EAAM,KAAK,GAG5C,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,2BACX,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wBACX,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,yBAAiB,EAAM,MAAM,CAAC,MAAM,GACpD,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,uBAAe,EAAM,MAAM,CAAC,IAAI,MAGpD,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wBACX,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,UAAU,iBACZ,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,qBAAY,QAC3B,EAAa,EAAM,KAAK,CAAC,KAAK,EAAE,mBAErC,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,UAAU,iBACZ,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,qBAAY,OAC3B,EAAa,EAAM,KAAK,CAAC,QAAQ,EAAE,YAExC,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,UAAU,iBACZ,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,qBAAY,OAC3B,EAAa,EAAM,KAAK,CAAC,KAAK,EAAE,sBAMjC,gBAAf,EAAM,IAAI,EAAsB,EAAM,KAAK,CACxC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CACG,MAAO,EACP,gBAAiB,EACjB,iBAAkB,AAAC,GAAS,QAAQ,GAAG,CAAC,gBAAiB,KAG7D,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CACG,UAAU,gBACV,MAAO,CACH,WAAqC,UAAzB,EAAgB,IAAI,CAAe,8DAC3C,AAAyB,WAAT,IAAI,CAAc,mEAC9B,uCACR,SAAmC,UAAzB,EAAgB,IAAI,CAAe,UAChB,UAAzB,EAAgB,IAAI,CAAe,UACN,WAAzB,EAAgB,IAAI,CAAgB,SAAW,SACvD,WAAqC,WAAzB,EAAgB,IAAI,CAAgB,IAAM,MACtD,gBAA2C,UAA1B,EAAgB,KAAK,CAAe,UACjD,AAA0B,WAAV,KAAK,CAAc,UAAY,cACnD,MAAiC,UAA1B,EAAgB,KAAK,CAAe,UACb,AAA1B,WAAgB,KAAK,CAAc,UAAY,UACnD,QAAmC,UAA1B,EAAgB,KAAK,CAAe,OAAS,IACtD,aAAwC,UAA1B,EAAgB,KAAK,CAAe,MAAQ,IAC1D,WAAY,gBAEZ,UAAqC,UAA1B,EAAgB,KAAK,CAC1B,mEACA,OACN,WAAsC,UAA1B,EAAgB,KAAK,CAAe,6BAA+B,OAC/E,gBAAiB,AAA0B,YAAV,KAAK,CAChC,uGACA,MACV,WAEC,EACG,CAAA,EAAA,EAAA,GAAA,EAAC,WAAA,CACG,MAAO,EACP,SAAU,AAAC,GAAM,EAAe,EAAE,MAAM,CAAC,KAAK,EAC9C,UAAU,yBACV,MAAO,CACH,MAAO,OACP,UAAW,QACX,SAAU,UACV,WAAY,UACZ,WAAY,UACZ,QAAS,OACT,OAAQ,iBACR,aAAc,MACd,MAAO,QACP,gBAAiB,OACrB,IAGJ,EAAM,OAAO,CAAC,KAAK,CAAC,QAAQ,GAAG,CAAC,CAAC,EAAW,IACxC,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAc,MAAO,CAAE,aAAc,OAAQ,WAAI,GAA1C,SAO5B,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CACG,QAAS,EACT,cAAe,EAAM,QAAQ,CAC7B,WAAY,EAAM,KAAK,CACvB,gBAAiB,UAzN7B,CAAA,EAAA,EAAA,QAAA,AAAQ,IACD,KA6Nf"}