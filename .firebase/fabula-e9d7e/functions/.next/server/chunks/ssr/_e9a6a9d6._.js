module.exports=[33396,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(11642);a.i(69387);var e=a.i(60574),f=a.i(79353);async function g(a,b){try{let c=`${a}_story_${b}`,d=(0,e.doc)(f.db,"likes",c),g=(0,e.doc)(f.db,"stories",b);return await (0,e.runTransaction)(f.db,async c=>{let f=await c.get(d);if(!(await c.get(g)).exists())throw Error("Story does not exist!");return f.exists()?(c.delete(d),c.update(g,{"stats.likes":(0,e.increment)(-1)}),!1):(c.set(d,{userId:a,targetId:b,targetType:"story",createdAt:e.Timestamp.now()}),c.update(g,{"stats.likes":(0,e.increment)(1)}),!0)})}catch(a){throw console.error("Error toggling story like:",a),a}}async function h(a,b){try{let c=`${a}_comment_${b}`,d=(0,e.doc)(f.db,"likes",c),g=(0,e.doc)(f.db,"comments",b);return await (0,e.runTransaction)(f.db,async c=>{let f=await c.get(d);if(!(await c.get(g)).exists())throw Error("Comment does not exist!");return f.exists()?(c.delete(d),c.update(g,{likes:(0,e.increment)(-1)}),!1):(c.set(d,{userId:a,targetId:b,targetType:"comment",createdAt:e.Timestamp.now()}),c.update(g,{likes:(0,e.increment)(1)}),!0)})}catch(a){throw console.error("Error toggling comment like:",a),a}}(0,e.collection)(f.db,"likes");var i=a.i(89769);function j({targetId:a,targetType:e,initialLikeCount:f,size:j="medium",storyAuthorId:k,storyTitle:l}){let{user:m}=(0,d.useAuth)(),[n,o]=(0,c.useState)(!1),[p,q]=(0,c.useState)(f),[r,s]=(0,c.useState)(!1),[t,u]=(0,c.useState)(!0),v=async()=>{if(!m||r)return;s(!0);let b=!n,c=b?p+1:p-1;o(b),q(c);try{let b="story"===e?await g(m.uid,a):await h(m.uid,a);if(o(b),b&&"story"===e&&k&&l&&k!==m.uid)try{await (0,i.createNotification)({userId:k,type:"like",actorId:m.uid,actorName:m.displayName||"KullanÄ±cÄ±",actorAvatar:m.photoURL||"ðŸ‘¤",storyId:a,storyTitle:l,message:"hikayenizi beÄŸendi"})}catch(a){console.error("Error creating notification:",a)}}catch(a){console.error("Error toggling like:",a),o(!b),q(p)}finally{s(!1)}};return t?null:(0,b.jsxs)("button",{className:`like-button ${{small:"like-button-small",medium:"like-button-medium",large:"like-button-large"}[j]} ${n?"liked":""} ${!m?"disabled":""}`,onClick:v,disabled:!m||r,title:m?n?"BeÄŸeniyi kaldÄ±r":"BeÄŸen":"BeÄŸenmek iÃ§in giriÅŸ yapÄ±n",children:[(0,b.jsx)("span",{className:"like-icon",children:n?"â¤ï¸":"ðŸ¤"}),(0,b.jsx)("span",{className:"like-count",children:p})]})}a.s(["default",()=>j],33396)},61134,a=>{"use strict";a.i(69387);var b=a.i(60574),c=a.i(79353),d=a.i(77929);let e=(0,b.collection)(c.db,"favorites");async function f(a,d){try{let e=`${a}_${d}`,f=(0,b.doc)(c.db,"favorites",e);if((await (0,b.getDoc)(f)).exists())return await (0,b.deleteDoc)(f),!1;return await (0,b.setDoc)(f,{userId:a,storyId:d,createdAt:b.Timestamp.now()}),!0}catch(a){throw console.error("Error toggling favorite:",a),a}}async function g(a,d){try{let e=`${a}_${d}`,f=(0,b.doc)(c.db,"favorites",e);return(await (0,b.getDoc)(f)).exists()}catch(a){return console.error("Error checking favorite:",a),!1}}async function h(a){try{let c=(0,b.query)(e,(0,b.where)("userId","==",a)),f=await (0,b.getDocs)(c),g=f.docs.map(a=>a.data().storyId);if(0===g.length)return[];let h=(await (0,d.getStories)()).filter(a=>g.includes(a.id)),i=new Map(f.docs.map(a=>[a.data().storyId,a.data().createdAt?.toDate()||new Date]));return h.sort((a,b)=>{let c=i.get(a.id)||new Date(0);return(i.get(b.id)||new Date(0)).getTime()-c.getTime()})}catch(a){return console.error("Error fetching user favorites:",a),[]}}a.s(["getUserFavorites",()=>h,"isFavorited",()=>g,"toggleFavorite",()=>f])},59299,a=>{"use strict";var b=a.i(87924),c=a.i(50944),d=a.i(33396),e=a.i(72131),f=a.i(11642),g=a.i(61134);function h({storyId:a,size:c="medium"}){let{user:d}=(0,f.useAuth)(),[h,i]=(0,e.useState)(!1),[j,k]=(0,e.useState)(!1),[l,m]=(0,e.useState)(!0);(0,e.useEffect)(()=>{d?async function(){if(d)try{let b=await (0,g.isFavorited)(d.uid,a);i(b)}catch(a){console.error("Error checking favorite status:",a)}finally{m(!1)}}():m(!1)},[d,a]);let n=async b=>{if(b.stopPropagation(),!d||j)return;k(!0);let c=!h;i(c);try{let b=await (0,g.toggleFavorite)(d.uid,a);i(b)}catch(a){console.error("Error toggling favorite:",a),i(!c)}finally{k(!1)}};return l?null:(0,b.jsx)("button",{className:`favorite-button ${{small:"favorite-button-small",medium:"favorite-button-medium",large:"favorite-button-large"}[c]} ${h?"favorited":""} ${!d?"disabled":""}`,onClick:n,disabled:!d||j,title:d?h?"Favorilerden Ã§Ä±kar":"Favorilere ekle":"Favori eklemek iÃ§in giriÅŸ yapÄ±n",children:(0,b.jsx)("span",{className:"favorite-icon",children:h?"â­":"â˜†"})})}var i=a.i(94525),j=a.i(2088);function k({story:a}){let e,f=(0,c.useRouter)(),g=(e=Math.max(1,Math.ceil(a.content.trim().split(/\s+/).filter(a=>a.length>0).length/200)))<=3?`âš¡ ${e} dk`:e<=10?`ðŸ“– ${e} dk`:`ðŸ“š ${e} dk`,k=a=>a>=1e3?`${(a/1e3).toFixed(1)}k`:a.toString();return(0,b.jsxs)("div",{className:"story-card",onClick:b=>{b.target.closest(".like-button")||b.target.closest("button")||f.push(`/story/${a.id}`)},children:[(0,b.jsxs)("div",{className:"story-card-header",children:[(0,b.jsx)("span",{className:"category-badge",children:a.category}),(0,b.jsxs)("div",{className:"header-actions",children:[(0,b.jsx)("span",{className:"reading-time-badge",children:g}),(0,b.jsx)(h,{storyId:a.id,size:"small"}),(0,b.jsx)(j.default,{storyId:a.id}),(0,b.jsx)(i.default,{targetId:a.id,targetType:"story",targetContent:a.title,className:"opacity-50 hover:opacity-100"}),(0,b.jsx)("span",{className:"story-date",children:a.createdAt.toLocaleDateString("tr-TR",{year:"numeric",month:"long",day:"numeric"})})]})]}),(0,b.jsx)("h3",{className:"story-title",children:a.title}),(0,b.jsx)("p",{className:"story-excerpt",children:a.excerpt}),(0,b.jsxs)("div",{className:"story-footer",children:[(0,b.jsxs)("div",{className:"author-info",children:[(0,b.jsx)("span",{className:"author-avatar",children:a.author.avatar}),(0,b.jsx)("span",{className:"author-name",children:a.author.name})]}),(0,b.jsxs)("div",{className:"story-stats",children:[(0,b.jsxs)("span",{className:"stat",children:[(0,b.jsx)("span",{className:"stat-icon",children:"ðŸ‘ï¸"}),k(a.stats.views)]}),(0,b.jsxs)("span",{className:"stat",children:[(0,b.jsx)("span",{className:"stat-icon",children:"ðŸ’¬"}),k(a.stats.comments)]}),(0,b.jsx)(d.default,{targetId:a.id,targetType:"story",initialLikeCount:a.stats.likes,size:"small",storyAuthorId:a.authorId,storyTitle:a.title})]})]})]})}a.s(["default",()=>k],59299)},94936,(a,b,c)=>{var d=0/0,e=/^\s+|\s+$/g,f=/^[-+]0x[0-9a-f]+$/i,g=/^0b[01]+$/i,h=/^0o[0-7]+$/i,i=parseInt,j=a.g&&a.g.Object===Object&&a.g,k="object"==typeof self&&self&&self.Object===Object&&self,l=j||k||Function("return this")(),m=Object.prototype.toString,n=Math.max,o=Math.min,p=function(){return l.Date.now()};function q(a){var b=typeof a;return!!a&&("object"==b||"function"==b)}function r(a){if("number"==typeof a)return a;if("symbol"==typeof(b=a)||b&&"object"==typeof b&&"[object Symbol]"==m.call(b))return d;if(q(a)){var b,c="function"==typeof a.valueOf?a.valueOf():a;a=q(c)?c+"":c}if("string"!=typeof a)return 0===a?a:+a;a=a.replace(e,"");var j=g.test(a);return j||h.test(a)?i(a.slice(2),j?2:8):f.test(a)?d:+a}b.exports=function(a,b,c){var d,e,f,g,h,i,j=0,k=!1,l=!1,m=!0;if("function"!=typeof a)throw TypeError("Expected a function");function s(b){var c=d,f=e;return d=e=void 0,j=b,g=a.apply(f,c)}function t(a){var c=a-i,d=a-j;return void 0===i||c>=b||c<0||l&&d>=f}function u(){var a,c,d,e=p();if(t(e))return v(e);h=setTimeout(u,(a=e-i,c=e-j,d=b-a,l?o(d,f-c):d))}function v(a){return(h=void 0,m&&d)?s(a):(d=e=void 0,g)}function w(){var a,c=p(),f=t(c);if(d=arguments,e=this,i=c,f){if(void 0===h)return j=a=i,h=setTimeout(u,b),k?s(a):g;if(l)return h=setTimeout(u,b),s(i)}return void 0===h&&(h=setTimeout(u,b)),g}return b=r(b)||0,q(c)&&(k=!!c.leading,f=(l="maxWait"in c)?n(r(c.maxWait)||0,b):f,m="trailing"in c?!!c.trailing:m),w.cancel=function(){void 0!==h&&clearTimeout(h),j=0,d=i=e=h=void 0},w.flush=function(){return void 0===h?g:v(p())},w}},40777,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(59299),e=a.i(94936);let f=(a,b=400)=>(0,e.default)(a,b);function g({onSearch:a,placeholder:d="Hikaye ara..."}){let[f,g]=(0,c.useState)(""),h=(0,c.useRef)(((a,b=300)=>(0,e.default)(a,b))(b=>{a(b)},300));return(0,c.useEffect)(()=>{h.current(f)},[f]),(0,b.jsxs)("div",{className:"search-bar",children:[(0,b.jsx)("span",{className:"search-icon",children:"ðŸ”"}),(0,b.jsx)("input",{type:"text",className:"search-input",placeholder:d,value:f,onChange:a=>g(a.target.value)}),f&&(0,b.jsx)("button",{className:"search-clear",onClick:()=>{g("")},title:"Temizle",children:"âœ•"})]})}function h({categories:a,authors:d,selectedCategory:e,selectedAuthor:g,selectedSort:h,onCategoryChange:i,onAuthorChange:j,onSortChange:k,onClearFilters:l}){let m=e||g||"newest"!==h,n=(0,c.useRef)(f(a=>{i(a)},400)),o=(0,c.useRef)(f(a=>{j(a)},400)),p=(0,c.useRef)(f(a=>{k(a)},400));return(0,b.jsxs)("div",{className:"filter-panel",children:[(0,b.jsxs)("div",{className:"filter-group",children:[(0,b.jsx)("label",{className:"filter-label",children:"Kategori"}),(0,b.jsxs)("select",{className:"filter-select",value:e||"",onChange:a=>n.current(a.target.value),children:[(0,b.jsx)("option",{value:"",children:"TÃ¼m Kategoriler"}),a.map(a=>(0,b.jsx)("option",{value:a,children:a},a))]})]}),(0,b.jsxs)("div",{className:"filter-group",children:[(0,b.jsx)("label",{className:"filter-label",children:"Yazar"}),(0,b.jsxs)("select",{className:"filter-select",value:g||"",onChange:a=>o.current(a.target.value),children:[(0,b.jsx)("option",{value:"",children:"TÃ¼m Yazarlar"}),d.map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))]})]}),(0,b.jsxs)("div",{className:"filter-group",children:[(0,b.jsx)("label",{className:"filter-label",children:"SÄ±ralama"}),(0,b.jsxs)("select",{className:"filter-select",value:h,onChange:a=>p.current(a.target.value),children:[(0,b.jsx)("option",{value:"newest",children:"En Yeni"}),(0,b.jsx)("option",{value:"popular",children:"En PopÃ¼ler"}),(0,b.jsx)("option",{value:"mostLiked",children:"En Ã‡ok BeÄŸenilen"}),(0,b.jsx)("option",{value:"mostViewed",children:"En Ã‡ok GÃ¶rÃ¼ntÃ¼lenen"})]})]}),m&&(0,b.jsxs)("button",{className:"clear-filters-button",onClick:l,children:[(0,b.jsx)("span",{children:"ðŸ”„"}),"Filtreleri Temizle"]})]})}function i({type:a="text",width:c,height:d,count:e=1,className:f=""}){let g=()=>{switch(a){case"title":return"skeleton skeleton-title";case"card":return"skeleton skeleton-card";case"avatar":return"skeleton skeleton-avatar";case"image":return"skeleton skeleton-image";default:return"skeleton skeleton-text"}},h={width:c||void 0,height:d||void 0};return e>1?(0,b.jsx)("div",{className:`skeleton-group ${f}`,children:Array.from({length:e}).map((a,c)=>(0,b.jsx)("div",{className:g(),style:h},c))}):(0,b.jsx)("div",{className:`${g()} ${f}`,style:h})}function j(){return(0,b.jsxs)("div",{className:"story-card skeleton-card-wrapper",children:[(0,b.jsx)(i,{type:"image",height:"200px"}),(0,b.jsxs)("div",{className:"story-card-content",children:[(0,b.jsx)(i,{type:"title",width:"80%"}),(0,b.jsx)(i,{type:"text",count:3}),(0,b.jsxs)("div",{className:"story-card-footer",children:[(0,b.jsx)(i,{type:"avatar",width:"32px",height:"32px"}),(0,b.jsx)(i,{type:"text",width:"100px"})]})]})]})}function k({count:a=6}){return(0,b.jsx)("div",{className:"stories-grid",children:Array.from({length:a}).map((a,c)=>(0,b.jsx)(j,{},c))})}var l=a.i(77929);function m(a,b){let c=[...a];if(b.query&&b.query.trim()){let a=b.query.toLowerCase();c=c.filter(b=>b.title.toLowerCase().includes(a)||b.content.toLowerCase().includes(a)||b.excerpt.toLowerCase().includes(a))}return b.category&&(c=c.filter(a=>a.category===b.category)),b.authorId&&(c=c.filter(a=>a.authorId===b.authorId)),b.startDate&&(c=c.filter(a=>a.createdAt>=b.startDate)),b.endDate&&(c=c.filter(a=>a.createdAt<=b.endDate)),b.sortBy&&(c=function(a,b){let c=[...a];switch(b){case"newest":return c.sort((a,b)=>b.createdAt.getTime()-a.createdAt.getTime());case"popular":return c.sort((a,b)=>{let c=a.stats.views+10*a.stats.comments+5*a.stats.likes;return b.stats.views+10*b.stats.comments+5*b.stats.likes-c});case"mostLiked":return c.sort((a,b)=>b.stats.likes-a.stats.likes);case"mostViewed":return c.sort((a,b)=>b.stats.views-a.stats.views);default:return c}}(c,b.sortBy)),c}function n(a){return Array.from(new Set(a.map(a=>a.category))).sort()}function o(a){let b=new Map;return a.forEach(a=>{a.authorId&&!b.has(a.authorId)&&b.set(a.authorId,a.author.name)}),Array.from(b.entries()).map(([a,b])=>({id:a,name:b})).sort((a,b)=>a.name.localeCompare(b.name))}function p(){let[a,e]=(0,c.useState)([]),[f,i]=(0,c.useState)([]),[j,p]=(0,c.useState)([]),[q,r]=(0,c.useState)(!0),[s,t]=(0,c.useState)(!0),[u,v]=(0,c.useState)(!1),[w,x]=(0,c.useState)(null),[y,z]=(0,c.useState)(""),[A,B]=(0,c.useState)(""),[C,D]=(0,c.useState)(""),[E,F]=(0,c.useState)("newest"),[G,H]=(0,c.useState)([]),[I,J]=(0,c.useState)([]);(0,c.useEffect)(()=>{async function a(){try{let{stories:a,lastDoc:b}=await (0,l.getStoriesPaginated)(12);e(a),i(a),t(null!==b),x(b),H(n(a)),J(o(a))}catch(a){console.error("Error loading stories:",a)}finally{r(!1)}}a(),a()},[]),(0,c.useEffect)(()=>{!async function(){try{let a=await fetch("/api/get-top-stories"),b=await a.json();if(b.success){let a=b.stories.map(a=>({...a,createdAt:new Date(a.createdAt)}));p(a)}}catch(a){console.error("Error fetching top stories:",a)}}()},[]);let K=async()=>{if(!u&&s&&w){v(!0);try{let{stories:b,lastDoc:c}=await (0,l.getStoriesPaginated)(12,w),d=[...a,...b];e(d),t(null!==c),x(c),H(n(d)),J(o(d));let f=m(d,{query:y,category:A||void 0,authorId:C||void 0,sortBy:E});i(f)}catch(a){console.error("Error loading more stories:",a)}finally{v(!1)}}};(0,c.useEffect)(()=>{i(m(a,{query:y,category:A||void 0,authorId:C||void 0,sortBy:E}))},[y,A,C,E,a]);let L=(0,c.useCallback)(a=>{z(a)},[]),M=()=>{z(""),B(""),D(""),F("newest")};return(0,b.jsxs)("div",{className:"home-page",children:[(0,b.jsx)("div",{className:"hero-section",children:(0,b.jsxs)("div",{className:"hero-content",children:[(0,b.jsx)("h1",{className:"hero-title",children:(0,b.jsx)("span",{className:"gradient-text",children:"Fabula"})}),(0,b.jsx)("p",{className:"hero-subtitle",children:"Hikayelerin buluÅŸma noktasÄ±. Oku, yorum yap, paylaÅŸ."})]})}),(0,b.jsxs)("main",{className:"main-content",children:[(0,b.jsxs)("div",{className:"search-filter-section",children:[(0,b.jsx)(g,{onSearch:L}),(0,b.jsx)(h,{categories:G,authors:I,selectedCategory:A,selectedAuthor:C,selectedSort:E,onCategoryChange:B,onAuthorChange:D,onSortChange:F,onClearFilters:M})]}),!y&&!A&&!C&&j.length>0&&(0,b.jsxs)("div",{className:"top-stories-section mb-12",children:[(0,b.jsxs)("div",{className:"section-header flex items-center gap-2 mb-6",children:[(0,b.jsx)("span",{className:"text-2xl",children:"ðŸ†"}),(0,b.jsx)("h2",{className:"text-2xl font-bold",children:"HaftanÄ±n En Ä°yileri"})]}),(0,b.jsx)("div",{className:"top-stories-grid grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:j.slice(0,3).map(a=>(0,b.jsx)(d.default,{story:a},a.id))})]}),(0,b.jsxs)("div",{className:"stories-header",children:[(0,b.jsx)("h2",{children:y?`"${y}" i\xe7in sonu\xe7lar`:"âœ¨ Hikayeler"}),(0,b.jsxs)("p",{children:[f.length," hikaye bulundu"]})]}),q?(0,b.jsx)(k,{count:12}):0===f.length?(0,b.jsxs)("div",{className:"empty-state",children:[(0,b.jsx)("span",{className:"empty-icon",children:"ðŸ”"}),(0,b.jsx)("p",{children:"AradÄ±ÄŸÄ±nÄ±z kriterlere uygun hikaye bulunamadÄ±."}),(y||A||C)&&(0,b.jsx)("button",{className:"browse-button",onClick:M,children:"TÃ¼m Hikayeleri GÃ¶ster"})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"stories-grid",children:f.map(a=>(0,b.jsx)(d.default,{story:a},a.id))}),s&&!y&&!A&&!C&&(0,b.jsx)("div",{className:"load-more-section",children:(0,b.jsx)("button",{className:"load-more-button",onClick:K,disabled:u,children:u?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("span",{className:"spinner-small"}),"YÃ¼kleniyor..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("span",{children:"ðŸ“š"}),"Daha Fazla Hikaye YÃ¼kle"]})})})]})]})]})}a.s(["default",()=>p],40777)}];

//# sourceMappingURL=_e9a6a9d6._.js.map