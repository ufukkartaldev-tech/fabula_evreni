(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,26633,e=>{"use strict";e.i(36180);var t=e.i(98925),r=e.i(53699);let a=(0,t.collection)(r.db,"stories"),s=(0,t.collection)(r.db,"comments");async function i(){console.warn("âš ï¸ getStories() is deprecated. Use getStoriesPaginated() for better performance.");try{let e=(0,t.query)(a,(0,t.orderBy)("createdAt","desc"));return(await (0,t.getDocs)(e)).docs.map(e=>{let t=e.data();return{id:e.id,...t,createdAt:t.createdAt?.toDate()||new Date}})}catch(e){return console.error("Error fetching stories:",e),[]}}async function o(e){try{let a=(0,t.doc)(r.db,"stories",e),s=await (0,t.getDoc)(a);if(!s.exists())return null;let i=s.data();return{id:s.id,...i,createdAt:i.createdAt?.toDate()||new Date}}catch(e){return console.error("Error fetching story:",e),null}}async function n(e){try{let r=(0,t.query)(s,(0,t.where)("storyId","==",e),(0,t.orderBy)("createdAt","desc")),a=(await (0,t.getDocs)(r)).docs.map(e=>{let t=e.data();return{id:e.id,...t,createdAt:t.createdAt?.toDate()||new Date}});return l(a)}catch(e){return console.error("Error fetching comments:",e),[]}}function l(e){let t=new Map,r=[];return e.forEach(e=>{t.set(e.id,{...e,replies:[]})}),e.forEach(e=>{let a=t.get(e.id);a&&r.push(a)}),r}async function c(e){try{return(await (0,t.addDoc)(s,{...e,createdAt:t.Timestamp.now()})).id}catch(e){throw console.error("Error adding comment:",e),e}}async function d(e){try{return(await (0,t.addDoc)(a,{...e,createdAt:t.Timestamp.now()})).id}catch(e){throw console.error("Error adding story:",e),e}}async function u(e){try{let a=(0,t.doc)(r.db,"stories",e);await (0,t.runTransaction)(r.db,async e=>{if(!(await e.get(a)).exists())throw Error("Story does not exist!");e.update(a,{"stats.views":(0,t.increment)(1)})})}catch(e){console.error("Error incrementing story views:",e)}}async function m(e,a){try{let s=(0,t.doc)(r.db,"stories",e);await (0,t.updateDoc)(s,{...a,updatedAt:t.Timestamp.now()})}catch(e){throw console.error("Error updating story:",e),e}}async function h(e){try{let a=(0,t.doc)(r.db,"stories",e);await (0,t.deleteDoc)(a)}catch(e){throw console.error("Error deleting story:",e),e}}function y(e,r){let s=r?(0,t.query)(a,(0,t.orderBy)("createdAt","desc"),(0,t.limit)(r)):(0,t.query)(a,(0,t.orderBy)("createdAt","desc"));return(0,t.onSnapshot)(s,t=>{e(t.docs.map(e=>{let t=e.data();return{id:e.id,...t,createdAt:t.createdAt?.toDate()||new Date}}))},e=>{console.error("Error in stories subscription:",e)})}function g(e,a){let s=(0,t.doc)(r.db,"stories",e);return(0,t.onSnapshot)(s,e=>{if(e.exists()){let t=e.data();a({id:e.id,...t,createdAt:t.createdAt?.toDate()||new Date})}else a(null)},e=>{console.error("Error in story subscription:",e)})}function f(e,r){let a=(0,t.query)(s,(0,t.where)("storyId","==",e),(0,t.orderBy)("createdAt","desc"));return(0,t.onSnapshot)(a,e=>{r(l(e.docs.map(e=>{let t=e.data();return{id:e.id,...t,createdAt:t.createdAt?.toDate()||new Date}})))},e=>{console.error("Error in comments subscription:",e)})}async function x(e=12,r){try{let s=(0,t.query)(a,(0,t.orderBy)("createdAt","desc"),(0,t.limit)(e));r&&(s=(0,t.query)(a,(0,t.orderBy)("createdAt","desc"),(0,t.startAfter)(r),(0,t.limit)(e)));let i=await (0,t.getDocs)(s),o=i.docs.map(e=>{let t=e.data();return{id:e.id,...t,createdAt:t.createdAt?.toDate()||new Date}}).filter(e=>"DELETED"!==e.status),n=i.docs[i.docs.length-1]||null;return{stories:o,lastDoc:n}}catch(e){return console.error("Error fetching paginated stories:",e),{stories:[],lastDoc:null}}}e.s(["addComment",()=>c,"addStory",()=>d,"deleteStory",()=>h,"getCommentsByStoryId",()=>n,"getStories",()=>i,"getStoriesPaginated",()=>x,"getStoryById",()=>o,"incrementStoryViews",()=>u,"subscribeToComments",()=>f,"subscribeToStories",()=>y,"subscribeToStory",()=>g,"updateStory",()=>m])},6062,74161,e=>{"use strict";var t=e.i(43476),r=e.i(932),a=e.i(71645),s=e.i(57951);function i({isOpen:e,onClose:r,targetId:i,targetType:o,targetContent:n}){let{user:l}=(0,s.useAuth)(),[c,d]=(0,a.useState)("spam"),[u,m]=(0,a.useState)(""),[h,y]=(0,a.useState)(!1),[g,f]=(0,a.useState)(!1);if(!e)return null;let x=async e=>{if(e.preventDefault(),l){y(!0);try{let e=await l.getIdToken();(await fetch("/api/report",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({targetId:i,targetType:o,targetContent:n,reason:c,description:u,idToken:e})})).ok?(f(!0),setTimeout(()=>{r(),f(!1),m(""),d("spam")},2e3)):alert("Rapor gÃ¶nderilirken bir hata oluÅŸtu.")}catch(e){console.error("Report error:",e),alert("Bir hata oluÅŸtu.")}finally{y(!1)}}};return(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:(0,t.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-xl w-full max-w-md overflow-hidden animate-scale-in",children:g?(0,t.jsxs)("div",{className:"p-8 text-center",children:[(0,t.jsx)("div",{className:"text-5xl mb-4",children:"âœ…"}),(0,t.jsx)("h3",{className:"text-xl font-bold text-gray-800 dark:text-white mb-2",children:"Rapor GÃ¶nderildi"}),(0,t.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"Bildiriminiz iÃ§in teÅŸekkÃ¼rler. Ä°ncelenecektir."})]}):(0,t.jsxs)("form",{onSubmit:x,className:"p-6",children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-gray-800 dark:text-white mb-4",children:"Ä°Ã§eriÄŸi Raporla"}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Sebep"}),(0,t.jsxs)("select",{value:c,onChange:e=>d(e.target.value),className:"w-full p-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[(0,t.jsx)("option",{value:"spam",children:"Spam / Reklam"}),(0,t.jsx)("option",{value:"harassment",children:"Taciz / ZorbalÄ±k"}),(0,t.jsx)("option",{value:"inappropriate",children:"Uygunsuz Ä°Ã§erik"}),(0,t.jsx)("option",{value:"other",children:"DiÄŸer"})]})]}),(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"AÃ§Ä±klama (Opsiyonel)"}),(0,t.jsx)("textarea",{value:u,onChange:e=>m(e.target.value),className:"w-full p-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white h-24 resize-none",placeholder:"Daha fazla detay..."})]}),(0,t.jsxs)("div",{className:"flex gap-3 justify-end",children:[(0,t.jsx)("button",{type:"button",onClick:r,className:"px-4 py-2 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:"Ä°ptal"}),(0,t.jsx)("button",{type:"submit",disabled:h,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50",children:h?"GÃ¶nderiliyor...":"Raporla"})]})]})})})}function o(e){let s,o,n,l,c,d=(0,r.c)(12),{targetId:u,targetType:m,targetContent:h,className:y}=e,[g,f]=(0,a.useState)(!1);d[0]===Symbol.for("react.memo_cache_sentinel")?(s=()=>f(!0),d[0]=s):s=d[0];let x=`text-gray-400 hover:text-red-500 transition-colors ${void 0===y?"":y}`;return d[1]!==x?(o=(0,t.jsx)("button",{onClick:s,className:x,title:"Raporla",children:"ðŸš©"}),d[1]=x,d[2]=o):o=d[2],d[3]===Symbol.for("react.memo_cache_sentinel")?(n=()=>f(!1),d[3]=n):n=d[3],d[4]!==g||d[5]!==h||d[6]!==u||d[7]!==m?(l=(0,t.jsx)(i,{isOpen:g,onClose:n,targetId:u,targetType:m,targetContent:h}),d[4]=g,d[5]=h,d[6]=u,d[7]=m,d[8]=l):l=d[8],d[9]!==o||d[10]!==l?(c=(0,t.jsxs)(t.Fragment,{children:[o,l]}),d[9]=o,d[10]=l,d[11]=c):c=d[11],c}function n({storyId:e,className:r=""}){let{user:i}=(0,s.useAuth)(),[o,n]=(0,a.useState)(!1),[l,c]=(0,a.useState)([]),[d,u]=(0,a.useState)(!1),[m,h]=(0,a.useState)(""),[y,g]=(0,a.useState)(!1),f=async()=>{if(i){u(!0);try{let e=await fetch(`/api/collections?userId=${i.uid}`),t=await e.json();t.collections&&c(t.collections)}catch(e){console.error("Error fetching collections:",e)}finally{u(!1)}}},x=async()=>{if(m.trim()&&i){g(!0);try{let e=await i.getIdToken();(await fetch("/api/collections",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:m,idToken:e})})).ok&&(h(""),f())}catch(e){console.error("Error creating collection:",e)}finally{g(!1)}}},p=async t=>{if(!i)return;let r=t.storyIds?.includes(e);try{let a=await i.getIdToken();(await fetch(`/api/collections/${t.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:r?"remove_story":"add_story",storyId:e,idToken:a})})).ok&&c(l.map(a=>{if(a.id===t.id){let t=r?a.storyIds.filter(t=>t!==e):[...a.storyIds||[],e];return{...a,storyIds:t}}return a}))}catch(e){console.error("Error updating collection:",e)}};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{onClick:()=>{i?(n(!0),f()):alert("LÃ¼tfen Ã¶nce giriÅŸ yapÄ±n.")},className:`text-gray-400 hover:text-indigo-500 transition-colors ${r}`,title:"Listeye Ekle",children:"ðŸ”–"}),o&&(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-xl w-full max-w-md overflow-hidden animate-scale-in",children:[(0,t.jsxs)("div",{className:"p-4 border-b border-gray-100 dark:border-gray-700 flex justify-between items-center",children:[(0,t.jsx)("h3",{className:"font-bold text-gray-800 dark:text-white",children:"Listeye Ekle"}),(0,t.jsx)("button",{onClick:()=>n(!1),className:"text-gray-500 hover:text-gray-700",children:"âœ•"})]}),(0,t.jsx)("div",{className:"p-4 max-h-64 overflow-y-auto",children:d?(0,t.jsx)("div",{className:"text-center py-4",children:"YÃ¼kleniyor..."}):0===l.length?(0,t.jsx)("div",{className:"text-center py-4 text-gray-500",children:"HenÃ¼z listeniz yok."}):(0,t.jsx)("div",{className:"space-y-2",children:l.map(r=>{let a=r.storyIds?.includes(e);return(0,t.jsxs)("button",{onClick:()=>p(r),className:`w-full flex items-center justify-between p-3 rounded-lg border transition-all ${a?"border-indigo-500 bg-indigo-50 dark:bg-indigo-900/20 text-indigo-700 dark:text-indigo-300":"border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:[(0,t.jsx)("span",{className:"font-medium",children:r.name}),a&&(0,t.jsx)("span",{children:"âœ“"})]},r.id)})})}),(0,t.jsx)("div",{className:"p-4 bg-gray-50 dark:bg-gray-700/50 border-t border-gray-100 dark:border-gray-700",children:(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("input",{type:"text",value:m,onChange:e=>h(e.target.value),placeholder:"Yeni liste adÄ±...",className:"flex-1 p-2 rounded border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-sm"}),(0,t.jsx)("button",{onClick:x,disabled:y||!m.trim(),className:"px-3 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700 disabled:opacity-50 text-sm font-medium",children:y?"...":"OluÅŸtur"})]})})]})})]})}e.s(["default",()=>o],6062),e.s(["default",()=>n],74161)},67277,e=>{"use strict";var t=e.i(43476),r=e.i(71645),a=e.i(57951);e.i(36180);var s=e.i(98925),i=e.i(53699);async function o(e,t){try{let r=`${e}_story_${t}`,a=(0,s.doc)(i.db,"likes",r),o=(0,s.doc)(i.db,"stories",t);return await (0,s.runTransaction)(i.db,async r=>{let i=await r.get(a);if(!(await r.get(o)).exists())throw Error("Story does not exist!");return i.exists()?(r.delete(a),r.update(o,{"stats.likes":(0,s.increment)(-1)}),!1):(r.set(a,{userId:e,targetId:t,targetType:"story",createdAt:s.Timestamp.now()}),r.update(o,{"stats.likes":(0,s.increment)(1)}),!0)})}catch(e){throw console.error("Error toggling story like:",e),e}}async function n(e,t){try{let r=`${e}_comment_${t}`,a=(0,s.doc)(i.db,"likes",r),o=(0,s.doc)(i.db,"comments",t);return await (0,s.runTransaction)(i.db,async r=>{let i=await r.get(a);if(!(await r.get(o)).exists())throw Error("Comment does not exist!");return i.exists()?(r.delete(a),r.update(o,{likes:(0,s.increment)(-1)}),!1):(r.set(a,{userId:e,targetId:t,targetType:"comment",createdAt:s.Timestamp.now()}),r.update(o,{likes:(0,s.increment)(1)}),!0)})}catch(e){throw console.error("Error toggling comment like:",e),e}}(0,s.collection)(i.db,"likes");var l=e.i(25661);function c({targetId:e,targetType:s,initialLikeCount:i,size:c="medium",storyAuthorId:d,storyTitle:u}){let{user:m}=(0,a.useAuth)(),[h,y]=(0,r.useState)(!1),[g,f]=(0,r.useState)(i),[x,p]=(0,r.useState)(!1),[b,v]=(0,r.useState)(!0),j=async()=>{if(!m||x)return;p(!0);let t=!h,r=t?g+1:g-1;y(t),f(r);try{let t="story"===s?await o(m.uid,e):await n(m.uid,e);if(y(t),t&&"story"===s&&d&&u&&d!==m.uid)try{await (0,l.createNotification)({userId:d,type:"like",actorId:m.uid,actorName:m.displayName||"KullanÄ±cÄ±",actorAvatar:m.photoURL||"ðŸ‘¤",storyId:e,storyTitle:u,message:"hikayenizi beÄŸendi"})}catch(e){console.error("Error creating notification:",e)}}catch(e){console.error("Error toggling like:",e),y(!t),f(g)}finally{p(!1)}};return b?null:(0,t.jsxs)("button",{className:`like-button ${{small:"like-button-small",medium:"like-button-medium",large:"like-button-large"}[c]} ${h?"liked":""} ${!m?"disabled":""}`,onClick:j,disabled:!m||x,title:m?h?"BeÄŸeniyi kaldÄ±r":"BeÄŸen":"BeÄŸenmek iÃ§in giriÅŸ yapÄ±n",children:[(0,t.jsx)("span",{className:"like-icon",children:h?"â¤ï¸":"ðŸ¤"}),(0,t.jsx)("span",{className:"like-count",children:g})]})}e.s(["default",()=>c],67277)},30211,e=>{"use strict";e.i(36180);var t=e.i(98925),r=e.i(53699),a=e.i(26633);let s=(0,t.collection)(r.db,"favorites");async function i(e,a){try{let s=`${e}_${a}`,i=(0,t.doc)(r.db,"favorites",s);if((await (0,t.getDoc)(i)).exists())return await (0,t.deleteDoc)(i),!1;return await (0,t.setDoc)(i,{userId:e,storyId:a,createdAt:t.Timestamp.now()}),!0}catch(e){throw console.error("Error toggling favorite:",e),e}}async function o(e,a){try{let s=`${e}_${a}`,i=(0,t.doc)(r.db,"favorites",s);return(await (0,t.getDoc)(i)).exists()}catch(e){return console.error("Error checking favorite:",e),!1}}async function n(e){try{let r=(0,t.query)(s,(0,t.where)("userId","==",e)),i=await (0,t.getDocs)(r),o=i.docs.map(e=>e.data().storyId);if(0===o.length)return[];let n=(await (0,a.getStories)()).filter(e=>o.includes(e.id)),l=new Map(i.docs.map(e=>[e.data().storyId,e.data().createdAt?.toDate()||new Date]));return n.sort((e,t)=>{let r=l.get(e.id)||new Date(0);return(l.get(t.id)||new Date(0)).getTime()-r.getTime()})}catch(e){return console.error("Error fetching user favorites:",e),[]}}e.s(["getUserFavorites",()=>n,"isFavorited",()=>o,"toggleFavorite",()=>i])},97263,e=>{"use strict";var t=e.i(43476),r=e.i(932),a=e.i(18566),s=e.i(67277),i=e.i(71645),o=e.i(57951),n=e.i(30211);function l({storyId:e,size:r="medium"}){let{user:a}=(0,o.useAuth)(),[s,l]=(0,i.useState)(!1),[c,d]=(0,i.useState)(!1),[u,m]=(0,i.useState)(!0);(0,i.useEffect)(()=>{a?async function(){if(a)try{let t=await (0,n.isFavorited)(a.uid,e);l(t)}catch(e){console.error("Error checking favorite status:",e)}finally{m(!1)}}():m(!1)},[a,e]);let h=async t=>{if(t.stopPropagation(),!a||c)return;d(!0);let r=!s;l(r);try{let t=await (0,n.toggleFavorite)(a.uid,e);l(t)}catch(e){console.error("Error toggling favorite:",e),l(!r)}finally{d(!1)}};return u?null:(0,t.jsx)("button",{className:`favorite-button ${{small:"favorite-button-small",medium:"favorite-button-medium",large:"favorite-button-large"}[r]} ${s?"favorited":""} ${!a?"disabled":""}`,onClick:h,disabled:!a||c,title:a?s?"Favorilerden Ã§Ä±kar":"Favorilere ekle":"Favori eklemek iÃ§in giriÅŸ yapÄ±n",children:(0,t.jsx)("span",{className:"favorite-icon",children:s?"â­":"â˜†"})})}var c=e.i(6062),d=e.i(74161);function u(e){let i,o,n,u,h,y,g,f,x,p,b,v,j,k,w,N,S,A,T,E,D,C,_,I,$,B,F=(0,r.c)(67),{story:z}=e,O=(0,a.useRouter)();if(F[0]!==z.content){let e;i=(e=Math.max(1,Math.ceil(z.content.trim().split(/\s+/).filter(e=>e.length>0).length/200)))<=3?`âš¡ ${e} dk`:e<=10?`ðŸ“– ${e} dk`:`ðŸ“š ${e} dk`,F[0]=z.content,F[1]=i}else i=F[1];let R=i,q=m;F[2]!==O||F[3]!==z.id?(o=e=>{e.target.closest(".like-button")||e.target.closest("button")||O.push(`/story/${z.id}`)},F[2]=O,F[3]=z.id,F[4]=o):o=F[4];let L=o;return F[5]!==z.category?(n=(0,t.jsx)("span",{className:"category-badge",children:z.category}),F[5]=z.category,F[6]=n):n=F[6],F[7]!==R?(u=(0,t.jsx)("span",{className:"reading-time-badge",children:R}),F[7]=R,F[8]=u):u=F[8],F[9]!==z.id?(h=(0,t.jsx)(l,{storyId:z.id,size:"small"}),y=(0,t.jsx)(d.default,{storyId:z.id}),F[9]=z.id,F[10]=h,F[11]=y):(h=F[10],y=F[11]),F[12]!==z.id||F[13]!==z.title?(g=(0,t.jsx)(c.default,{targetId:z.id,targetType:"story",targetContent:z.title,className:"opacity-50 hover:opacity-100"}),F[12]=z.id,F[13]=z.title,F[14]=g):g=F[14],F[15]!==z.createdAt?(f=function(e){return e.toLocaleDateString("tr-TR",{year:"numeric",month:"long",day:"numeric"})}(z.createdAt),F[15]=z.createdAt,F[16]=f):f=F[16],F[17]!==f?(x=(0,t.jsx)("span",{className:"story-date",children:f}),F[17]=f,F[18]=x):x=F[18],F[19]!==u||F[20]!==h||F[21]!==y||F[22]!==g||F[23]!==x?(p=(0,t.jsxs)("div",{className:"header-actions",children:[u,h,y,g,x]}),F[19]=u,F[20]=h,F[21]=y,F[22]=g,F[23]=x,F[24]=p):p=F[24],F[25]!==p||F[26]!==n?(b=(0,t.jsxs)("div",{className:"story-card-header",children:[n,p]}),F[25]=p,F[26]=n,F[27]=b):b=F[27],F[28]!==z.title?(v=(0,t.jsx)("h3",{className:"story-title",children:z.title}),F[28]=z.title,F[29]=v):v=F[29],F[30]!==z.excerpt?(j=(0,t.jsx)("p",{className:"story-excerpt",children:z.excerpt}),F[30]=z.excerpt,F[31]=j):j=F[31],F[32]!==z.author.avatar?(k=(0,t.jsx)("span",{className:"author-avatar",children:z.author.avatar}),F[32]=z.author.avatar,F[33]=k):k=F[33],F[34]!==z.author.name?(w=(0,t.jsx)("span",{className:"author-name",children:z.author.name}),F[34]=z.author.name,F[35]=w):w=F[35],F[36]!==k||F[37]!==w?(N=(0,t.jsxs)("div",{className:"author-info",children:[k,w]}),F[36]=k,F[37]=w,F[38]=N):N=F[38],F[39]===Symbol.for("react.memo_cache_sentinel")?(S=(0,t.jsx)("span",{className:"stat-icon",children:"ðŸ‘ï¸"}),F[39]=S):S=F[39],F[40]!==z.stats.views?(A=q(z.stats.views),F[40]=z.stats.views,F[41]=A):A=F[41],F[42]!==A?(T=(0,t.jsxs)("span",{className:"stat",children:[S,A]}),F[42]=A,F[43]=T):T=F[43],F[44]===Symbol.for("react.memo_cache_sentinel")?(E=(0,t.jsx)("span",{className:"stat-icon",children:"ðŸ’¬"}),F[44]=E):E=F[44],F[45]!==z.stats.comments?(D=q(z.stats.comments),F[45]=z.stats.comments,F[46]=D):D=F[46],F[47]!==D?(C=(0,t.jsxs)("span",{className:"stat",children:[E,D]}),F[47]=D,F[48]=C):C=F[48],F[49]!==z.authorId||F[50]!==z.id||F[51]!==z.stats.likes||F[52]!==z.title?(_=(0,t.jsx)(s.default,{targetId:z.id,targetType:"story",initialLikeCount:z.stats.likes,size:"small",storyAuthorId:z.authorId,storyTitle:z.title}),F[49]=z.authorId,F[50]=z.id,F[51]=z.stats.likes,F[52]=z.title,F[53]=_):_=F[53],F[54]!==T||F[55]!==C||F[56]!==_?(I=(0,t.jsxs)("div",{className:"story-stats",children:[T,C,_]}),F[54]=T,F[55]=C,F[56]=_,F[57]=I):I=F[57],F[58]!==N||F[59]!==I?($=(0,t.jsxs)("div",{className:"story-footer",children:[N,I]}),F[58]=N,F[59]=I,F[60]=$):$=F[60],F[61]!==L||F[62]!==b||F[63]!==v||F[64]!==j||F[65]!==$?(B=(0,t.jsxs)("div",{className:"story-card",onClick:L,children:[b,v,j,$]}),F[61]=L,F[62]=b,F[63]=v,F[64]=j,F[65]=$,F[66]=B):B=F[66],B}function m(e){return e>=1e3?`${(e/1e3).toFixed(1)}k`:e.toString()}e.s(["default",()=>u],97263)},78333,(e,t,r)=>{var a=0/0,s=/^\s+|\s+$/g,i=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,n=/^0o[0-7]+$/i,l=parseInt,c=e.g&&e.g.Object===Object&&e.g,d="object"==typeof self&&self&&self.Object===Object&&self,u=c||d||Function("return this")(),m=Object.prototype.toString,h=Math.max,y=Math.min,g=function(){return u.Date.now()};function f(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function x(e){if("number"==typeof e)return e;if("symbol"==typeof(t=e)||t&&"object"==typeof t&&"[object Symbol]"==m.call(t))return a;if(f(e)){var t,r="function"==typeof e.valueOf?e.valueOf():e;e=f(r)?r+"":r}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(s,"");var c=o.test(e);return c||n.test(e)?l(e.slice(2),c?2:8):i.test(e)?a:+e}t.exports=function(e,t,r){var a,s,i,o,n,l,c=0,d=!1,u=!1,m=!0;if("function"!=typeof e)throw TypeError("Expected a function");function p(t){var r=a,i=s;return a=s=void 0,c=t,o=e.apply(i,r)}function b(e){var r=e-l,a=e-c;return void 0===l||r>=t||r<0||u&&a>=i}function v(){var e,r,a,s=g();if(b(s))return j(s);n=setTimeout(v,(e=s-l,r=s-c,a=t-e,u?y(a,i-r):a))}function j(e){return(n=void 0,m&&a)?p(e):(a=s=void 0,o)}function k(){var e,r=g(),i=b(r);if(a=arguments,s=this,l=r,i){if(void 0===n)return c=e=l,n=setTimeout(v,t),d?p(e):o;if(u)return n=setTimeout(v,t),p(l)}return void 0===n&&(n=setTimeout(v,t)),o}return t=x(t)||0,f(r)&&(d=!!r.leading,i=(u="maxWait"in r)?h(x(r.maxWait)||0,t):i,m="trailing"in r?!!r.trailing:m),k.cancel=function(){void 0!==n&&clearTimeout(n),c=0,a=l=s=n=void 0},k.flush=function(){return void 0===n?o:j(g())},k}},52683,e=>{"use strict";var t=e.i(43476),r=e.i(71645),a=e.i(97263),s=e.i(932),i=e.i(78333);let o=(e,t=400)=>(0,i.default)(e,t);function n(e){let a,o,n,l,c,d,u,m,h,y=(0,s.c)(16),{onSearch:g,placeholder:f}=e,x=void 0===f?"Hikaye ara...":f,[p,b]=(0,r.useState)("");y[0]!==g?(a=((e,t=300)=>(0,i.default)(e,t))(e=>{g(e)},300),y[0]=g,y[1]=a):a=y[1];let v=(0,r.useRef)(a);y[2]!==p?(o=()=>{v.current(p)},n=[p],y[2]=p,y[3]=o,y[4]=n):(o=y[3],n=y[4]),(0,r.useEffect)(o,n),y[5]===Symbol.for("react.memo_cache_sentinel")?(l=()=>{b("")},y[5]=l):l=y[5];let j=l;return y[6]===Symbol.for("react.memo_cache_sentinel")?(c=(0,t.jsx)("span",{className:"search-icon",children:"ðŸ”"}),y[6]=c):c=y[6],y[7]===Symbol.for("react.memo_cache_sentinel")?(d=e=>b(e.target.value),y[7]=d):d=y[7],y[8]!==x||y[9]!==p?(u=(0,t.jsx)("input",{type:"text",className:"search-input",placeholder:x,value:p,onChange:d}),y[8]=x,y[9]=p,y[10]=u):u=y[10],y[11]!==p?(m=p&&(0,t.jsx)("button",{className:"search-clear",onClick:j,title:"Temizle",children:"âœ•"}),y[11]=p,y[12]=m):m=y[12],y[13]!==u||y[14]!==m?(h=(0,t.jsxs)("div",{className:"search-bar",children:[c,u,m]}),y[13]=u,y[14]=m,y[15]=h):h=y[15],h}function l(e){let a,i,n,l,u,m,h,y,g,f,x,p,b,v,j,k,w,N,S,A,T,E,D=(0,s.c)(38),{categories:C,authors:_,selectedCategory:I,selectedAuthor:$,selectedSort:B,onCategoryChange:F,onAuthorChange:z,onSortChange:O,onClearFilters:R}=e,q=I||$||"newest"!==B;D[0]!==F?(a=o(e=>{F(e)},400),D[0]=F,D[1]=a):a=D[1];let L=(0,r.useRef)(a);D[2]!==z?(i=o(e=>{z(e)},400),D[2]=z,D[3]=i):i=D[3];let P=(0,r.useRef)(i);D[4]!==O?(n=o(e=>{O(e)},400),D[4]=O,D[5]=n):n=D[5];let H=(0,r.useRef)(n);D[6]===Symbol.for("react.memo_cache_sentinel")?(l=(0,t.jsx)("label",{className:"filter-label",children:"Kategori"}),D[6]=l):l=D[6];let M=I||"";D[7]===Symbol.for("react.memo_cache_sentinel")?(u=e=>L.current(e.target.value),m=(0,t.jsx)("option",{value:"",children:"TÃ¼m Kategoriler"}),D[7]=u,D[8]=m):(u=D[7],m=D[8]),D[9]!==C?(h=C.map(d),D[9]=C,D[10]=h):h=D[10],D[11]!==M||D[12]!==h?(y=(0,t.jsxs)("div",{className:"filter-group",children:[l,(0,t.jsxs)("select",{className:"filter-select",value:M,onChange:u,children:[m,h]})]}),D[11]=M,D[12]=h,D[13]=y):y=D[13],D[14]===Symbol.for("react.memo_cache_sentinel")?(g=(0,t.jsx)("label",{className:"filter-label",children:"Yazar"}),D[14]=g):g=D[14];let U=$||"";return D[15]===Symbol.for("react.memo_cache_sentinel")?(f=e=>P.current(e.target.value),x=(0,t.jsx)("option",{value:"",children:"TÃ¼m Yazarlar"}),D[15]=f,D[16]=x):(f=D[15],x=D[16]),D[17]!==_?(p=_.map(c),D[17]=_,D[18]=p):p=D[18],D[19]!==U||D[20]!==p?(b=(0,t.jsxs)("div",{className:"filter-group",children:[g,(0,t.jsxs)("select",{className:"filter-select",value:U,onChange:f,children:[x,p]})]}),D[19]=U,D[20]=p,D[21]=b):b=D[21],D[22]===Symbol.for("react.memo_cache_sentinel")?(v=(0,t.jsx)("label",{className:"filter-label",children:"SÄ±ralama"}),D[22]=v):v=D[22],D[23]===Symbol.for("react.memo_cache_sentinel")?(j=e=>H.current(e.target.value),k=(0,t.jsx)("option",{value:"newest",children:"En Yeni"}),w=(0,t.jsx)("option",{value:"popular",children:"En PopÃ¼ler"}),N=(0,t.jsx)("option",{value:"mostLiked",children:"En Ã‡ok BeÄŸenilen"}),S=(0,t.jsx)("option",{value:"mostViewed",children:"En Ã‡ok GÃ¶rÃ¼ntÃ¼lenen"}),D[23]=j,D[24]=k,D[25]=w,D[26]=N,D[27]=S):(j=D[23],k=D[24],w=D[25],N=D[26],S=D[27]),D[28]!==B?(A=(0,t.jsxs)("div",{className:"filter-group",children:[v,(0,t.jsxs)("select",{className:"filter-select",value:B,onChange:j,children:[k,w,N,S]})]}),D[28]=B,D[29]=A):A=D[29],D[30]!==q||D[31]!==R?(T=q&&(0,t.jsxs)("button",{className:"clear-filters-button",onClick:R,children:[(0,t.jsx)("span",{children:"ðŸ”„"}),"Filtreleri Temizle"]}),D[30]=q,D[31]=R,D[32]=T):T=D[32],D[33]!==b||D[34]!==A||D[35]!==T||D[36]!==y?(E=(0,t.jsxs)("div",{className:"filter-panel",children:[y,b,A,T]}),D[33]=b,D[34]=A,D[35]=T,D[36]=y,D[37]=E):E=D[37],E}function c(e){return(0,t.jsx)("option",{value:e.id,children:e.name},e.id)}function d(e){return(0,t.jsx)("option",{value:e,children:e},e)}function u(e){let r,a,i,o=(0,s.c)(17),{type:n,width:l,height:c,count:d,className:u}=e,m=void 0===n?"text":n,h=void 0===d?1:d,y=void 0===u?"":u;o[0]!==m?(r=()=>{switch(m){case"title":return"skeleton skeleton-title";case"card":return"skeleton skeleton-card";case"avatar":return"skeleton skeleton-avatar";case"image":return"skeleton skeleton-image";default:return"skeleton skeleton-text"}},o[0]=m,o[1]=r):r=o[1];let g=r,f=l||void 0,x=c||void 0;o[2]!==f||o[3]!==x?(a={width:f,height:x},o[2]=f,o[3]=x,o[4]=a):a=o[4];let p=a;if(h>1){let e,r,a,s=`skeleton-group ${y}`;return o[5]!==h?(e=Array.from({length:h}),o[5]=h,o[6]=e):e=o[6],o[7]!==g||o[8]!==p||o[9]!==e?(r=e.map((e,r)=>(0,t.jsx)("div",{className:g(),style:p},r)),o[7]=g,o[8]=p,o[9]=e,o[10]=r):r=o[10],o[11]!==r||o[12]!==s?(a=(0,t.jsx)("div",{className:s,children:r}),o[11]=r,o[12]=s,o[13]=a):a=o[13],a}let b=`${g()} ${y}`;return o[14]!==p||o[15]!==b?(i=(0,t.jsx)("div",{className:b,style:p}),o[14]=p,o[15]=b,o[16]=i):i=o[16],i}function m(){let e,r,a,i,o=(0,s.c)(4);return o[0]===Symbol.for("react.memo_cache_sentinel")?(e=(0,t.jsx)(u,{type:"image",height:"200px"}),o[0]=e):e=o[0],o[1]===Symbol.for("react.memo_cache_sentinel")?(r=(0,t.jsx)(u,{type:"title",width:"80%"}),a=(0,t.jsx)(u,{type:"text",count:3}),o[1]=r,o[2]=a):(r=o[1],a=o[2]),o[3]===Symbol.for("react.memo_cache_sentinel")?(i=(0,t.jsxs)("div",{className:"story-card skeleton-card-wrapper",children:[e,(0,t.jsxs)("div",{className:"story-card-content",children:[r,a,(0,t.jsxs)("div",{className:"story-card-footer",children:[(0,t.jsx)(u,{type:"avatar",width:"32px",height:"32px"}),(0,t.jsx)(u,{type:"text",width:"100px"})]})]})]}),o[3]=i):i=o[3],i}function h(e){let r,a=(0,s.c)(2),{count:i}=e,o=void 0===i?6:i;return a[0]!==o?(r=(0,t.jsx)("div",{className:"stories-grid",children:Array.from({length:o}).map(y)}),a[0]=o,a[1]=r):r=a[1],r}function y(e,r){return(0,t.jsx)(m,{},r)}var g=e.i(26633);function f(e,t){let r=[...e];if(t.query&&t.query.trim()){let e=t.query.toLowerCase();r=r.filter(t=>t.title.toLowerCase().includes(e)||t.content.toLowerCase().includes(e)||t.excerpt.toLowerCase().includes(e))}return t.category&&(r=r.filter(e=>e.category===t.category)),t.authorId&&(r=r.filter(e=>e.authorId===t.authorId)),t.startDate&&(r=r.filter(e=>e.createdAt>=t.startDate)),t.endDate&&(r=r.filter(e=>e.createdAt<=t.endDate)),t.sortBy&&(r=function(e,t){let r=[...e];switch(t){case"newest":return r.sort((e,t)=>t.createdAt.getTime()-e.createdAt.getTime());case"popular":return r.sort((e,t)=>{let r=e.stats.views+10*e.stats.comments+5*e.stats.likes;return t.stats.views+10*t.stats.comments+5*t.stats.likes-r});case"mostLiked":return r.sort((e,t)=>t.stats.likes-e.stats.likes);case"mostViewed":return r.sort((e,t)=>t.stats.views-e.stats.views);default:return r}}(r,t.sortBy)),r}function x(e){return Array.from(new Set(e.map(e=>e.category))).sort()}function p(e){let t=new Map;return e.forEach(e=>{e.authorId&&!t.has(e.authorId)&&t.set(e.authorId,e.author.name)}),Array.from(t.entries()).map(([e,t])=>({id:e,name:t})).sort((e,t)=>e.name.localeCompare(t.name))}function b(){let[e,s]=(0,r.useState)([]),[i,o]=(0,r.useState)([]),[c,d]=(0,r.useState)([]),[u,m]=(0,r.useState)(!0),[y,b]=(0,r.useState)(!0),[v,j]=(0,r.useState)(!1),[k,w]=(0,r.useState)(null),[N,S]=(0,r.useState)(""),[A,T]=(0,r.useState)(""),[E,D]=(0,r.useState)(""),[C,_]=(0,r.useState)("newest"),[I,$]=(0,r.useState)([]),[B,F]=(0,r.useState)([]);(0,r.useEffect)(()=>{async function e(){try{let{stories:e,lastDoc:t}=await (0,g.getStoriesPaginated)(12);s(e),o(e),b(null!==t),w(t),$(x(e)),F(p(e))}catch(e){console.error("Error loading stories:",e)}finally{m(!1)}}e(),e()},[]),(0,r.useEffect)(()=>{!async function(){try{let e=await fetch("/api/get-top-stories"),t=await e.json();if(t.success){let e=t.stories.map(e=>({...e,createdAt:new Date(e.createdAt)}));d(e)}}catch(e){console.error("Error fetching top stories:",e)}}()},[]);let z=async()=>{if(!v&&y&&k){j(!0);try{let{stories:t,lastDoc:r}=await (0,g.getStoriesPaginated)(12,k),a=[...e,...t];s(a),b(null!==r),w(r),$(x(a)),F(p(a));let i=f(a,{query:N,category:A||void 0,authorId:E||void 0,sortBy:C});o(i)}catch(e){console.error("Error loading more stories:",e)}finally{j(!1)}}};(0,r.useEffect)(()=>{o(f(e,{query:N,category:A||void 0,authorId:E||void 0,sortBy:C}))},[N,A,E,C,e]);let O=(0,r.useCallback)(e=>{S(e)},[]),R=()=>{S(""),T(""),D(""),_("newest")};return(0,t.jsxs)("div",{className:"home-page",children:[(0,t.jsx)("div",{className:"hero-section",children:(0,t.jsxs)("div",{className:"hero-content",children:[(0,t.jsx)("h1",{className:"hero-title",children:(0,t.jsx)("span",{className:"gradient-text",children:"Fabula"})}),(0,t.jsx)("p",{className:"hero-subtitle",children:"Hikayelerin buluÅŸma noktasÄ±. Oku, yorum yap, paylaÅŸ."})]})}),(0,t.jsxs)("main",{className:"main-content",children:[(0,t.jsxs)("div",{className:"search-filter-section",children:[(0,t.jsx)(n,{onSearch:O}),(0,t.jsx)(l,{categories:I,authors:B,selectedCategory:A,selectedAuthor:E,selectedSort:C,onCategoryChange:T,onAuthorChange:D,onSortChange:_,onClearFilters:R})]}),!N&&!A&&!E&&c.length>0&&(0,t.jsxs)("div",{className:"top-stories-section mb-12",children:[(0,t.jsxs)("div",{className:"section-header flex items-center gap-2 mb-6",children:[(0,t.jsx)("span",{className:"text-2xl",children:"ðŸ†"}),(0,t.jsx)("h2",{className:"text-2xl font-bold",children:"HaftanÄ±n En Ä°yileri"})]}),(0,t.jsx)("div",{className:"top-stories-grid grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:c.slice(0,3).map(e=>(0,t.jsx)(a.default,{story:e},e.id))})]}),(0,t.jsxs)("div",{className:"stories-header",children:[(0,t.jsx)("h2",{children:N?`"${N}" i\xe7in sonu\xe7lar`:"âœ¨ Hikayeler"}),(0,t.jsxs)("p",{children:[i.length," hikaye bulundu"]})]}),u?(0,t.jsx)(h,{count:12}):0===i.length?(0,t.jsxs)("div",{className:"empty-state",children:[(0,t.jsx)("span",{className:"empty-icon",children:"ðŸ”"}),(0,t.jsx)("p",{children:"AradÄ±ÄŸÄ±nÄ±z kriterlere uygun hikaye bulunamadÄ±."}),(N||A||E)&&(0,t.jsx)("button",{className:"browse-button",onClick:R,children:"TÃ¼m Hikayeleri GÃ¶ster"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"stories-grid",children:i.map(e=>(0,t.jsx)(a.default,{story:e},e.id))}),y&&!N&&!A&&!E&&(0,t.jsx)("div",{className:"load-more-section",children:(0,t.jsx)("button",{className:"load-more-button",onClick:z,disabled:v,children:v?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:"spinner-small"}),"YÃ¼kleniyor..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{children:"ðŸ“š"}),"Daha Fazla Hikaye YÃ¼kle"]})})})]})]})]})}e.s(["default",()=>b],52683)}]);