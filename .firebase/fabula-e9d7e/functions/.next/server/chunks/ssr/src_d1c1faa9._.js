module.exports=[33396,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(11642);a.i(69387);var e=a.i(60574),f=a.i(79353);async function g(a,b){try{let c=`${a}_story_${b}`,d=(0,e.doc)(f.db,"likes",c),g=(0,e.doc)(f.db,"stories",b);return await (0,e.runTransaction)(f.db,async c=>{let f=await c.get(d);if(!(await c.get(g)).exists())throw Error("Story does not exist!");return f.exists()?(c.delete(d),c.update(g,{"stats.likes":(0,e.increment)(-1)}),!1):(c.set(d,{userId:a,targetId:b,targetType:"story",createdAt:e.Timestamp.now()}),c.update(g,{"stats.likes":(0,e.increment)(1)}),!0)})}catch(a){throw console.error("Error toggling story like:",a),a}}async function h(a,b){try{let c=`${a}_comment_${b}`,d=(0,e.doc)(f.db,"likes",c),g=(0,e.doc)(f.db,"comments",b);return await (0,e.runTransaction)(f.db,async c=>{let f=await c.get(d);if(!(await c.get(g)).exists())throw Error("Comment does not exist!");return f.exists()?(c.delete(d),c.update(g,{likes:(0,e.increment)(-1)}),!1):(c.set(d,{userId:a,targetId:b,targetType:"comment",createdAt:e.Timestamp.now()}),c.update(g,{likes:(0,e.increment)(1)}),!0)})}catch(a){throw console.error("Error toggling comment like:",a),a}}(0,e.collection)(f.db,"likes");var i=a.i(89769);function j({targetId:a,targetType:e,initialLikeCount:f,size:j="medium",storyAuthorId:k,storyTitle:l}){let{user:m}=(0,d.useAuth)(),[n,o]=(0,c.useState)(!1),[p,q]=(0,c.useState)(f),[r,s]=(0,c.useState)(!1),[t,u]=(0,c.useState)(!0),v=async()=>{if(!m||r)return;s(!0);let b=!n,c=b?p+1:p-1;o(b),q(c);try{let b="story"===e?await g(m.uid,a):await h(m.uid,a);if(o(b),b&&"story"===e&&k&&l&&k!==m.uid)try{await (0,i.createNotification)({userId:k,type:"like",actorId:m.uid,actorName:m.displayName||"KullanÄ±cÄ±",actorAvatar:m.photoURL||"ðŸ‘¤",storyId:a,storyTitle:l,message:"hikayenizi beÄŸendi"})}catch(a){console.error("Error creating notification:",a)}}catch(a){console.error("Error toggling like:",a),o(!b),q(p)}finally{s(!1)}};return t?null:(0,b.jsxs)("button",{className:`like-button ${{small:"like-button-small",medium:"like-button-medium",large:"like-button-large"}[j]} ${n?"liked":""} ${!m?"disabled":""}`,onClick:v,disabled:!m||r,title:m?n?"BeÄŸeniyi kaldÄ±r":"BeÄŸen":"BeÄŸenmek iÃ§in giriÅŸ yapÄ±n",children:[(0,b.jsx)("span",{className:"like-icon",children:n?"â¤ï¸":"ðŸ¤"}),(0,b.jsx)("span",{className:"like-count",children:p})]})}a.s(["default",()=>j],33396)},61134,a=>{"use strict";a.i(69387);var b=a.i(60574),c=a.i(79353),d=a.i(77929);let e=(0,b.collection)(c.db,"favorites");async function f(a,d){try{let e=`${a}_${d}`,f=(0,b.doc)(c.db,"favorites",e);if((await (0,b.getDoc)(f)).exists())return await (0,b.deleteDoc)(f),!1;return await (0,b.setDoc)(f,{userId:a,storyId:d,createdAt:b.Timestamp.now()}),!0}catch(a){throw console.error("Error toggling favorite:",a),a}}async function g(a,d){try{let e=`${a}_${d}`,f=(0,b.doc)(c.db,"favorites",e);return(await (0,b.getDoc)(f)).exists()}catch(a){return console.error("Error checking favorite:",a),!1}}async function h(a){try{let c=(0,b.query)(e,(0,b.where)("userId","==",a)),f=await (0,b.getDocs)(c),g=f.docs.map(a=>a.data().storyId);if(0===g.length)return[];let h=(await (0,d.getStories)()).filter(a=>g.includes(a.id)),i=new Map(f.docs.map(a=>[a.data().storyId,a.data().createdAt?.toDate()||new Date]));return h.sort((a,b)=>{let c=i.get(a.id)||new Date(0);return(i.get(b.id)||new Date(0)).getTime()-c.getTime()})}catch(a){return console.error("Error fetching user favorites:",a),[]}}a.s(["getUserFavorites",()=>h,"isFavorited",()=>g,"toggleFavorite",()=>f])},59299,a=>{"use strict";var b=a.i(87924),c=a.i(50944),d=a.i(33396),e=a.i(72131),f=a.i(11642),g=a.i(61134);function h({storyId:a,size:c="medium"}){let{user:d}=(0,f.useAuth)(),[h,i]=(0,e.useState)(!1),[j,k]=(0,e.useState)(!1),[l,m]=(0,e.useState)(!0);(0,e.useEffect)(()=>{d?async function(){if(d)try{let b=await (0,g.isFavorited)(d.uid,a);i(b)}catch(a){console.error("Error checking favorite status:",a)}finally{m(!1)}}():m(!1)},[d,a]);let n=async b=>{if(b.stopPropagation(),!d||j)return;k(!0);let c=!h;i(c);try{let b=await (0,g.toggleFavorite)(d.uid,a);i(b)}catch(a){console.error("Error toggling favorite:",a),i(!c)}finally{k(!1)}};return l?null:(0,b.jsx)("button",{className:`favorite-button ${{small:"favorite-button-small",medium:"favorite-button-medium",large:"favorite-button-large"}[c]} ${h?"favorited":""} ${!d?"disabled":""}`,onClick:n,disabled:!d||j,title:d?h?"Favorilerden Ã§Ä±kar":"Favorilere ekle":"Favori eklemek iÃ§in giriÅŸ yapÄ±n",children:(0,b.jsx)("span",{className:"favorite-icon",children:h?"â­":"â˜†"})})}var i=a.i(94525),j=a.i(2088);function k({story:a}){let e,f=(0,c.useRouter)(),g=(e=Math.max(1,Math.ceil(a.content.trim().split(/\s+/).filter(a=>a.length>0).length/200)))<=3?`âš¡ ${e} dk`:e<=10?`ðŸ“– ${e} dk`:`ðŸ“š ${e} dk`,k=a=>a>=1e3?`${(a/1e3).toFixed(1)}k`:a.toString();return(0,b.jsxs)("div",{className:"story-card",onClick:b=>{b.target.closest(".like-button")||b.target.closest("button")||f.push(`/story/${a.id}`)},children:[(0,b.jsxs)("div",{className:"story-card-header",children:[(0,b.jsx)("span",{className:"category-badge",children:a.category}),(0,b.jsxs)("div",{className:"header-actions",children:[(0,b.jsx)("span",{className:"reading-time-badge",children:g}),(0,b.jsx)(h,{storyId:a.id,size:"small"}),(0,b.jsx)(j.default,{storyId:a.id}),(0,b.jsx)(i.default,{targetId:a.id,targetType:"story",targetContent:a.title,className:"opacity-50 hover:opacity-100"}),(0,b.jsx)("span",{className:"story-date",children:a.createdAt.toLocaleDateString("tr-TR",{year:"numeric",month:"long",day:"numeric"})})]})]}),(0,b.jsx)("h3",{className:"story-title",children:a.title}),(0,b.jsx)("p",{className:"story-excerpt",children:a.excerpt}),(0,b.jsxs)("div",{className:"story-footer",children:[(0,b.jsxs)("div",{className:"author-info",children:[(0,b.jsx)("span",{className:"author-avatar",children:a.author.avatar}),(0,b.jsx)("span",{className:"author-name",children:a.author.name})]}),(0,b.jsxs)("div",{className:"story-stats",children:[(0,b.jsxs)("span",{className:"stat",children:[(0,b.jsx)("span",{className:"stat-icon",children:"ðŸ‘ï¸"}),k(a.stats.views)]}),(0,b.jsxs)("span",{className:"stat",children:[(0,b.jsx)("span",{className:"stat-icon",children:"ðŸ’¬"}),k(a.stats.comments)]}),(0,b.jsx)(d.default,{targetId:a.id,targetType:"story",initialLikeCount:a.stats.likes,size:"small",storyAuthorId:a.authorId,storyTitle:a.title})]})]})]})}a.s(["default",()=>k],59299)},24785,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(11642),e=a.i(59299),f=a.i(50944);function g({params:a}){let{user:g}=(0,d.useAuth)(),h=(0,f.useRouter)(),[i,j]=(0,c.useState)(null),[k,l]=(0,c.useState)(!0),[m,n]=(0,c.useState)("");(0,c.useEffect)(()=>{!async function(){n((await a).id)}()},[a]),(0,c.useEffect)(()=>{m&&o()},[m]);let o=async()=>{try{let a=await fetch(`/api/collections/${m}`),b=await a.json();b.collection&&j(b.collection)}catch(a){console.error("Error fetching collection:",a)}finally{l(!1)}},p=async()=>{if(confirm("Bu listeyi silmek istediÄŸinize emin misiniz?")&&g)try{let a=await g.getIdToken();(await fetch(`/api/collections/${m}`,{method:"DELETE",headers:{Authorization:`Bearer ${a}`}})).ok&&h.push("/collections")}catch(a){console.error("Error deleting collection:",a)}};if(k)return(0,b.jsx)("div",{className:"p-8 text-center",children:"YÃ¼kleniyor..."});if(!i)return(0,b.jsx)("div",{className:"p-8 text-center",children:"Liste bulunamadÄ± veya eriÅŸim izniniz yok."});let q=g?.uid===i.userId;return(0,b.jsxs)("div",{className:"collection-detail-page max-w-4xl mx-auto p-6",children:[(0,b.jsxs)("div",{className:"mb-8",children:[(0,b.jsxs)("div",{className:"flex justify-between items-start",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-gray-800 dark:text-white mb-2",children:i.name}),(0,b.jsx)("p",{className:"text-gray-600 dark:text-gray-300",children:i.description})]}),q&&(0,b.jsx)("button",{onClick:p,className:"text-red-500 hover:text-red-700 text-sm px-3 py-1 border border-red-200 rounded-lg hover:bg-red-50 transition-colors",children:"ðŸ—‘ï¸ Sil"})]}),(0,b.jsxs)("div",{className:"mt-4 flex gap-4 text-sm text-gray-500",children:[(0,b.jsxs)("span",{children:[i.stories?.length||0," Hikaye"]}),(0,b.jsx)("span",{children:"â€¢"}),(0,b.jsx)("span",{children:i.isPublic?"ðŸŒ Herkese AÃ§Ä±k":"ðŸ”’ Gizli"}),(0,b.jsx)("span",{children:"â€¢"}),(0,b.jsxs)("span",{children:["OluÅŸturulma: ",new Date(i.createdAt).toLocaleDateString("tr-TR")]})]})]}),(0,b.jsx)("div",{className:"stories-grid grid grid-cols-1 gap-6",children:i.stories&&i.stories.length>0?i.stories.map(a=>(0,b.jsx)(e.default,{story:a},a.id)):(0,b.jsx)("div",{className:"text-center py-12 bg-gray-50 dark:bg-gray-800/50 rounded-xl",children:(0,b.jsx)("p",{className:"text-gray-500",children:"Bu listede henÃ¼z hikaye yok."})})})]})}a.s(["default",()=>g])}];

//# sourceMappingURL=src_d1c1faa9._.js.map