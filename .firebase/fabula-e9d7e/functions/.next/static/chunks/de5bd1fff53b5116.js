(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,26633,e=>{"use strict";e.i(36180);var t=e.i(98925),r=e.i(53699);let a=(0,t.collection)(r.db,"stories"),s=(0,t.collection)(r.db,"comments");async function i(){console.warn("âš ï¸ getStories() is deprecated. Use getStoriesPaginated() for better performance.");try{let e=(0,t.query)(a,(0,t.orderBy)("createdAt","desc"));return(await (0,t.getDocs)(e)).docs.map(e=>{let t=e.data();return{id:e.id,...t,createdAt:t.createdAt?.toDate()||new Date}})}catch(e){return console.error("Error fetching stories:",e),[]}}async function o(e){try{let a=(0,t.doc)(r.db,"stories",e),s=await (0,t.getDoc)(a);if(!s.exists())return null;let i=s.data();return{id:s.id,...i,createdAt:i.createdAt?.toDate()||new Date}}catch(e){return console.error("Error fetching story:",e),null}}async function n(e){try{let r=(0,t.query)(s,(0,t.where)("storyId","==",e),(0,t.orderBy)("createdAt","desc")),a=(await (0,t.getDocs)(r)).docs.map(e=>{let t=e.data();return{id:e.id,...t,createdAt:t.createdAt?.toDate()||new Date}});return l(a)}catch(e){return console.error("Error fetching comments:",e),[]}}function l(e){let t=new Map,r=[];return e.forEach(e=>{t.set(e.id,{...e,replies:[]})}),e.forEach(e=>{let a=t.get(e.id);a&&r.push(a)}),r}async function c(e){try{return(await (0,t.addDoc)(s,{...e,createdAt:t.Timestamp.now()})).id}catch(e){throw console.error("Error adding comment:",e),e}}async function d(e){try{return(await (0,t.addDoc)(a,{...e,createdAt:t.Timestamp.now()})).id}catch(e){throw console.error("Error adding story:",e),e}}async function u(e){try{let a=(0,t.doc)(r.db,"stories",e);await (0,t.runTransaction)(r.db,async e=>{if(!(await e.get(a)).exists())throw Error("Story does not exist!");e.update(a,{"stats.views":(0,t.increment)(1)})})}catch(e){console.error("Error incrementing story views:",e)}}async function m(e,a){try{let s=(0,t.doc)(r.db,"stories",e);await (0,t.updateDoc)(s,{...a,updatedAt:t.Timestamp.now()})}catch(e){throw console.error("Error updating story:",e),e}}async function h(e){try{let a=(0,t.doc)(r.db,"stories",e);await (0,t.deleteDoc)(a)}catch(e){throw console.error("Error deleting story:",e),e}}function y(e,r){let s=r?(0,t.query)(a,(0,t.orderBy)("createdAt","desc"),(0,t.limit)(r)):(0,t.query)(a,(0,t.orderBy)("createdAt","desc"));return(0,t.onSnapshot)(s,t=>{e(t.docs.map(e=>{let t=e.data();return{id:e.id,...t,createdAt:t.createdAt?.toDate()||new Date}}))},e=>{console.error("Error in stories subscription:",e)})}function g(e,a){let s=(0,t.doc)(r.db,"stories",e);return(0,t.onSnapshot)(s,e=>{if(e.exists()){let t=e.data();a({id:e.id,...t,createdAt:t.createdAt?.toDate()||new Date})}else a(null)},e=>{console.error("Error in story subscription:",e)})}function x(e,r){let a=(0,t.query)(s,(0,t.where)("storyId","==",e),(0,t.orderBy)("createdAt","desc"));return(0,t.onSnapshot)(a,e=>{r(l(e.docs.map(e=>{let t=e.data();return{id:e.id,...t,createdAt:t.createdAt?.toDate()||new Date}})))},e=>{console.error("Error in comments subscription:",e)})}async function p(e=12,r){try{let s=(0,t.query)(a,(0,t.orderBy)("createdAt","desc"),(0,t.limit)(e));r&&(s=(0,t.query)(a,(0,t.orderBy)("createdAt","desc"),(0,t.startAfter)(r),(0,t.limit)(e)));let i=await (0,t.getDocs)(s),o=i.docs.map(e=>{let t=e.data();return{id:e.id,...t,createdAt:t.createdAt?.toDate()||new Date}}).filter(e=>"DELETED"!==e.status),n=i.docs[i.docs.length-1]||null;return{stories:o,lastDoc:n}}catch(e){return console.error("Error fetching paginated stories:",e),{stories:[],lastDoc:null}}}e.s(["addComment",()=>c,"addStory",()=>d,"deleteStory",()=>h,"getCommentsByStoryId",()=>n,"getStories",()=>i,"getStoriesPaginated",()=>p,"getStoryById",()=>o,"incrementStoryViews",()=>u,"subscribeToComments",()=>x,"subscribeToStories",()=>y,"subscribeToStory",()=>g,"updateStory",()=>m])},6062,74161,e=>{"use strict";var t=e.i(43476),r=e.i(932),a=e.i(71645),s=e.i(57951);function i({isOpen:e,onClose:r,targetId:i,targetType:o,targetContent:n}){let{user:l}=(0,s.useAuth)(),[c,d]=(0,a.useState)("spam"),[u,m]=(0,a.useState)(""),[h,y]=(0,a.useState)(!1),[g,x]=(0,a.useState)(!1);if(!e)return null;let p=async e=>{if(e.preventDefault(),l){y(!0);try{let e=await l.getIdToken();(await fetch("/api/report",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({targetId:i,targetType:o,targetContent:n,reason:c,description:u,idToken:e})})).ok?(x(!0),setTimeout(()=>{r(),x(!1),m(""),d("spam")},2e3)):alert("Rapor gÃ¶nderilirken bir hata oluÅŸtu.")}catch(e){console.error("Report error:",e),alert("Bir hata oluÅŸtu.")}finally{y(!1)}}};return(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:(0,t.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-xl w-full max-w-md overflow-hidden animate-scale-in",children:g?(0,t.jsxs)("div",{className:"p-8 text-center",children:[(0,t.jsx)("div",{className:"text-5xl mb-4",children:"âœ…"}),(0,t.jsx)("h3",{className:"text-xl font-bold text-gray-800 dark:text-white mb-2",children:"Rapor GÃ¶nderildi"}),(0,t.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"Bildiriminiz iÃ§in teÅŸekkÃ¼rler. Ä°ncelenecektir."})]}):(0,t.jsxs)("form",{onSubmit:p,className:"p-6",children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-gray-800 dark:text-white mb-4",children:"Ä°Ã§eriÄŸi Raporla"}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Sebep"}),(0,t.jsxs)("select",{value:c,onChange:e=>d(e.target.value),className:"w-full p-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[(0,t.jsx)("option",{value:"spam",children:"Spam / Reklam"}),(0,t.jsx)("option",{value:"harassment",children:"Taciz / ZorbalÄ±k"}),(0,t.jsx)("option",{value:"inappropriate",children:"Uygunsuz Ä°Ã§erik"}),(0,t.jsx)("option",{value:"other",children:"DiÄŸer"})]})]}),(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"AÃ§Ä±klama (Opsiyonel)"}),(0,t.jsx)("textarea",{value:u,onChange:e=>m(e.target.value),className:"w-full p-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white h-24 resize-none",placeholder:"Daha fazla detay..."})]}),(0,t.jsxs)("div",{className:"flex gap-3 justify-end",children:[(0,t.jsx)("button",{type:"button",onClick:r,className:"px-4 py-2 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:"Ä°ptal"}),(0,t.jsx)("button",{type:"submit",disabled:h,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50",children:h?"GÃ¶nderiliyor...":"Raporla"})]})]})})})}function o(e){let s,o,n,l,c,d=(0,r.c)(12),{targetId:u,targetType:m,targetContent:h,className:y}=e,[g,x]=(0,a.useState)(!1);d[0]===Symbol.for("react.memo_cache_sentinel")?(s=()=>x(!0),d[0]=s):s=d[0];let p=`text-gray-400 hover:text-red-500 transition-colors ${void 0===y?"":y}`;return d[1]!==p?(o=(0,t.jsx)("button",{onClick:s,className:p,title:"Raporla",children:"ðŸš©"}),d[1]=p,d[2]=o):o=d[2],d[3]===Symbol.for("react.memo_cache_sentinel")?(n=()=>x(!1),d[3]=n):n=d[3],d[4]!==g||d[5]!==h||d[6]!==u||d[7]!==m?(l=(0,t.jsx)(i,{isOpen:g,onClose:n,targetId:u,targetType:m,targetContent:h}),d[4]=g,d[5]=h,d[6]=u,d[7]=m,d[8]=l):l=d[8],d[9]!==o||d[10]!==l?(c=(0,t.jsxs)(t.Fragment,{children:[o,l]}),d[9]=o,d[10]=l,d[11]=c):c=d[11],c}function n({storyId:e,className:r=""}){let{user:i}=(0,s.useAuth)(),[o,n]=(0,a.useState)(!1),[l,c]=(0,a.useState)([]),[d,u]=(0,a.useState)(!1),[m,h]=(0,a.useState)(""),[y,g]=(0,a.useState)(!1),x=async()=>{if(i){u(!0);try{let e=await fetch(`/api/collections?userId=${i.uid}`),t=await e.json();t.collections&&c(t.collections)}catch(e){console.error("Error fetching collections:",e)}finally{u(!1)}}},p=async()=>{if(m.trim()&&i){g(!0);try{let e=await i.getIdToken();(await fetch("/api/collections",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:m,idToken:e})})).ok&&(h(""),x())}catch(e){console.error("Error creating collection:",e)}finally{g(!1)}}},f=async t=>{if(!i)return;let r=t.storyIds?.includes(e);try{let a=await i.getIdToken();(await fetch(`/api/collections/${t.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:r?"remove_story":"add_story",storyId:e,idToken:a})})).ok&&c(l.map(a=>{if(a.id===t.id){let t=r?a.storyIds.filter(t=>t!==e):[...a.storyIds||[],e];return{...a,storyIds:t}}return a}))}catch(e){console.error("Error updating collection:",e)}};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{onClick:()=>{i?(n(!0),x()):alert("LÃ¼tfen Ã¶nce giriÅŸ yapÄ±n.")},className:`text-gray-400 hover:text-indigo-500 transition-colors ${r}`,title:"Listeye Ekle",children:"ðŸ”–"}),o&&(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-xl w-full max-w-md overflow-hidden animate-scale-in",children:[(0,t.jsxs)("div",{className:"p-4 border-b border-gray-100 dark:border-gray-700 flex justify-between items-center",children:[(0,t.jsx)("h3",{className:"font-bold text-gray-800 dark:text-white",children:"Listeye Ekle"}),(0,t.jsx)("button",{onClick:()=>n(!1),className:"text-gray-500 hover:text-gray-700",children:"âœ•"})]}),(0,t.jsx)("div",{className:"p-4 max-h-64 overflow-y-auto",children:d?(0,t.jsx)("div",{className:"text-center py-4",children:"YÃ¼kleniyor..."}):0===l.length?(0,t.jsx)("div",{className:"text-center py-4 text-gray-500",children:"HenÃ¼z listeniz yok."}):(0,t.jsx)("div",{className:"space-y-2",children:l.map(r=>{let a=r.storyIds?.includes(e);return(0,t.jsxs)("button",{onClick:()=>f(r),className:`w-full flex items-center justify-between p-3 rounded-lg border transition-all ${a?"border-indigo-500 bg-indigo-50 dark:bg-indigo-900/20 text-indigo-700 dark:text-indigo-300":"border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:[(0,t.jsx)("span",{className:"font-medium",children:r.name}),a&&(0,t.jsx)("span",{children:"âœ“"})]},r.id)})})}),(0,t.jsx)("div",{className:"p-4 bg-gray-50 dark:bg-gray-700/50 border-t border-gray-100 dark:border-gray-700",children:(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("input",{type:"text",value:m,onChange:e=>h(e.target.value),placeholder:"Yeni liste adÄ±...",className:"flex-1 p-2 rounded border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-sm"}),(0,t.jsx)("button",{onClick:p,disabled:y||!m.trim(),className:"px-3 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700 disabled:opacity-50 text-sm font-medium",children:y?"...":"OluÅŸtur"})]})})]})})]})}e.s(["default",()=>o],6062),e.s(["default",()=>n],74161)},67277,e=>{"use strict";var t=e.i(43476),r=e.i(71645),a=e.i(57951);e.i(36180);var s=e.i(98925),i=e.i(53699);async function o(e,t){try{let r=`${e}_story_${t}`,a=(0,s.doc)(i.db,"likes",r),o=(0,s.doc)(i.db,"stories",t);return await (0,s.runTransaction)(i.db,async r=>{let i=await r.get(a);if(!(await r.get(o)).exists())throw Error("Story does not exist!");return i.exists()?(r.delete(a),r.update(o,{"stats.likes":(0,s.increment)(-1)}),!1):(r.set(a,{userId:e,targetId:t,targetType:"story",createdAt:s.Timestamp.now()}),r.update(o,{"stats.likes":(0,s.increment)(1)}),!0)})}catch(e){throw console.error("Error toggling story like:",e),e}}async function n(e,t){try{let r=`${e}_comment_${t}`,a=(0,s.doc)(i.db,"likes",r),o=(0,s.doc)(i.db,"comments",t);return await (0,s.runTransaction)(i.db,async r=>{let i=await r.get(a);if(!(await r.get(o)).exists())throw Error("Comment does not exist!");return i.exists()?(r.delete(a),r.update(o,{likes:(0,s.increment)(-1)}),!1):(r.set(a,{userId:e,targetId:t,targetType:"comment",createdAt:s.Timestamp.now()}),r.update(o,{likes:(0,s.increment)(1)}),!0)})}catch(e){throw console.error("Error toggling comment like:",e),e}}(0,s.collection)(i.db,"likes");var l=e.i(25661);function c({targetId:e,targetType:s,initialLikeCount:i,size:c="medium",storyAuthorId:d,storyTitle:u}){let{user:m}=(0,a.useAuth)(),[h,y]=(0,r.useState)(!1),[g,x]=(0,r.useState)(i),[p,f]=(0,r.useState)(!1),[b,w]=(0,r.useState)(!0),j=async()=>{if(!m||p)return;f(!0);let t=!h,r=t?g+1:g-1;y(t),x(r);try{let t="story"===s?await o(m.uid,e):await n(m.uid,e);if(y(t),t&&"story"===s&&d&&u&&d!==m.uid)try{await (0,l.createNotification)({userId:d,type:"like",actorId:m.uid,actorName:m.displayName||"KullanÄ±cÄ±",actorAvatar:m.photoURL||"ðŸ‘¤",storyId:e,storyTitle:u,message:"hikayenizi beÄŸendi"})}catch(e){console.error("Error creating notification:",e)}}catch(e){console.error("Error toggling like:",e),y(!t),x(g)}finally{f(!1)}};return b?null:(0,t.jsxs)("button",{className:`like-button ${{small:"like-button-small",medium:"like-button-medium",large:"like-button-large"}[c]} ${h?"liked":""} ${!m?"disabled":""}`,onClick:j,disabled:!m||p,title:m?h?"BeÄŸeniyi kaldÄ±r":"BeÄŸen":"BeÄŸenmek iÃ§in giriÅŸ yapÄ±n",children:[(0,t.jsx)("span",{className:"like-icon",children:h?"â¤ï¸":"ðŸ¤"}),(0,t.jsx)("span",{className:"like-count",children:g})]})}e.s(["default",()=>c],67277)},30211,e=>{"use strict";e.i(36180);var t=e.i(98925),r=e.i(53699),a=e.i(26633);let s=(0,t.collection)(r.db,"favorites");async function i(e,a){try{let s=`${e}_${a}`,i=(0,t.doc)(r.db,"favorites",s);if((await (0,t.getDoc)(i)).exists())return await (0,t.deleteDoc)(i),!1;return await (0,t.setDoc)(i,{userId:e,storyId:a,createdAt:t.Timestamp.now()}),!0}catch(e){throw console.error("Error toggling favorite:",e),e}}async function o(e,a){try{let s=`${e}_${a}`,i=(0,t.doc)(r.db,"favorites",s);return(await (0,t.getDoc)(i)).exists()}catch(e){return console.error("Error checking favorite:",e),!1}}async function n(e){try{let r=(0,t.query)(s,(0,t.where)("userId","==",e)),i=await (0,t.getDocs)(r),o=i.docs.map(e=>e.data().storyId);if(0===o.length)return[];let n=(await (0,a.getStories)()).filter(e=>o.includes(e.id)),l=new Map(i.docs.map(e=>[e.data().storyId,e.data().createdAt?.toDate()||new Date]));return n.sort((e,t)=>{let r=l.get(e.id)||new Date(0);return(l.get(t.id)||new Date(0)).getTime()-r.getTime()})}catch(e){return console.error("Error fetching user favorites:",e),[]}}e.s(["getUserFavorites",()=>n,"isFavorited",()=>o,"toggleFavorite",()=>i])},97263,e=>{"use strict";var t=e.i(43476),r=e.i(932),a=e.i(18566),s=e.i(67277),i=e.i(71645),o=e.i(57951),n=e.i(30211);function l({storyId:e,size:r="medium"}){let{user:a}=(0,o.useAuth)(),[s,l]=(0,i.useState)(!1),[c,d]=(0,i.useState)(!1),[u,m]=(0,i.useState)(!0);(0,i.useEffect)(()=>{a?async function(){if(a)try{let t=await (0,n.isFavorited)(a.uid,e);l(t)}catch(e){console.error("Error checking favorite status:",e)}finally{m(!1)}}():m(!1)},[a,e]);let h=async t=>{if(t.stopPropagation(),!a||c)return;d(!0);let r=!s;l(r);try{let t=await (0,n.toggleFavorite)(a.uid,e);l(t)}catch(e){console.error("Error toggling favorite:",e),l(!r)}finally{d(!1)}};return u?null:(0,t.jsx)("button",{className:`favorite-button ${{small:"favorite-button-small",medium:"favorite-button-medium",large:"favorite-button-large"}[r]} ${s?"favorited":""} ${!a?"disabled":""}`,onClick:h,disabled:!a||c,title:a?s?"Favorilerden Ã§Ä±kar":"Favorilere ekle":"Favori eklemek iÃ§in giriÅŸ yapÄ±n",children:(0,t.jsx)("span",{className:"favorite-icon",children:s?"â­":"â˜†"})})}var c=e.i(6062),d=e.i(74161);function u(e){let i,o,n,u,h,y,g,x,p,f,b,w,j,v,N,k,S,T,E,A,D,C,I,$,B,z,P=(0,r.c)(67),{story:_}=e,R=(0,a.useRouter)();if(P[0]!==_.content){let e;i=(e=Math.max(1,Math.ceil(_.content.trim().split(/\s+/).filter(e=>e.length>0).length/200)))<=3?`âš¡ ${e} dk`:e<=10?`ðŸ“– ${e} dk`:`ðŸ“š ${e} dk`,P[0]=_.content,P[1]=i}else i=P[1];let L=i,q=m;P[2]!==R||P[3]!==_.id?(o=e=>{e.target.closest(".like-button")||e.target.closest("button")||R.push(`/story/${_.id}`)},P[2]=R,P[3]=_.id,P[4]=o):o=P[4];let F=o;return P[5]!==_.category?(n=(0,t.jsx)("span",{className:"category-badge",children:_.category}),P[5]=_.category,P[6]=n):n=P[6],P[7]!==L?(u=(0,t.jsx)("span",{className:"reading-time-badge",children:L}),P[7]=L,P[8]=u):u=P[8],P[9]!==_.id?(h=(0,t.jsx)(l,{storyId:_.id,size:"small"}),y=(0,t.jsx)(d.default,{storyId:_.id}),P[9]=_.id,P[10]=h,P[11]=y):(h=P[10],y=P[11]),P[12]!==_.id||P[13]!==_.title?(g=(0,t.jsx)(c.default,{targetId:_.id,targetType:"story",targetContent:_.title,className:"opacity-50 hover:opacity-100"}),P[12]=_.id,P[13]=_.title,P[14]=g):g=P[14],P[15]!==_.createdAt?(x=function(e){return e.toLocaleDateString("tr-TR",{year:"numeric",month:"long",day:"numeric"})}(_.createdAt),P[15]=_.createdAt,P[16]=x):x=P[16],P[17]!==x?(p=(0,t.jsx)("span",{className:"story-date",children:x}),P[17]=x,P[18]=p):p=P[18],P[19]!==u||P[20]!==h||P[21]!==y||P[22]!==g||P[23]!==p?(f=(0,t.jsxs)("div",{className:"header-actions",children:[u,h,y,g,p]}),P[19]=u,P[20]=h,P[21]=y,P[22]=g,P[23]=p,P[24]=f):f=P[24],P[25]!==f||P[26]!==n?(b=(0,t.jsxs)("div",{className:"story-card-header",children:[n,f]}),P[25]=f,P[26]=n,P[27]=b):b=P[27],P[28]!==_.title?(w=(0,t.jsx)("h3",{className:"story-title",children:_.title}),P[28]=_.title,P[29]=w):w=P[29],P[30]!==_.excerpt?(j=(0,t.jsx)("p",{className:"story-excerpt",children:_.excerpt}),P[30]=_.excerpt,P[31]=j):j=P[31],P[32]!==_.author.avatar?(v=(0,t.jsx)("span",{className:"author-avatar",children:_.author.avatar}),P[32]=_.author.avatar,P[33]=v):v=P[33],P[34]!==_.author.name?(N=(0,t.jsx)("span",{className:"author-name",children:_.author.name}),P[34]=_.author.name,P[35]=N):N=P[35],P[36]!==v||P[37]!==N?(k=(0,t.jsxs)("div",{className:"author-info",children:[v,N]}),P[36]=v,P[37]=N,P[38]=k):k=P[38],P[39]===Symbol.for("react.memo_cache_sentinel")?(S=(0,t.jsx)("span",{className:"stat-icon",children:"ðŸ‘ï¸"}),P[39]=S):S=P[39],P[40]!==_.stats.views?(T=q(_.stats.views),P[40]=_.stats.views,P[41]=T):T=P[41],P[42]!==T?(E=(0,t.jsxs)("span",{className:"stat",children:[S,T]}),P[42]=T,P[43]=E):E=P[43],P[44]===Symbol.for("react.memo_cache_sentinel")?(A=(0,t.jsx)("span",{className:"stat-icon",children:"ðŸ’¬"}),P[44]=A):A=P[44],P[45]!==_.stats.comments?(D=q(_.stats.comments),P[45]=_.stats.comments,P[46]=D):D=P[46],P[47]!==D?(C=(0,t.jsxs)("span",{className:"stat",children:[A,D]}),P[47]=D,P[48]=C):C=P[48],P[49]!==_.authorId||P[50]!==_.id||P[51]!==_.stats.likes||P[52]!==_.title?(I=(0,t.jsx)(s.default,{targetId:_.id,targetType:"story",initialLikeCount:_.stats.likes,size:"small",storyAuthorId:_.authorId,storyTitle:_.title}),P[49]=_.authorId,P[50]=_.id,P[51]=_.stats.likes,P[52]=_.title,P[53]=I):I=P[53],P[54]!==E||P[55]!==C||P[56]!==I?($=(0,t.jsxs)("div",{className:"story-stats",children:[E,C,I]}),P[54]=E,P[55]=C,P[56]=I,P[57]=$):$=P[57],P[58]!==k||P[59]!==$?(B=(0,t.jsxs)("div",{className:"story-footer",children:[k,$]}),P[58]=k,P[59]=$,P[60]=B):B=P[60],P[61]!==F||P[62]!==b||P[63]!==w||P[64]!==j||P[65]!==B?(z=(0,t.jsxs)("div",{className:"story-card",onClick:F,children:[b,w,j,B]}),P[61]=F,P[62]=b,P[63]=w,P[64]=j,P[65]=B,P[66]=z):z=P[66],z}function m(e){return e>=1e3?`${(e/1e3).toFixed(1)}k`:e.toString()}e.s(["default",()=>u],97263)},88659,e=>{"use strict";var t=e.i(43476),r=e.i(71645),a=e.i(57951),s=e.i(10272);e.i(36180);var i=e.i(98925),o=e.i(53699);async function n(e){try{let t=(0,i.collection)(o.db,"stories"),r=(0,i.query)(t,(0,i.where)("authorId","==",e),(0,i.orderBy)("createdAt","desc"));return(await (0,i.getDocs)(r)).docs.map(e=>{let t=e.data();return{id:e.id,...t,createdAt:t.createdAt?.toDate()||new Date}})}catch(e){return console.error("Error fetching user stories:",e),[]}}async function l(e){try{let t=(0,i.collection)(o.db,"comments"),r=(0,i.query)(t,(0,i.where)("author.id","==",e),(0,i.orderBy)("createdAt","desc"));return(await (0,i.getDocs)(r)).docs.map(e=>{let t=e.data();return{id:e.id,...t,createdAt:t.createdAt?.toDate()||new Date}})}catch(e){return console.error("Error fetching user comments:",e),[]}}async function c(e){try{let[t,r]=await Promise.all([n(e),l(e)]),a=t.reduce((e,t)=>e+(t.stats?.views||0),0),s=t.reduce((e,t)=>e+(t.stats?.likes||0),0);return{storiesCount:t.length,commentsCount:r.length,totalViews:a,totalLikes:s}}catch(e){return console.error("Error fetching user stats:",e),{storiesCount:0,commentsCount:0,totalViews:0,totalLikes:0}}}var d=e.i(66741),u=e.i(97263);let m=(0,i.collection)(o.db,"follows"),h=(0,i.collection)(o.db,"users");async function y(e,t){try{if(e===t)return{success:!1,error:"Kendinizi takip edemezsiniz"};if(await x(e,t))return{success:!1,error:"Zaten takip ediyorsunuz"};let r=(0,i.writeBatch)(o.db),a=(0,i.doc)(m);r.set(a,{followerId:e,followingId:t,createdAt:(0,i.serverTimestamp)()});let s=(0,i.doc)(h,e);r.update(s,{followingCount:(0,i.increment)(1)});let n=(0,i.doc)(h,t);return r.update(n,{followerCount:(0,i.increment)(1)}),await r.commit(),{success:!0}}catch(e){return console.error("Error following user:",e),{success:!1,error:"Takip edilemedi"}}}async function g(e,t){try{let r=(0,i.query)(m,(0,i.where)("followerId","==",e),(0,i.where)("followingId","==",t)),a=await (0,i.getDocs)(r);if(a.empty)return{success:!1,error:"Takip kaydÄ± bulunamadÄ±"};let s=(0,i.writeBatch)(o.db);a.docs.forEach(e=>{s.delete(e.ref)});let n=(0,i.doc)(h,e);s.update(n,{followingCount:(0,i.increment)(-1)});let l=(0,i.doc)(h,t);return s.update(l,{followerCount:(0,i.increment)(-1)}),await s.commit(),{success:!0}}catch(e){return console.error("Error unfollowing user:",e),{success:!1,error:"Takipten Ã§Ä±kÄ±lamadÄ±"}}}async function x(e,t){try{let r=(0,i.query)(m,(0,i.where)("followerId","==",e),(0,i.where)("followingId","==",t));return!(await (0,i.getDocs)(r)).empty}catch(e){return console.error("Error checking follow status:",e),!1}}var p=e.i(25661);function f({userId:e,userName:s,userAvatar:i,size:o="medium"}){let{user:n}=(0,a.useAuth)(),[l,c]=(0,r.useState)(!1),[d,u]=(0,r.useState)(!1),[m,h]=(0,r.useState)(!0);(0,r.useEffect)(()=>{n?async function(){if(n)try{let t=await x(n.uid,e);c(t)}catch(e){console.error("Error checking follow status:",e)}finally{h(!1)}}():h(!1)},[n,e]);let f=async t=>{if(t.stopPropagation(),!n||d)return;u(!0);let r=!l;c(r);try{r?(await y(n.uid,e)).success?await (0,p.createFollowNotification)(e,n.uid,n.displayName||"Anonim",n.photoURL||""):c(!1):(await g(n.uid,e)).success||c(!0)}catch(e){console.error("Error toggling follow:",e),c(!r)}finally{u(!1)}};return n?.uid===e||m?null:(0,t.jsx)("button",{className:`follow-button ${{small:"follow-button-small",medium:"follow-button-medium",large:"follow-button-large"}[o]} ${l?"following":""} ${!n?"disabled":""}`,onClick:f,disabled:!n||d,title:n?l?"Takibi BÄ±rak":"Takip Et":"Takip etmek iÃ§in giriÅŸ yapÄ±n",children:d?(0,t.jsx)("span",{className:"spinner-small"}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:"follow-icon",children:l?"âœ“":"+"}),(0,t.jsx)("span",{className:"follow-text",children:l?"Takip Ediliyor":"Takip Et"})]})})}function b({params:e}){let{user:i}=(0,a.useAuth)(),[o,l]=(0,r.useState)(""),[m,h]=(0,r.useState)(null),[y,g]=(0,r.useState)([]),[x,p]=(0,r.useState)({storiesCount:0,commentsCount:0,totalViews:0,totalLikes:0}),[b,w]=(0,r.useState)(!0);if((0,r.useEffect)(()=>{!async function(){l((await e).uid)}()},[e]),(0,r.useEffect)(()=>{o&&e();async function e(){try{let[e,t,r]=await Promise.all([(0,s.getUserProfile)(o),n(o),c(o)]);h(e),g(t),p(r)}catch(e){console.error("Error loading profile:",e)}finally{w(!1)}}},[o]),b)return(0,t.jsx)("div",{className:"profile-page",children:(0,t.jsx)("div",{className:"profile-container",children:(0,t.jsxs)("div",{className:"loading-state",children:[(0,t.jsx)("div",{className:"spinner"}),(0,t.jsx)("p",{children:"Profil yÃ¼kleniyor..."})]})})});if(!m)return(0,t.jsx)("div",{className:"profile-page",children:(0,t.jsx)("div",{className:"profile-container",children:(0,t.jsxs)("div",{className:"empty-state",children:[(0,t.jsx)("span",{className:"empty-icon",children:"âŒ"}),(0,t.jsx)("h2",{children:"KullanÄ±cÄ± BulunamadÄ±"})]})})});let j=m.xp||0,v=(0,d.getUserBadge)(j),N=(0,d.getXPToNextBadge)(j),k=i?.uid===o;return(0,t.jsx)("div",{className:"profile-page",children:(0,t.jsxs)("div",{className:"profile-container",children:[(0,t.jsxs)("div",{className:"profile-header",children:[(0,t.jsx)("div",{className:"profile-avatar",children:m.photoURL?(0,t.jsx)("img",{src:m.photoURL,alt:m.displayName}):(0,t.jsx)("span",{className:"avatar-placeholder",children:"ðŸ‘¤"})}),(0,t.jsxs)("div",{className:"profile-info",children:[(0,t.jsxs)("div",{className:"profile-name-row",children:[(0,t.jsx)("h1",{className:"profile-name",children:m.displayName}),!k&&(0,t.jsx)(f,{userId:o,userName:m.displayName,userAvatar:m.photoURL||"",size:"medium"})]}),v&&(0,t.jsxs)("div",{className:"profile-badge",children:[(0,t.jsx)("span",{className:"badge-emoji",children:v.emoji}),(0,t.jsx)("span",{className:"badge-name",children:v.name})]}),(0,t.jsxs)("div",{className:"profile-follow-stats",children:[(0,t.jsxs)("span",{className:"follow-stat",children:[(0,t.jsx)("strong",{children:m.followerCount||0})," TakipÃ§i"]}),(0,t.jsxs)("span",{className:"follow-stat",children:[(0,t.jsx)("strong",{children:m.followingCount||0})," Takip"]})]})]})]}),(0,t.jsxs)("div",{className:"xp-progress-section mb-8 p-6 bg-white dark:bg-gray-800 rounded-xl shadow-sm",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Mevcut Seviye"}),(0,t.jsx)("h3",{className:"text-xl font-bold text-indigo-600 dark:text-indigo-400",children:v.name})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Toplam XP"}),(0,t.jsxs)("h3",{className:"text-xl font-bold",children:[j," XP"]})]})]}),(0,t.jsx)("div",{className:"relative w-full h-4 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:(0,t.jsx)("div",{className:"absolute top-0 left-0 h-full bg-gradient-to-r from-indigo-500 to-purple-600 transition-all duration-1000 ease-out",style:{width:`${N.progress}%`}})}),N.nextBadge?(0,t.jsxs)("p",{className:"text-sm text-center mt-2 text-gray-500",children:["Sonraki seviye ",(0,t.jsx)("strong",{children:N.nextBadge.name})," iÃ§in",(0,t.jsxs)("span",{className:"font-bold text-indigo-500",children:[" ",N.remainingXP," XP"]})," daha kazanmalÄ±sÄ±n."]}):(0,t.jsx)("p",{className:"text-sm text-center mt-2 text-yellow-500 font-bold",children:"ðŸ† Zirvedesin! Efsanevi bir yazarsÄ±n."})]}),(0,t.jsxs)("div",{className:"profile-stats",children:[(0,t.jsxs)("div",{className:"stat-card",children:[(0,t.jsx)("span",{className:"stat-icon",children:"ðŸ“š"}),(0,t.jsx)("span",{className:"stat-value",children:x.storiesCount}),(0,t.jsx)("span",{className:"stat-label",children:"Hikaye"})]}),(0,t.jsxs)("div",{className:"stat-card",children:[(0,t.jsx)("span",{className:"stat-icon",children:"ðŸ’¬"}),(0,t.jsx)("span",{className:"stat-value",children:x.commentsCount}),(0,t.jsx)("span",{className:"stat-label",children:"Yorum"})]}),(0,t.jsxs)("div",{className:"stat-card",children:[(0,t.jsx)("span",{className:"stat-icon",children:"ðŸ‘ï¸"}),(0,t.jsx)("span",{className:"stat-value",children:x.totalViews}),(0,t.jsx)("span",{className:"stat-label",children:"GÃ¶rÃ¼ntÃ¼lenme"})]}),(0,t.jsxs)("div",{className:"stat-card",children:[(0,t.jsx)("span",{className:"stat-icon",children:"â¤ï¸"}),(0,t.jsx)("span",{className:"stat-value",children:x.totalLikes}),(0,t.jsx)("span",{className:"stat-label",children:"BeÄŸeni"})]})]}),(0,t.jsxs)("div",{className:"badge-showcase",children:[(0,t.jsx)("h2",{className:"section-title",children:"ðŸ† Rozet Koleksiyonu"}),(0,t.jsx)("div",{className:"badges-grid",children:d.badges.map(e=>{let r=j>=e.requiredXP;return(0,t.jsxs)("div",{className:`badge-item ${r?"unlocked":"locked"}`,title:`${e.name} - ${e.description}`,children:[(0,t.jsx)("span",{className:"badge-emoji",children:e.emoji}),(0,t.jsx)("span",{className:"badge-name",children:e.name}),!r&&(0,t.jsx)("span",{className:"badge-lock",children:"ðŸ”’"})]},e.id)})})]}),(0,t.jsxs)("div",{className:"user-stories-section",children:[(0,t.jsxs)("h2",{className:"section-title",children:["ðŸ“š ",k?"Hikayelerim":"Hikayeleri"]}),0===y.length?(0,t.jsxs)("div",{className:"empty-state",children:[(0,t.jsx)("span",{className:"empty-icon",children:"ðŸ“"}),(0,t.jsx)("p",{children:"HenÃ¼z hikaye yazÄ±lmamÄ±ÅŸ."})]}):(0,t.jsx)("div",{className:"stories-grid",children:y.map(e=>(0,t.jsx)(u.default,{story:e},e.id))})]})]})})}e.s(["default",()=>b],88659)},43987,e=>{e.v(e=>Promise.resolve().then(()=>e(26633)))}]);