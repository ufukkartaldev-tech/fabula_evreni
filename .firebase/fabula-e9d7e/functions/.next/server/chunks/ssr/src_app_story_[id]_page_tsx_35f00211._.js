module.exports=[48241,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(38246),f=a.i(77929),g=a.i(11642),h=a.i(89769),i=a.i(94525);function j({comment:a,depth:c=0}){var d;let e,f,g=c>0?`${2*c}rem`:"0";return(0,b.jsxs)("div",{style:{marginLeft:g},className:"comment-card-wrapper",children:[(0,b.jsxs)("div",{className:"comment-card",children:[(0,b.jsxs)("div",{className:"comment-header",children:[(0,b.jsxs)("div",{className:"comment-author",children:[(0,b.jsx)("span",{className:"author-avatar",children:a.author.avatar}),(0,b.jsxs)("div",{className:"author-info",children:[(0,b.jsx)("span",{className:"author-name",children:a.author.name}),(0,b.jsx)("span",{className:"comment-date",children:(d=a.createdAt,f=Math.floor((e=Math.floor((new Date().getTime()-d.getTime())/36e5))/24),e<1?"Az Ã¶nce":e<24?`${e} saat \xf6nce`:f<7?`${f} g\xfcn \xf6nce`:d.toLocaleDateString("tr-TR",{year:"numeric",month:"long",day:"numeric"}))})]})]}),(0,b.jsx)(i.default,{targetId:a.id,targetType:"comment",targetContent:a.content,className:"text-xs opacity-50 hover:opacity-100"})]}),(0,b.jsx)("p",{className:"comment-content",children:a.content}),(0,b.jsxs)("button",{className:"reply-button",children:[(0,b.jsx)("span",{children:"ðŸ’¬"}),"YanÄ±tla"]})]}),a.replies&&a.replies.length>0&&(0,b.jsx)("div",{className:"comment-replies",children:a.replies.map(a=>(0,b.jsx)(j,{comment:a,depth:c+1},a.id))})]})}function k({onSubmit:a,placeholder:d="Yorumunuzu yazÄ±n...",disabled:e=!1}){let[f,g]=(0,c.useState)(""),h=500-f.length,i=h<50;return(0,b.jsxs)("form",{onSubmit:b=>{b.preventDefault(),f.trim()&&f.length<=500&&(a(f.trim()),g(""))},className:"comment-form",children:[(0,b.jsx)("div",{className:"form-header",children:(0,b.jsx)("h3",{children:"ðŸ’¬ Yorum Yap"})}),(0,b.jsx)("textarea",{value:f,onChange:a=>g(a.target.value),placeholder:d,maxLength:500,rows:4,className:"comment-textarea",disabled:e}),(0,b.jsxs)("div",{className:"form-footer",children:[(0,b.jsxs)("span",{className:`char-counter ${i?"warning":""}`,children:[h," karakter kaldÄ±"]}),(0,b.jsxs)("button",{type:"submit",disabled:!f.trim()||f.length>500||e,className:"submit-button",children:[(0,b.jsx)("span",{children:"ðŸ“¤"}),e?"GÃ¶nderiliyor...":"GÃ¶nder"]})]})]})}function l({storyId:a,storyAuthorId:d,storyTitle:e,initialComments:i}){let{user:l}=(0,g.useAuth)(),[m,n]=(0,c.useState)(i),[o,p]=(0,c.useState)(!1),[q,r]=(0,c.useState)(!1),s=async b=>{if(!l)return void r(!0);p(!0);try{let c={storyId:a,author:{name:l.displayName||"KullanÄ±cÄ±",avatar:l.photoURL||"ðŸ‘¤"},content:b,replies:[]},g=await (0,f.addComment)(c),i=await (0,f.getCommentsByStoryId)(a);if(n(i),d&&d!==l.uid)try{await (0,h.createNotification)({userId:d,type:"comment",actorId:l.uid,actorName:l.displayName||"KullanÄ±cÄ±",actorAvatar:l.photoURL||"ðŸ‘¤",storyId:a,storyTitle:e,commentId:g,message:"hikayenize yorum yaptÄ±"})}catch(a){console.error("Error creating notification:",a)}}catch(a){console.error("Error adding comment:",a),alert("Yorum eklenirken bir hata oluÅŸtu. LÃ¼tfen tekrar deneyin.")}finally{p(!1)}};return(0,b.jsxs)("div",{className:"comment-section",children:[(0,b.jsxs)("div",{className:"section-header",children:[(0,b.jsx)("h2",{children:"ðŸ’¬ Yorumlar"}),(0,b.jsxs)("span",{className:"comment-count",children:[m.length," yorum"]})]}),!l&&q?(0,b.jsxs)("div",{className:"login-prompt",children:[(0,b.jsx)("span",{className:"prompt-icon",children:"ðŸ”"}),(0,b.jsx)("p",{children:"Yorum yapmak iÃ§in giriÅŸ yapmalÄ±sÄ±nÄ±z."}),(0,b.jsx)("p",{className:"prompt-hint",children:'SaÄŸ Ã¼st kÃ¶ÅŸedeki "GiriÅŸ Yap" butonunu kullanÄ±n.'})]}):(0,b.jsx)(k,{onSubmit:s,disabled:o}),(0,b.jsx)("div",{className:"comments-list",children:0===m.length?(0,b.jsxs)("div",{className:"empty-state",children:[(0,b.jsx)("span",{className:"empty-icon",children:"ðŸ’­"}),(0,b.jsx)("p",{children:"HenÃ¼z yorum yapÄ±lmamÄ±ÅŸ. Ä°lk yorumu siz yapÄ±n!"})]}):m.map(a=>(0,b.jsx)(j,{comment:a},a.id))})]})}function m(){return"undefined"!=typeof navigator&&"share"in navigator}async function n(a){if(!m())return!1;try{return await navigator.share(a),!0}catch(a){return console.log("Share cancelled or failed:",a),!1}}async function o(a){if("undefined"==typeof navigator)return!1;try{if(navigator.clipboard&&navigator.clipboard.writeText)return await navigator.clipboard.writeText(a),!0;let b=document.createElement("textarea");b.value=a,b.style.position="fixed",b.style.left="-999999px",b.style.top="-999999px",document.body.appendChild(b),b.focus(),b.select();let c=document.execCommand("copy");return document.body.removeChild(b),c}catch(a){return console.error("Failed to copy to clipboard:",a),!1}}function p({storyId:a,storyTitle:d,onClose:e}){let[f,g]=(0,c.useState)(!1),[h,i]=(0,c.useState)(!1);(0,c.useEffect)(()=>{i(m())},[]);let j={title:d,text:`"${d}" hikayesini okuyun - Fabula`,url:`${window.location.origin}/story/${a}`},k=async()=>{await n(j)&&e()},l=async()=>{await o(j.url)&&(g(!0),setTimeout(()=>{g(!1)},2e3))},p=a=>{window.open(a,"_blank","width=600,height=400")};return(0,b.jsx)("div",{className:"modal-backdrop",onClick:a=>{a.target===a.currentTarget&&e()},children:(0,b.jsxs)("div",{className:"share-modal",children:[(0,b.jsxs)("div",{className:"modal-header",children:[(0,b.jsx)("h3",{children:"Hikayeyi PaylaÅŸ"}),(0,b.jsx)("button",{className:"close-button",onClick:e,children:"âœ•"})]}),(0,b.jsxs)("div",{className:"modal-content",children:[(0,b.jsx)("p",{className:"share-title",children:d}),h&&(0,b.jsxs)("button",{className:"web-share-button",onClick:k,children:[(0,b.jsx)("span",{className:"button-icon",children:"ðŸ“±"}),"PaylaÅŸ"]}),(0,b.jsxs)("div",{className:"social-buttons",children:[(0,b.jsxs)("button",{className:"social-button twitter",onClick:()=>{let a;return p((a=new URLSearchParams({text:j.text,url:j.url}),`https://twitter.com/intent/tweet?${a.toString()}`))},title:"Twitter'da paylaÅŸ",children:[(0,b.jsx)("span",{className:"social-icon",children:"ð•"}),(0,b.jsx)("span",{className:"social-name",children:"Twitter"})]}),(0,b.jsxs)("button",{className:"social-button facebook",onClick:()=>{let a;return p((a=new URLSearchParams({u:j.url}),`https://www.facebook.com/sharer/sharer.php?${a.toString()}`))},title:"Facebook'ta paylaÅŸ",children:[(0,b.jsx)("span",{className:"social-icon",children:"f"}),(0,b.jsx)("span",{className:"social-name",children:"Facebook"})]}),(0,b.jsxs)("button",{className:"social-button whatsapp",onClick:()=>{var a,b;let c;return p((a=j.text,b=j.url,c=new URLSearchParams({text:`${a} ${b}`}),`https://wa.me/?${c.toString()}`))},title:"WhatsApp'ta paylaÅŸ",children:[(0,b.jsx)("span",{className:"social-icon",children:"ðŸ“±"}),(0,b.jsx)("span",{className:"social-name",children:"WhatsApp"})]}),(0,b.jsxs)("button",{className:"social-button linkedin",onClick:()=>{let a;return p((a=new URLSearchParams({url:j.url}),`https://www.linkedin.com/sharing/share-offsite/?${a.toString()}`))},title:"LinkedIn'de paylaÅŸ",children:[(0,b.jsx)("span",{className:"social-icon",children:"in"}),(0,b.jsx)("span",{className:"social-name",children:"LinkedIn"})]})]}),(0,b.jsxs)("div",{className:"copy-link-section",children:[(0,b.jsx)("input",{type:"text",value:j.url,readOnly:!0,className:"link-input"}),(0,b.jsx)("button",{className:`copy-button ${f?"copied":""}`,onClick:l,children:f?"âœ“ KopyalandÄ±":"ðŸ“‹ Kopyala"})]})]})]})})}function q({storyId:a,storyTitle:d,size:e="medium"}){let[f,g]=(0,c.useState)(!1);return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("button",{className:`share-button ${{small:"share-button-small",medium:"share-button-medium",large:"share-button-large"}[e]}`,onClick:()=>g(!0),title:"Hikayeyi paylaÅŸ",children:[(0,b.jsx)("span",{className:"share-icon",children:"ðŸ“¤"}),(0,b.jsx)("span",{className:"share-text",children:"PaylaÅŸ"})]}),f&&(0,b.jsx)(p,{storyId:a,storyTitle:d,onClose:()=>g(!1)})]})}var r=a.i(2088);function s({onSettingsChange:a,initialSettings:d}){let[e,f]=(0,c.useState)(!1),[g,h]=(0,c.useState)(d||{font:"sans",size:"medium",theme:"light"}),i=(0,c.useRef)(null);(0,c.useEffect)(()=>{function a(a){i.current&&!i.current.contains(a.target)&&f(!1)}return document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[]);let j=b=>{let c={...g,...b};h(c),a(c),localStorage.setItem("fabula-reading-settings",JSON.stringify(c))};return(0,b.jsxs)("div",{className:"reading-settings-container",ref:i,style:{position:"relative",zIndex:50},children:[(0,b.jsx)("button",{onClick:()=>f(!e),className:"reading-settings-toggle",title:"Okuma AyarlarÄ±",style:{background:"#e0e5ec",border:"none",fontSize:"1.5rem",cursor:"pointer",width:"44px",height:"44px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s ease",boxShadow:e?"inset 5px 5px 10px #bebebe, inset -5px -5px 10px #ffffff":"5px 5px 10px #bebebe, -5px -5px 10px #ffffff",color:"#4a5568"},children:"Aa"}),e&&(0,b.jsxs)("div",{className:"reading-settings-menu",style:{position:"absolute",top:"100%",right:0,marginTop:"16px",background:"#e0e5ec",border:"none",borderRadius:"20px",padding:"20px",boxShadow:"9px 9px 16px rgb(163,177,198,0.6), -9px -9px 16px rgba(255,255,255, 0.5)",width:"300px",color:"#4a5568",zIndex:100},children:[(0,b.jsxs)("div",{className:"setting-group",style:{marginBottom:"16px"},children:[(0,b.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"0.875rem",fontWeight:600},children:"YazÄ± Tipi"}),(0,b.jsxs)("div",{style:{display:"flex",gap:"12px"},children:[(0,b.jsx)("button",{onClick:()=>j({font:"sans"}),style:{flex:1,padding:"8px",border:"none",borderRadius:"10px",background:"#e0e5ec",boxShadow:"sans"===g.font?"inset 3px 3px 6px #bebebe, inset -3px -3px 6px #ffffff":"3px 3px 6px #bebebe, -3px -3px 6px #ffffff",cursor:"pointer",fontFamily:"sans-serif",color:"#4a5568",fontWeight:"sans"===g.font?"bold":"normal",transition:"all 0.2s ease"},children:"Sans"}),(0,b.jsx)("button",{onClick:()=>j({font:"serif"}),style:{flex:1,padding:"8px",border:"none",borderRadius:"10px",background:"#e0e5ec",boxShadow:"serif"===g.font?"inset 3px 3px 6px #bebebe, inset -3px -3px 6px #ffffff":"3px 3px 6px #bebebe, -3px -3px 6px #ffffff",cursor:"pointer",fontFamily:"serif",color:"#4a5568",fontWeight:"serif"===g.font?"bold":"normal",transition:"all 0.2s ease"},children:"Serif"}),(0,b.jsx)("button",{onClick:()=>j({font:"mono"}),style:{flex:1,padding:"8px",border:"none",borderRadius:"10px",background:"#e0e5ec",boxShadow:"mono"===g.font?"inset 3px 3px 6px #bebebe, inset -3px -3px 6px #ffffff":"3px 3px 6px #bebebe, -3px -3px 6px #ffffff",cursor:"pointer",fontFamily:"monospace",color:"#4a5568",fontWeight:"mono"===g.font?"bold":"normal",transition:"all 0.2s ease"},children:"Mono"})]})]}),(0,b.jsxs)("div",{className:"setting-group",style:{marginBottom:"16px"},children:[(0,b.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"0.875rem",fontWeight:600},children:"Boyut"}),(0,b.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[(0,b.jsx)("button",{onClick:()=>j({size:"small"}),style:{border:"none",background:"none",cursor:"pointer",fontSize:"14px",fontWeight:"small"===g.size?"bold":"normal"},children:"A"}),(0,b.jsx)("div",{style:{flex:1,height:"4px",background:"#e5e7eb",borderRadius:"2px",position:"relative"},children:(0,b.jsx)("div",{style:{position:"absolute",left:"small"===g.size?"0%":"medium"===g.size?"33%":"large"===g.size?"66%":"100%",top:"50%",transform:"translate(-50%, -50%)",width:"12px",height:"12px",borderRadius:"50%",background:"#3b82f6"}})}),(0,b.jsx)("button",{onClick:()=>j({size:"xlarge"}),style:{border:"none",background:"none",cursor:"pointer",fontSize:"24px",fontWeight:"xlarge"===g.size?"bold":"normal"},children:"A"})]}),(0,b.jsx)("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"12px",padding:"0 8px"},children:["small","medium","large","xlarge"].map(a=>(0,b.jsx)("button",{onClick:()=>j({size:a}),style:{width:"32px",height:"32px",border:"none",borderRadius:"50%",background:"#e0e5ec",boxShadow:g.size===a?"inset 3px 3px 6px #bebebe, inset -3px -3px 6px #ffffff":"3px 3px 6px #bebebe, -3px -3px 6px #ffffff",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"small"===a?"12px":"medium"===a?"14px":"large"===a?"16px":"18px",fontWeight:"bold",color:g.size===a?"#3b82f6":"#4a5568",transition:"all 0.2s ease"},"aria-label":`Select ${a} size`,children:"A"},a))})]}),(0,b.jsxs)("div",{className:"setting-group",children:[(0,b.jsx)("label",{style:{display:"block",marginBottom:"8px",fontSize:"0.875rem",fontWeight:600},children:"Tema"}),(0,b.jsxs)("div",{style:{display:"flex",gap:"12px"},children:[(0,b.jsx)("button",{onClick:()=>j({theme:"light"}),style:{flex:1,height:"40px",borderRadius:"10px",border:"none",background:"#e0e5ec",boxShadow:"light"===g.theme?"inset 3px 3px 6px #bebebe, inset -3px -3px 6px #ffffff":"3px 3px 6px #bebebe, -3px -3px 6px #ffffff",color:"#000",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:"light"===g.theme?"bold":"normal",transition:"all 0.2s ease"},children:"AÃ§Ä±k"}),(0,b.jsx)("button",{onClick:()=>j({theme:"sepia"}),style:{flex:1,height:"40px",borderRadius:"10px",border:"none",background:"#e0e5ec",boxShadow:"sepia"===g.theme?"inset 3px 3px 6px #bebebe, inset -3px -3px 6px #ffffff":"3px 3px 6px #bebebe, -3px -3px 6px #ffffff",color:"#5b4636",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:"sepia"===g.theme?"bold":"normal",transition:"all 0.2s ease"},children:"Sepya"}),(0,b.jsx)("button",{onClick:()=>j({theme:"dark"}),style:{flex:1,height:"40px",borderRadius:"10px",border:"none",background:"#e0e5ec",boxShadow:"dark"===g.theme?"inset 3px 3px 6px #bebebe, inset -3px -3px 6px #ffffff":"3px 3px 6px #bebebe, -3px -3px 6px #ffffff",color:"#1f2937",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:"dark"===g.theme?"bold":"normal",transition:"all 0.2s ease"},children:"Koyu"})]})]})]})]})}function t({isOpen:a,onClose:d,storyId:e,nodeId:f,onSuccess:h}){let{user:i}=(0,g.useAuth)(),[j,k]=(0,c.useState)(""),[l,m]=(0,c.useState)(!1);if(!a)return null;let n=async a=>{if(a.preventDefault(),i&&j.trim()){m(!0);try{let a=await i.getIdToken(),b=await fetch(`/api/stories/${e}/propose`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({nodeId:f,text:j,idToken:a})}),c=await b.json();c.success?(alert(c.message),h(),d(),k("")):alert(c.error||"Bir hata oluÅŸtu.")}catch(a){console.error("Error proposing branch:",a),alert("Bir hata oluÅŸtu.")}finally{m(!1)}}};return(0,b.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:(0,b.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-xl w-full max-w-md overflow-hidden animate-scale-in",children:(0,b.jsxs)("form",{onSubmit:n,className:"p-6",children:[(0,b.jsx)("h3",{className:"text-xl font-bold text-gray-800 dark:text-white mb-4",children:"Yeni Yol Ã–ner"}),(0,b.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:"Hikayenin gidiÅŸatÄ±nÄ± deÄŸiÅŸtirecek bir seÃ§enek Ã¶nerin."}),(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"SeÃ§enek Metni"}),(0,b.jsx)("input",{type:"text",value:j,onChange:a=>k(a.target.value),className:"w-full p-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Ã–rn: Ormana doÄŸru koÅŸ...",maxLength:100}),(0,b.jsxs)("div",{className:"text-right text-xs text-gray-400 mt-1",children:[j.length,"/100"]})]}),(0,b.jsxs)("div",{className:"flex gap-3 justify-end",children:[(0,b.jsx)("button",{type:"button",onClick:d,className:"px-4 py-2 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:"Ä°ptal"}),(0,b.jsx)("button",{type:"submit",disabled:l||!j.trim(),className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors disabled:opacity-50",children:l?"GÃ¶nderiliyor...":"Ã–ner"})]})]})})})}function u({story:a,readingSettings:d,onProgressUpdate:e}){let{user:f}=(0,g.useAuth)(),[h,i]=(0,c.useState)(a.startNodeId||"start"),[j,k]=(0,c.useState)([]),[l,m]=(0,c.useState)(null),[n,o]=(0,c.useState)(!1),[p,q]=(0,c.useState)(null),[r,s]=(0,c.useState)(!1);(0,c.useEffect)(()=>{if(a.nodes&&a.nodes[h]){let b=a.nodes[h];m(b),!b.isEnding||p||n||u([...j,h])}else console.warn(`Node ${h} not found in story`)},[h,a.nodes]);let u=async b=>{if(f){o(!0);try{let c=await f.getIdToken(),d=await fetch("/api/complete-story",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({storyId:a.id,history:b,idToken:c})}),e=await d.json();e.success&&q({xpEarned:e.xpEarned,message:e.message})}catch(a){console.error("Error completing story:",a)}finally{o(!1)}}};if(!l)return(0,b.jsx)("div",{className:"p-4 text-center",children:"YÃ¼kleniyor..."});let v={fontFamily:"serif"===d.font?'ui-serif, Georgia, Cambria, "Times New Roman", Times, serif':"mono"===d.font?"ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace":"ui-sans-serif, system-ui, sans-serif",fontSize:"small"===d.size?"0.95rem":"large"===d.size?"1.25rem":"xlarge"===d.size?"1.5rem":"1.1rem",lineHeight:"xlarge"===d.size?"2":"1.8",backgroundColor:"sepia"===d.theme?"#f4ecd8":"dark"===d.theme?"#1f2937":"transparent",color:"sepia"===d.theme?"#433422":"dark"===d.theme?"#e5e7eb":"inherit",padding:"light"!==d.theme?"3rem":"0",borderRadius:"light"!==d.theme?"4px":"0",transition:"all 0.3s ease",boxShadow:"sepia"===d.theme?"inset 20px 0 50px rgba(0,0,0,0.05), 5px 5px 15px rgba(0,0,0,0.1)":"none",borderLeft:"sepia"===d.theme?"2px solid rgba(0,0,0,0.05)":"none",backgroundImage:"sepia"===d.theme?"linear-gradient(to right, rgba(255,255,255,0) 0%, rgba(255,255,255,0.2) 5%, rgba(255,255,255,0) 10%)":"none"},w={background:"dark"===d.theme?"#374151":"#e0e5ec",border:"none",padding:"16px 24px",borderRadius:"12px",color:"dark"===d.theme?"#e5e7eb":"#4a5568",fontSize:"1rem",fontWeight:600,cursor:"pointer",width:"100%",textAlign:"left",transition:"all 0.2s ease",boxShadow:"dark"===d.theme?"5px 5px 10px #2d3542, -5px -5px 10px #414d5f":"9px 9px 16px rgb(163,177,198,0.6), -9px -9px 16px rgba(255,255,255, 0.5)",marginBottom:"16px"};return(0,b.jsxs)("div",{className:"interactive-story-container",children:[(0,b.jsx)("div",{className:"story-content mb-8",style:v,children:l.content.split("\n\n").map((a,c)=>(0,b.jsx)("p",{style:{marginBottom:"1.5em"},children:a},c))}),(0,b.jsxs)("div",{className:"choices-container",style:{maxWidth:"600px",margin:"0 auto"},children:[l.choices&&l.choices.length>0?(0,b.jsx)("div",{className:"choices-list",children:l.choices.map(a=>(0,b.jsx)("button",{onClick:()=>{var b;let c;return b=a.nextNodeId,void(k(c=[...j,h]),i(b),e&&e([...c,b]))},className:"choice-button",style:w,onMouseEnter:a=>{a.currentTarget.style.transform="translateY(-2px)",a.currentTarget.style.boxShadow="dark"===d.theme?"6px 6px 12px #2d3542, -6px -6px 12px #414d5f":"12px 12px 20px rgb(163,177,198,0.7), -12px -12px 20px rgba(255,255,255, 0.6)"},onMouseLeave:a=>{a.currentTarget.style.transform="translateY(0)",a.currentTarget.style.boxShadow="dark"===d.theme?"5px 5px 10px #2d3542, -5px -5px 10px #414d5f":"9px 9px 16px rgb(163,177,198,0.6), -9px -9px 16px rgba(255,255,255, 0.5)"},onMouseDown:a=>{a.currentTarget.style.transform="translateY(1px)",a.currentTarget.style.boxShadow="dark"===d.theme?"inset 3px 3px 6px #2d3542, inset -3px -3px 6px #414d5f":"inset 3px 3px 6px #a3b1c6, inset -3px -3px 6px #ffffff"},onMouseUp:a=>{a.currentTarget.style.transform="translateY(-2px)",a.currentTarget.style.boxShadow="dark"===d.theme?"6px 6px 12px #2d3542, -6px -6px 12px #414d5f":"12px 12px 20px rgb(163,177,198,0.7), -12px -12px 20px rgba(255,255,255, 0.6)"},children:a.text},a.id))}):(0,b.jsxs)("div",{className:"end-of-story text-center p-8",children:[(0,b.jsx)("h3",{className:"text-xl font-bold mb-4",children:"Son"}),p?(0,b.jsxs)("div",{className:"completion-result animate-fade-in",children:[(0,b.jsx)("p",{className:"text-lg mb-2",children:p.message}),(0,b.jsxs)("p",{className:"text-2xl font-bold text-yellow-500",children:["+",p.xpEarned," XP"]})]}):n?(0,b.jsx)("p",{children:"SonuÃ§lar hesaplanÄ±yor..."}):(0,b.jsx)("p",{children:"Bu hikayenin sonuna geldiniz."})]}),f&&!l.isEnding&&(0,b.jsxs)("div",{className:"mt-8 text-center",children:[(0,b.jsx)("p",{className:"text-gray-500 mb-2 text-sm",children:"AklÄ±nda baÅŸka bir yol mu var?"}),(0,b.jsx)("button",{onClick:()=>s(!0),className:"px-4 py-2 bg-indigo-100 dark:bg-indigo-900/30 text-indigo-600 dark:text-indigo-300 rounded-lg hover:bg-indigo-200 dark:hover:bg-indigo-900/50 transition-colors text-sm font-medium",children:"âœ¨ Yeni Bir Yol Ã–ner"})]}),(0,b.jsx)(t,{isOpen:r,onClose:()=>s(!1),storyId:a.id,nodeId:h,onSuccess:()=>{window.location.reload()}})]})]})}function v({params:a}){let[h,j]=(0,c.useState)(""),[k,m]=(0,c.useState)(null),[n,o]=(0,c.useState)([]),[p,t]=(0,c.useState)(!0),{user:v}=(0,g.useAuth)(),w=(0,d.useRouter)(),[x,y]=(0,c.useState)(!1),[z,A]=(0,c.useState)(!1),[B,C]=(0,c.useState)(""),[D,E]=(0,c.useState)(""),[F,G]=(0,c.useState)(!1),[H,I]=(0,c.useState)({font:"sans",size:"medium",theme:"light"});(0,c.useEffect)(()=>{let a=localStorage.getItem("fabula-reading-settings");if(a)try{I(JSON.parse(a))}catch(a){console.error("Error parsing reading settings:",a)}},[]),(0,c.useEffect)(()=>{!async function(){j((await a).id)}()},[a]),(0,c.useEffect)(()=>{h&&a();async function a(){try{let[a,b]=await Promise.all([(0,f.getStoryById)(h),(0,f.getCommentsByStoryId)(h)]);if(!a)return void(0,d.notFound)();m(a),o(b),(0,f.incrementStoryViews)(h).catch(a=>{console.error("Failed to increment views:",a)})}catch(a){console.error("Error loading story:",a)}finally{t(!1)}}},[h]);let J=a=>a>=1e3?`${(a/1e3).toFixed(1)}k`:a.toString(),K=async()=>{if(confirm("Bu hikayeyi silmek istediÄŸinizden emin misiniz? Bu iÅŸlem geri alÄ±namaz.")){y(!0);try{await (0,f.deleteStory)(h),w.push("/")}catch(a){console.error("Error deleting story:",a),alert("Hikaye silinirken bir hata oluÅŸtu."),y(!1)}}},L=async()=>{if(!B.trim()||!D.trim())return void alert("BaÅŸlÄ±k ve iÃ§erik boÅŸ olamaz.");G(!0);try{await (0,f.updateStory)(h,{title:B,content:D}),m(a=>a?{...a,title:B,content:D}:null),A(!1)}catch(a){console.error("Error updating story:",a),alert("Hikaye gÃ¼ncellenirken bir hata oluÅŸtu.")}finally{G(!1)}};return p?(0,b.jsx)("div",{className:"story-page",children:(0,b.jsx)("div",{className:"story-container",children:(0,b.jsxs)("div",{className:"loading-state",children:[(0,b.jsx)("div",{className:"spinner"}),(0,b.jsx)("p",{children:"Hikaye yÃ¼kleniyor..."})]})})}):k?(0,b.jsx)("div",{className:"story-page",children:(0,b.jsxs)("div",{className:"story-container",children:[(0,b.jsxs)(e.default,{href:"/",className:"back-button",children:[(0,b.jsx)("span",{children:"â†"}),"Ana Sayfaya DÃ¶n"]}),(0,b.jsxs)("article",{className:"story-article",children:[(0,b.jsxs)("header",{className:"story-header",children:[(0,b.jsxs)("div",{className:"story-meta",children:[(0,b.jsx)("span",{className:"category-badge",children:k.category}),(0,b.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,b.jsx)(s,{onSettingsChange:I,initialSettings:H}),(0,b.jsx)(q,{storyId:k.id,storyTitle:k.title,size:"small"}),(0,b.jsx)(r.default,{storyId:k.id}),(0,b.jsx)(i.default,{targetId:k.id,targetType:"story",targetContent:k.title,className:"opacity-50 hover:opacity-100"})]}),(0,b.jsx)("span",{className:"story-date",children:k.createdAt.toLocaleDateString("tr-TR",{year:"numeric",month:"long",day:"numeric"})}),v&&v.uid===k.authorId&&(0,b.jsx)("div",{className:"author-actions",style:{marginLeft:"auto",display:"flex",gap:"8px"},children:z?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("button",{onClick:L,disabled:F,className:"action-button save-button",style:{padding:"4px 12px",borderRadius:"4px",background:"#22c55e",color:"white",border:"none",cursor:F?"not-allowed":"pointer",fontSize:"0.9rem"},children:F?"Kaydediliyor...":"Kaydet"}),(0,b.jsx)("button",{onClick:()=>{A(!1),C(""),E("")},disabled:F,className:"action-button cancel-button",style:{padding:"4px 12px",borderRadius:"4px",background:"#6b7280",color:"white",border:"none",cursor:F?"not-allowed":"pointer",fontSize:"0.9rem"},children:"Ä°ptal"})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("button",{onClick:()=>{k&&(C(k.title),E(k.content),A(!0))},className:"action-button edit-button",style:{padding:"4px 12px",borderRadius:"4px",background:"#3b82f6",color:"white",border:"none",cursor:"pointer",fontSize:"0.9rem"},children:"DÃ¼zenle"}),(0,b.jsx)("button",{onClick:K,disabled:x,className:"action-button delete-button",style:{padding:"4px 12px",borderRadius:"4px",background:"#ef4444",color:"white",border:"none",cursor:x?"not-allowed":"pointer",fontSize:"0.9rem"},children:x?"Siliniyor...":"Sil"})]})})]}),z?(0,b.jsx)("input",{type:"text",value:B,onChange:a=>C(a.target.value),className:"story-title-input",style:{width:"100%",fontSize:"2rem",fontWeight:"bold",marginBottom:"1rem",padding:"0.5rem",border:"1px solid #ccc",borderRadius:"4px",color:"black"}}):(0,b.jsx)("h1",{className:"story-title",children:k.title}),(0,b.jsxs)("div",{className:"author-section",children:[(0,b.jsxs)("div",{className:"author-info",children:[(0,b.jsx)("span",{className:"author-avatar",children:k.author.avatar}),(0,b.jsx)("span",{className:"author-name",children:k.author.name})]}),(0,b.jsxs)("div",{className:"story-stats",children:[(0,b.jsxs)("span",{className:"stat",children:[(0,b.jsx)("span",{className:"stat-icon",children:"ðŸ‘ï¸"}),J(k.stats.views)," gÃ¶rÃ¼ntÃ¼lenme"]}),(0,b.jsxs)("span",{className:"stat",children:[(0,b.jsx)("span",{className:"stat-icon",children:"ðŸ’¬"}),J(k.stats.comments)," yorum"]}),(0,b.jsxs)("span",{className:"stat",children:[(0,b.jsx)("span",{className:"stat-icon",children:"â¤ï¸"}),J(k.stats.likes)," beÄŸeni"]})]})]})]}),"interactive"===k.type&&k.nodes?(0,b.jsx)(u,{story:k,readingSettings:H,onProgressUpdate:a=>console.log("Path updated:",a)}):(0,b.jsx)("div",{className:"story-content",style:{fontFamily:"serif"===H.font?'ui-serif, Georgia, Cambria, "Times New Roman", Times, serif':"mono"===H.font?"ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace":"ui-sans-serif, system-ui, sans-serif",fontSize:"small"===H.size?"0.95rem":"large"===H.size?"1.25rem":"xlarge"===H.size?"1.5rem":"1.1rem",lineHeight:"xlarge"===H.size?"2":"1.8",backgroundColor:"sepia"===H.theme?"#f4ecd8":"dark"===H.theme?"#1f2937":"transparent",color:"sepia"===H.theme?"#433422":"dark"===H.theme?"#e5e7eb":"inherit",padding:"light"!==H.theme?"3rem":"0",borderRadius:"light"!==H.theme?"4px":"0",transition:"all 0.3s ease",boxShadow:"sepia"===H.theme?"inset 20px 0 50px rgba(0,0,0,0.05), 5px 5px 15px rgba(0,0,0,0.1)":"none",borderLeft:"sepia"===H.theme?"2px solid rgba(0,0,0,0.05)":"none",backgroundImage:"sepia"===H.theme?"linear-gradient(to right, rgba(255,255,255,0) 0%, rgba(255,255,255,0.2) 5%, rgba(255,255,255,0) 10%)":"none"},children:z?(0,b.jsx)("textarea",{value:D,onChange:a=>E(a.target.value),className:"story-content-textarea",style:{width:"100%",minHeight:"400px",fontSize:"inherit",lineHeight:"inherit",fontFamily:"inherit",padding:"1rem",border:"1px solid #ccc",borderRadius:"4px",color:"black",backgroundColor:"white"}}):k.content.split("\n\n").map((a,c)=>(0,b.jsx)("p",{style:{marginBottom:"1.5em"},children:a},c))})]}),(0,b.jsx)(l,{storyId:h,storyAuthorId:k.authorId,storyTitle:k.title,initialComments:n})]})}):((0,d.notFound)(),null)}a.s(["default",()=>v],48241)}];

//# sourceMappingURL=src_app_story_%5Bid%5D_page_tsx_35f00211._.js.map